// Types
// -----

//data Maybe
  //= (Some value)
  //| None

//data Bool
  //= False
  //| True

//data Pair
  //= (Pair fst snd)

//data Term
  //= (All nam inp bod)
  //| (Lam nam bod)
  //| (App fun arg)
  //| (Ann val typ)
  //| (Slf nam typ bod)
  //| (Ins val)
  //| (Ref nam sub val)
  //| (Let nam val bod)
  //| (Set)
  //| (U60)
  //| (Num val)
  //| (Op2 opr fst snd)
  //| (Mat nam x z s p)
  //| (Txt txt)
  //| (Hol nam ctx)
  //| (Var nam idx) 
  //| (Src src val)

// Prelude
// -------

(U60.seq 0 cont) = (cont 0)
(U60.seq n cont) = (cont n)

(String.seq (String.cons x xs) cont) = (U60.seq x λx(String.seq xs λxs(cont (String.cons x xs))))
(String.seq String.nil         cont) = (cont String.nil)

(Print dep []  value) = value
(Print dep msg value) = (String.seq (String.join msg) λstr(HVM.log str value))
//(Print dep []  value) = value
//(Print dep msg value) = (If (> dep 10) 1 (HVM.print (String.join msg) value))

(NewLine) = (String.cons 10 String.nil)
(Quote)   = (String.cons 34 String.nil)

(And True  b) = b
(And False b) = False

(Or True  b) = True
(Or False b) = b

(If 0 t f) = f
(If n t f) = t

(When None       some none) = none
(When (Some val) some none) = (some val)

(U60.show n)                = (U60.show.go n String.nil)
(U60.show.go n res)         = (U60.show.go.match (< n 10) n res)
(U60.show.go.match 0 n res) = (U60.show.go (/ n 10) (String.cons (+ '0' (% n 10)) res))
(U60.show.go.match i n res) = (String.cons (+ '0' n) res)

(U60.name n)    = (U60.name.go (+ n 1))
(U60.name.go 0) = ""
(U60.name.go n) = (String.cons (+ 97 (% (- n 1) 26)) (U60.name.go (/ (- n 1) 26)))

(Same String.nil         String.nil)         = 1
(Same String.nil         (String.cons y ys)) = 0
(Same (String.cons x xs) String.nil)         = 0
(Same (String.cons x xs) (String.cons y ys)) = (& (== x y) (Same xs ys))

(Find name List.nil)                        = None
(Find name (List.cons (Pair nam val) tail)) = (If (Same nam name) (Some val) (Find name tail))

(List.map f (List.cons x xs)) = (List.cons (f x) (List.map f xs))
(List.map f List.nil)         = List.nil

(String.concat String.nil         ys) = ys
(String.concat (String.cons x xs) ys) = (String.cons x (String.concat xs ys))

(String.join List.nil)         = ""
(String.join (List.cons x xs)) = (String.concat x (String.join xs))

(String.tail String.nil)         = String.nil
(String.tail (String.cons x xs)) = xs

(Pair.fst (Pair fst snd)) = fst
(Pair.snd (Pair fst snd)) = snd

(Pair.get (Pair fst snd) fun) = (fun fst snd)

(Maybe.match (Some value) some none) = (some value)
(Maybe.match None         some none) = none

(Maybe.pure x) = (Some x)
(Maybe.bind a b) = (Maybe.match a λvalue(b value) None)

// Converts an U60 to a bitstring
(U60.to_bits 0) = E
(U60.to_bits 1) = (I E)
(U60.to_bits n) = (If (== (% n 2) 0) (O (U60.to_bits (/ n 2))) (I (U60.to_bits (/ n 2))))

(String.color RESET)      = (String.cons 27 "[0m")
(String.color BRIGHT)     = (String.cons 27 "[1m")
(String.color DIM)        = (String.cons 27 "[2m")
(String.color UNDERSCORE) = (String.cons 27 "[4m")
(String.color BLINK)      = (String.cons 27 "[5m")
(String.color REVERSE)    = (String.cons 27 "[7m")
(String.color HIDDEN)     = (String.cons 27 "[8m")
(String.color BLACK)      = (String.cons 27 "[30m")
(String.color RED)        = (String.cons 27 "[31m")
(String.color GREEN)      = (String.cons 27 "[32m")
(String.color YELLOW)     = (String.cons 27 "[33m")
(String.color BLUE)       = (String.cons 27 "[34m")
(String.color MAGENTA)    = (String.cons 27 "[35m")
(String.color CYAN)       = (String.cons 27 "[36m")
(String.color WHITE)      = (String.cons 27 "[37m")
(String.color GRAY)       = (String.cons 27 "[90m")
(String.color BG_BLACK)   = (String.cons 27 "[40m")
(String.color BG_RED)     = (String.cons 27 "[41m")
(String.color BG_GREEN)   = (String.cons 27 "[42m")
(String.color BG_YELLOW)  = (String.cons 27 "[43m")
(String.color BG_BLUE)    = (String.cons 27 "[44m")
(String.color BG_MAGENTA) = (String.cons 27 "[45m")
(String.color BG_CYAN)    = (String.cons 27 "[46m")
(String.color BG_WHITE)   = (String.cons 27 "[47m")
(String.color BG_GRAY)    = (String.cons 27 "[100m")
(String.color x)          = "?"

// BitsMap
// -------

(Map.new) = List.nil

(Map.has eq k (List.cons (Pair key val) map)) = (If (eq key k) 1 (Map.has eq k map))
(Map.has eq k List.nil)                       = 0

(Map.ins eq k v (List.cons (Pair key val) map)) = ((If (eq key k) λmap(None) λmap(Maybe.bind (Map.ins eq k v map) λmap(Some (List.cons (Pair key val) map)))) map)
(Map.ins eq k v List.nil)                       = (Some (List.cons (Pair k v) List.nil))

(Map.set eq k v (List.cons (Pair key val) map)) = ((If (eq key k) λmap(List.cons (Pair k v) map) λmap(List.cons (Pair key val) (Map.set eq k v map))) map)
(Map.set eq k v List.nil)                       = (List.cons (Pair k v) List.nil)

(Map.get eq k (List.cons (Pair key val) map)) = (If (eq key k) (Some val) (Map.get eq k map))
(Map.get eq k List.nil)                       = None

// Holes
// -----

(Subst (List.cons (Pair nam None)     subs) val) = (Subst subs (val None))
(Subst (List.cons (Pair nam (Some x)) subs) val) = (Subst subs (val (Some x)))
(Subst List.nil                             val) = val

// Evaluation
// ----------

// Evaluation levels:
// - 0: reduces refs never
// - 1: reduces refs on redexes
// - 2: reduces refs always

(Reduce lv (App fun arg))     = (Reduce.app lv (Reduce lv fun) arg)
(Reduce lv (Ann val typ))     = (Reduce lv val)
(Reduce lv (Ins val))         = (Reduce lv val)
(Reduce lv (Ref nam sub val)) = (Reduce.ref lv nam sub (Reduce lv val))
(Reduce lv (Let nam val bod)) = (Reduce lv (bod val))
(Reduce lv (Op2 opr fst snd)) = (Reduce.op2 lv opr (Reduce lv fst) (Reduce lv snd))
(Reduce lv (Mat nam x z s p)) = (Reduce.mat lv nam (Reduce lv x) z s p)
(Reduce lv (Met nam val))     = (Reduce.met lv nam val)
(Reduce lv (Txt txt))         = (Reduce.txt lv txt)
(Reduce lv (Src src val))     = (Reduce lv val)
(Reduce lv val)               = val

(Reduce.app 2  (Ref _ _ val) arg) = (Reduce.app 2 val arg) // FIXME: should this be here? (no.)
(Reduce.app 1  (Ref _ _ val) arg) = (Reduce.app 1 val arg) // FIXME: should this be here? (no.)
(Reduce.app lv (Lam nam bod) arg) = (Reduce lv (bod (Reduce 0 arg)))
(Reduce.app lv fun           arg) = (App fun arg)

(Reduce.op2 1  op  (Ref _ _ x) (Num snd))   = (Reduce.op2 1 op x snd)
(Reduce.op2 2  op  (Ref _ _ x) (Num snd))   = (Reduce.op2 2 op x snd)
(Reduce.op2 1  op  (Num fst)   (Ref _ _ x)) = (Reduce.op2 1 op fst x)
(Reduce.op2 2  op  (Num fst)   (Ref _ _ x)) = (Reduce.op2 2 op fst x)
(Reduce.op2 lv ADD (Num fst)   (Num snd))   = (Num (+ fst snd))
(Reduce.op2 lv SUB (Num fst)   (Num snd))   = (Num (- fst snd))
(Reduce.op2 lv MUL (Num fst)   (Num snd))   = (Num (* fst snd))
(Reduce.op2 lv DIV (Num fst)   (Num snd))   = (Num (/ fst snd))
(Reduce.op2 lv MOD (Num fst)   (Num snd))   = (Num (% fst snd))
(Reduce.op2 lv EQ  (Num fst)   (Num snd))   = (Num (== fst snd))
(Reduce.op2 lv NE  (Num fst)   (Num snd))   = (Num (!= fst snd))
(Reduce.op2 lv LT  (Num fst)   (Num snd))   = (Num (< fst snd))
(Reduce.op2 lv GT  (Num fst)   (Num snd))   = (Num (> fst snd))
(Reduce.op2 lv LTE (Num fst)   (Num snd))   = (Num (<= fst snd))
(Reduce.op2 lv GTE (Num fst)   (Num snd))   = (Num (>= fst snd))
(Reduce.op2 lv AND (Num fst)   (Num snd))   = (Num (& fst snd))
(Reduce.op2 lv OR  (Num fst)   (Num snd))   = (Num (| fst snd))
(Reduce.op2 lv XOR (Num fst)   (Num snd))   = (Num (^ fst snd))
(Reduce.op2 lv LSH (Num fst)   (Num snd))   = (Num (<< fst snd))
(Reduce.op2 lv RSH (Num fst)   (Num snd))   = (Num (>> fst snd))
(Reduce.op2 lv opr fst         snd)         = (Op2 opr fst snd)

(Reduce.mat 2  nam (Ref _ _ x)         z s p) = (Reduce.mat 2 nam x z s p)
(Reduce.mat 1  nam (Ref _ _ x)         z s p) = (Reduce.mat 1 nam x z s p)
(Reduce.mat lv nam (Num 0)             z s p) = (Reduce lv z)
(Reduce.mat lv nam (Num n)             z s p) = (Reduce lv (s (Num (- n 1))))
(Reduce.mat lv nam (Op2 ADD (Num 1) k) z s p) = (Reduce lv (s k))
(Reduce.mat lv nam val                 z s p) = (Mat nam val z s p)

(Reduce.ref 2  nam sub val) = (Reduce 2 (Subst sub val))
(Reduce.ref 1  nam sub val) = (Ref nam sub val)
(Reduce.ref lv nam sub val) = (Ref nam sub val)

(Reduce.met lv nam None)     = (Met nam None)
(Reduce.met lv nam (Some x)) = (Reduce lv x)

(Reduce.txt lv (String.cons x xs)) = (Reduce lv (App (App Book.String.cons (Num x)) (Txt xs)))
(Reduce.txt lv String.nil)         = (Reduce lv Book.String.nil)
(Reduce.txt lv val)                = (Txt val)

(Normal lv term dep) = (Normal.go lv (Normal.prefer (Reduce 0 term) (Reduce lv term)) dep)

(Normal.prefer soft (Lam _ _))   = soft
(Normal.prefer soft (Slf _ _ _)) = soft
(Normal.prefer soft (All _ _ _)) = soft
(Normal.prefer soft hard)        = hard

(Normal.go lv (All nam inp bod) dep) = (All nam (Normal lv inp dep) λx(Normal lv (bod (Var nam dep)) (+ dep 1)))
(Normal.go lv (Lam nam bod)     dep) = (Lam nam λx(Normal lv (bod (Var nam dep)) (+ 1 dep)))
(Normal.go lv (App fun arg)     dep) = (App (Normal lv fun dep) (Normal lv arg dep))
(Normal.go lv (Ann val typ)     dep) = (Ann (Normal lv val dep) (Normal lv typ dep))
(Normal.go lv (Slf nam typ bod) dep) = (Slf nam typ λx(Normal lv (bod (Var nam dep)) (+ 1 dep)))
(Normal.go lv (Ins val)         dep) = (Ins (Normal lv val dep))
(Normal.go lv (Ref nam sub val) dep) = (Ref nam sub (Normal lv val dep))
(Normal.go lv (Let nam val bod) dep) = (Let nam (Normal lv val dep) λx(Normal lv (bod (Var nam dep)) (+ 1 dep)))
(Normal.go lv (Hol nam ctx)     dep) = (Hol nam ctx)
(Normal.go lv (Met nam val)     dep) = (Met nam (Maybe.match val λx(Some (Normal lv x dep)) None))
(Normal.go lv Set               dep) = Set
(Normal.go lv U60               dep) = U60
(Normal.go lv (Num val)         dep) = (Num val)
(Normal.go lv (Op2 opr fst snd) dep) = (Op2 opr (Normal lv fst dep) (Normal lv snd dep))
(Normal.go lv (Mat nam x z s p) dep) = (Mat nam (Normal lv x dep) (Normal lv z dep) λk(Normal lv (s (Var (String.concat nam "-1") dep)) dep) λk(Normal lv (p (Var nam dep)) dep))
(Normal.go lv (Txt val)         dep) = (Txt val)
(Normal.go lv (Var nam idx)     dep) = (Var nam idx)
(Normal.go lv (Src src val)     dep) = (Src src (Normal lv val dep))

// Checker
// -------

// type Result A = (Done Logs A) | (Fail Logs String)
// type Checker A = Logs -> (Result A)

(Result.match (Done logs value) done fail) = (done logs value)
(Result.match (Fail logs error) done fail) = (fail logs error)     

//(State.get fill got) = (got fill logs)
//(State.new)          = []

(Checker.bind a b)  = λlogs (Result.match (a logs) λlogsλvalue((b value) logs) λlogsλerror(Fail logs error))
(Checker.pure a)    = λlogs (Done logs a)
(Checker.fail e)    = λlogs (Fail logs e)
(Checker.run chk)   = (chk [])
(Checker.log msg)   = λlogs (Done (List.cons msg logs) 1)
(Checker.save)      = λlogs (Done logs logs)
(Checker.load logs) = λeras (Done logs 0)

// Equality
// --------

// The conversion checkers works as follows:
// - 1. If the two sides are structurally identical, they're equal.
// - 2. Otherwise, reduce both sides.
// - 3. If the two sides are structurally identical, they're equal.
// - 4. Otherwise, recurse on both sides and check if all fields are equal.
// This algorithm will return true when both sides reduce to the same normal
// form, but it will halt early if both sides become identical at any point
// during the reduction, allowing checking recursive terms. This is enough to
// cover any interesting term. Note we need to be careful with self-types, which
// must be "un-unrolled" to avoid loops. Read `docs/equality.md` for more info.

// Checks if two term are equal
(Equal a b dep) = 
  //(Print dep ["Equal: " NewLine "- " (Show a dep) NewLine "- " (Show b dep)]
  (Compare a b dep
  let a = (Reduce 2 a)
  let b = (Reduce 2 b)
  (Compare a b dep
  (Similar a b dep)))

// Checks if two terms are structurally identical
// If yes, returns 1 (identical) or 2 (suspended)
// If not, undoes effects (logs, unifications, etc.)
(Compare a b dep else) =
  (Checker.bind (Checker.save) λlogs
  (Checker.bind (Identical a b dep) λequal
  (If equal
    (Checker.pure equal)
    (Checker.bind (Checker.load logs) λx (else)))))

// Checks if all components of a term are equal
(Similar (All a.nam a.inp a.bod) (All b.nam b.inp b.bod) dep) =
  (Checker.bind (Equal a.inp b.inp dep) λe.inp
  (Checker.bind (Equal (a.bod (Var a.nam dep)) (b.bod (Var b.nam dep)) (+ 1 dep)) λe.bod
  (Checker.pure (& e.inp e.bod))))
(Similar (Lam a.nam a.bod) (Lam b.nam b.bod) dep) =
  (Equal (a.bod (Var a.nam dep)) (b.bod (Var b.nam dep)) (+ 1 dep))
(Similar (App a.fun a.arg) (App b.fun b.arg) dep) =
  (Checker.bind (Equal a.fun b.fun dep) λe.fun
  (Checker.bind (Equal a.arg b.arg dep) λe.arg
  (Checker.pure (& e.fun e.arg))))
(Similar (Slf a.nam a.typ a.bod) (Slf b.nam b.typ b.bod) dep) =
  (Similar (Reduce 0 a.typ) (Reduce 0 b.typ) dep) // <- must call Similar, NOT Equal
(Similar (Hol a.nam a.ctx) (Hol b.nam b.ctx) dep) =
  (Checker.pure (Same a.nam b.nam))
(Similar (Met a.nam a.val) (Met b.nam b.val) dep) =
  (Checker.pure (Same a.nam b.nam))
(Similar (Op2 a.opr a.fst a.snd) (Op2 b.opr b.fst b.snd) dep) =
  (Checker.bind (Equal a.fst b.fst dep) λe.fst
  (Checker.bind (Equal a.snd b.snd dep) λe.snd
  (Checker.pure (Same e.fst e.snd))))
(Similar (Mat a.nam a.x a.z a.s a.p) (Mat b.nam b.x b.z b.s b.p) dep) =
  (Checker.bind (Equal a.x b.x dep) λe.x
  (Checker.bind (Equal a.z b.z dep) λe.z
  (Checker.bind (Equal (a.s (Var (String.concat a.nam "-1") dep)) (b.s (Var (String.concat b.nam "-1") dep)) dep) λe.s
  (Checker.bind (Equal (a.p (Var a.nam dep)) (b.p (Var b.nam dep)) dep) λe.p
  (& e.x (& e.z (& e.s e.p)))))))
(Similar a b dep) =
  (Checker.pure 0)

// Checks if two terms are structurally identical
(Identical a b dep) =
  //(Print dep ["Identical?" NewLine "- " (Show a dep) NewLine "- " (Show b dep)]
  (Unify.try b a dep
  (Unify.try a b dep
  (Identical.go a b dep)))

(Identical.go (All a.nam a.inp a.bod) (All b.nam b.inp b.bod) dep) =
  (Checker.bind (Identical a.inp b.inp dep) λi.inp
  (Checker.bind (Identical (a.bod (Var a.nam dep)) (b.bod (Var b.nam dep)) (+ 1 dep)) λi.bod
  (Checker.pure (& i.inp i.bod))))
(Identical.go (Lam a.nam a.bod) (Lam b.nam b.bod) dep) =
  (Identical (a.bod (Var a.nam dep)) (b.bod (Var b.nam dep)) (+ 1 dep))
(Identical.go (App a.fun a.arg) (App b.fun b.arg) dep) =
  (Checker.bind (Identical a.fun b.fun dep) λi.fun
  (Checker.bind (Identical a.arg b.arg dep) λi.arg
  (Checker.pure (& i.fun i.arg))))
(Identical.go (Slf a.nam a.typ a.bod) (Slf b.nam b.typ b.bod) dep) =
  (Identical a.typ b.typ dep)
(Identical.go (Ins a.val) b dep) =
  (Identical a.val b dep)
(Identical.go a (Ins b.val) dep) =
  (Identical a b.val dep)
(Identical.go (Let a.nam a.val a.bod) b dep) =
  (Identical (a.bod a.val) b dep)
(Identical.go a (Let b.nam b.val b.bod) dep) =
  (Identical a (b.bod b.val) dep)
(Identical.go Set Set dep) =
  (Checker.pure 1)
(Identical.go (Ann a.val a.typ) b dep) =
  (Identical a.val b dep)
(Identical.go a (Ann b.val b.typ) dep) =
  (Identical a b.val dep)
(Identical.go (Met a.nam (Some a.val)) b dep) =
  (Identical a.val b dep)
(Identical.go a (Met b.nam (Some b.val)) dep) =
  (Identical a b.val dep)
(Identical.go (Met a.nam None) (Met b.nam None) dep) =
  (Checker.pure (Same a.nam b.nam))
(Identical.go (Hol a.nam a.ctx) (Hol b.nam b.ctx) dep) =
  (Checker.pure (Same a.nam b.nam))
(Identical.go U60 U60 dep) =
  (Checker.pure 1)
(Identical.go (Num a.val) (Num b.val) dep) =
  (Checker.pure (== a.val b.val))
(Identical.go (Op2 a.opr a.fst a.snd) (Op2 b.opr b.fst b.snd) dep) =
  (Checker.bind (Identical a.fst b.fst dep) λi.fst
  (Checker.bind (Identical a.snd b.snd dep) λi.snd
  (Checker.pure (& i.fst i.snd))))
(Identical.go (Mat a.nam a.x a.z a.s a.p) (Mat b.nam b.x b.z b.s b.p) dep) =
  (Checker.bind (Identical a.x b.x dep) λi.x
  (Checker.bind (Identical a.z b.z dep) λi.z
  (Checker.bind (Identical (a.s (Var (String.concat a.nam "-1") dep)) (b.s (Var (String.concat b.nam "-1") dep)) dep) λi.s
  (Checker.bind (Identical (a.p (Var a.nam dep)) (b.p (Var b.nam dep)) dep) λi.p
  (& i.x (& i.z (& i.s i.p)))))))
(Identical.go (Txt a.txt) (Txt b.txt) dep) =
  (Checker.pure (Same a.txt b.txt))
(Identical.go (Src a.src a.val) b dep) =
  (Identical a.val b dep)
(Identical.go a (Src b.src b.val) dep) =
  (Identical a b.val dep)
(Identical.go (Ref a.nam a.sub a.val) (Ref b.nam b.sub b.val) dep) =
  (Checker.pure (Same a.nam b.nam))
(Identical.go (Var a.nam a.idx) (Var b.nam b.idx) dep) =
  (Checker.pure (== a.idx b.idx))
(Identical.go a b dep) =
  (Checker.pure 0)

// Unification
// -----------

// The unification algorithm is a simple pattern unifier, based on smalltt:
// > https://github.com/AndrasKovacs/elaboration-zoo/blob/master/03-holes/Main.hs
// The 'Unify.try' fn will attempt to match the following pattern:
//   (?A x y z ...) = B
// Where:
//   1. The LHS spine, `x y z ...`, consists of distinct variables.
//   2. Every free var of the RHS, `B`, occurs in the spine.
//   3. The LHS hole, `?A`, doesn't occur in the RHS, `B`.
// If it is successful, it outputs the following substitution:
//   ?A = λx λy λz ... B
// In this checker, we don't allow holes to occur in solutions at all.

// Unify.try : Term -> Term -> U60 -> (Checker U60) -> (Checker U60)
(Unify.try a b dep else) =
  // Attempts to unify the pattern
  (Maybe.match (Unify.solve a b dep Map.new)
    // If successful, logs the solution
    λkv(Pair.get kv λkλv
      (Checker.bind (Checker.log (Solve k v dep)) λx
      (Checker.pure 1)))
    // Otherwise, signals to skip equality if this is a pattern
    (If (Unify.skip a)
      (Checker.pure 1)
      (else)))

// If LHS is a solveable pattern, generates its solution.
// Unify.solve : Term -> Term -> U60 -> (Map U60 Term) -> (Maybe (Pair nam Term))
(Unify.solve (App fun (Var nam idx)) b dep ctx) =
  (Maybe.bind (Map.ins λaλb(== a b) idx $x ctx) λctx
  (Maybe.bind (Unify.solve fun b dep ctx) λkv 
  (Pair.get kv λkλv(Maybe.pure (Pair k (Lam nam λ$x(v)))))))
(Unify.solve (Met nam None) b dep ctx) =
  (Maybe.bind (Unify.solution b dep nam ctx) λneo
  (Maybe.pure (Pair nam neo)))
(Unify.solve (App fun (Ann val _))        b dep ctx) = (Unify.solve (App fun val) b dep ctx)
(Unify.solve (App fun (Ins val))          b dep ctx) = (Unify.solve (App fun val) b dep ctx)
(Unify.solve (App fun (Src _ val))        b dep ctx) = (Unify.solve (App fun val) b dep ctx)
(Unify.solve (App fun (Met _ (Some val))) b dep ctx) = (Unify.solve (App fun val) b dep ctx)
(Unify.solve (Ann val typ)                b dep ctx) = (Unify.solve val b dep ctx)
(Unify.solve (Ins val)                    b dep ctx) = (Unify.solve val b dep ctx)
(Unify.solve (Src src val)                b dep ctx) = (Unify.solve val b dep ctx)
(Unify.solve (Met nam (Some val))         b dep ctx) = (Unify.solve val b dep ctx)
(Unify.solve other                        b dep ctx) = None

// If LHS is an unsolveable pattern, skips its type-checking.
// Unify.skip : Term -> Bool
(Unify.skip (App fun arg))  = (Unify.skip fun)
(Unify.skip (Ann val typ))  = (Unify.skip val)
(Unify.skip (Ins val))      = (Unify.skip val)
(Unify.skip (Src src val))  = (Unify.skip val)
(Unify.skip (Met nam None)) = 1
(Unify.skip (Hol nam ctx))  = 1
(Unify.skip other)          = 0

// Attempts to convert RHS to a solution, checking the criteria.
// Unify.solution : Term -> U60 -> String -> (Map U60 Term) -> (Maybe Term)
(Unify.solution (All nam inp bod) dep hol ctx) =
  (Maybe.bind (Unify.solution inp dep hol ctx) λinp
  (Maybe.bind (Unify.solution (bod (Var nam dep)) (+ dep 1) hol ctx) λbod
  (Maybe.pure (All nam inp λ_(bod)))))
(Unify.solution (Lam nam bod) dep hol ctx) =
  (Maybe.bind (Unify.solution (bod (Var nam dep)) (+ 1 dep) hol ctx) λbod
  (Maybe.pure (Lam nam λ_(bod))))
(Unify.solution (App fun arg) dep hol ctx) =
  (Maybe.bind (Unify.solution fun dep hol ctx) λfun
  (Maybe.bind (Unify.solution arg dep hol ctx) λarg
  (Maybe.pure (App fun arg))))
(Unify.solution (Ann val typ) dep hol ctx) =
  (Maybe.bind (Unify.solution val dep hol ctx) λval
  (Maybe.bind (Unify.solution typ dep hol ctx) λtyp
  (Maybe.pure (Ann val typ))))
(Unify.solution (Slf nam typ bod) dep hol ctx) =
  (Unify.solution typ dep hol ctx)
(Unify.solution (Ins val) dep hol ctx) =
  (Maybe.bind (Unify.solution val dep hol ctx) λval
  (Maybe.pure (Ins val)))
(Unify.solution (Ref nam sub val) dep hol ctx) =
  (Maybe.pure (Ref nam sub val))
(Unify.solution (Let nam val bod) dep hol ctx) =
  (Maybe.bind (Unify.solution val dep hol ctx) λval
  (Maybe.bind (Unify.solution (bod (Var nam dep)) (+ 1 dep) hol ctx) λbod
  (Maybe.pure (Let nam val λ_(bod)))))
(Unify.solution (Met nam None) dep hol ctx) =
  None // holes can't appear in the solution
  //(If (Same nam hol) None (Maybe.pure (Met nam None)))
(Unify.solution (Met nam (Some val)) dep hol ctx) =
  (Maybe.bind (Unify.solution val dep hol ctx) λval
  (Maybe.pure (Met nam (Some val))))
(Unify.solution (Hol nam _) dep hol ctx) =
  (Maybe.pure (Hol nam [])) // FIXME?
(Unify.solution Set dep hol ctx) =
  (Maybe.pure Set)
(Unify.solution U60 dep hol ctx) =
  (Maybe.pure U60)
(Unify.solution (Num val) dep hol ctx) =
  (Maybe.pure (Num val))
(Unify.solution (Op2 opr fst snd) dep hol ctx) =
  (Maybe.bind (Unify.solution fst dep hol ctx) λfst
  (Maybe.bind (Unify.solution snd dep hol ctx) λsnd
  (Maybe.pure (Op2 opr fst snd))))
(Unify.solution (Mat nam x z s p) dep hol ctx) =
  (Maybe.bind (Unify.solution x dep hol ctx) λx
  (Maybe.bind (Unify.solution z dep hol ctx) λz
  (Maybe.bind (Unify.solution (s (Var (String.concat nam "-1") dep)) dep hol ctx) λs
  (Maybe.bind (Unify.solution (p (Var nam dep)) dep hol ctx) λp
  (Maybe.pure (Mat nam x z λ_(s) λ_(p)))))))
(Unify.solution (Txt val) dep hol ctx) =
  (Maybe.pure (Txt val))
(Unify.solution (Var nam idx) dep hol ctx) =
  (Maybe.bind (Map.get λaλb(== a b) idx ctx) λval
  (Maybe.pure val))
(Unify.solution (Src src val) dep hol ctx) =
  (Maybe.bind (Unify.solution val dep hol ctx) λval
  (Maybe.pure (Src src val)))
(Unify.solution term dep hol ctx) =
  (HVM.log (UNREACHALBE (Show term dep)) None)

// Type-Checking
// -------------

(IfAll (All nam inp bod) yep nop) = (yep nam inp bod)
(IfAll other             yep nop) = nop

(IfSlf (Slf nam typ bod) yep nop) = (yep nam typ bod)
(IfSlf other             yep nop) = nop

//(Infer term dep) = (Print dep ["Infer: " (Show term dep)] (Infer.match term dep))
(Infer term dep) = (Infer.match term dep)

(Infer.match (All nam inp bod) dep) =
  (Checker.bind (Check 0 inp Set dep) λinp_typ
  (Checker.bind (Check 0 (bod (Ann (Var nam dep) inp)) Set (+ 1 dep)) λbod_typ
  (Checker.pure Set)))
(Infer.match (App fun arg) dep) =
  (Checker.bind (Infer fun dep) λfun_typ
  ((IfAll (Reduce 2 fun_typ)
    λfun_nam λfun_typ.inp λfun_typ.bod λfun λarg
      (Checker.bind (Check 0 arg fun_typ.inp dep) λvty
      (Checker.pure (fun_typ.bod arg)))
    λfun λarg
      (Checker.fail (Error 0 fun_typ (All "x" (Hol "_" []) (Hol "_" [])) (App fun arg) dep)))
    fun arg))
(Infer.match (Ann val typ) dep) =
  (Checker.pure typ)
(Infer.match (Slf nam typ bod) dep) =
  (Checker.bind (Check 0 (bod (Ann (Var nam dep) typ)) Set (+ dep 1)) λslf
  (Checker.pure Set))
(Infer.match (Ins val) dep) =
  (Checker.bind (Infer val dep) λvty
  ((IfSlf (Reduce 2 vty)
    λvty.nam λvty.typ λvty.bod λval
      (Checker.pure (vty.bod (Ins val)))
    λval
      (Checker.fail (NonSlfIns (Ins val))))
    val))
(Infer.match (Ref nam sub val) dep) = 
  (Infer val dep)
(Infer.match Set dep) =
  (Checker.pure Set)
(Infer.match U60 dep) =
  (Checker.pure Set)
(Infer.match (Num num) dep) =
  (Checker.pure U60)
(Infer.match (Txt txt) dep) =
  (Checker.pure Book.String)
(Infer.match (Op2 opr fst snd) dep) =
  (Checker.bind (Check 0 fst U60 dep) λfst
  (Checker.bind (Check 0 snd U60 dep) λsnd
  (Checker.pure U60)))
(Infer.match (Mat nam x z s p) dep) =
  (Checker.bind (Check 0 x U60 dep) λx_typ
  (Checker.bind (Check 0 (p (Ann (Var nam dep) U60)) Set dep) λp_typ
  (Checker.bind (Check 0 z (p (Num 0)) dep) λz_typ
  (Checker.bind (Check 0 (s (Ann (Var (String.concat nam "-1") dep) U60)) (p (Op2 ADD (Num 1) (Var (String.concat nam "-1") dep))) (+ dep 1)) λs_typ
  (Checker.pure (p x))))))
(Infer.match (Lam nam bod) dep) =
  (Checker.fail (Error 0 (Hol "" []) (All "x" (Hol "_" []) (Hol "_" [])) (Lam nam bod) dep))
(Infer.match (Let nam val bod) dep) =
  (Checker.fail (Error 0 (Hol "" []) (Hol "type" []) (Let nam val bod) dep))
(Infer.match (Hol nam ctx) dep) =
  (Checker.fail (Error 0 (Hol "" []) (Hol "type" []) (Hol nam ctx) dep))
(Infer.match (Met nam (Some val)) dep) =
  (Infer.match val dep)
(Infer.match (Met nam None) dep) =
  (Checker.fail (Error 0 (Hol "" []) (Hol "type" []) (Met nam None) dep))
(Infer.match (Var nam idx) dep) =
  (Checker.fail (Error 0 (Hol "" []) (Hol "type" []) (Var nam idx) dep))
(Infer.match (Src src val) dep) =
  (Infer.match val dep)

//(Check src term type dep) = (Print dep ["Check: " (Show term dep) " :: " (Show type dep) " ~> " (Show (Reduce 1 type) dep)] (Check.match src term type dep))
(Check src term type dep) = (Check.match src term type dep)

(Check.match src (Lam term.nam term.bod) type dep) =
  ((IfAll (Reduce 2 type)
    λtype.nam λtype.inp λtype.bod λterm.bod
      let ann  = (Ann (Var term.nam dep) type.inp)
      let term = (term.bod ann)
      let type = (type.bod ann)
      (Check 0 term type (+ dep 1))
    λterm.bod
      (Infer (Lam term.nam term.bod) dep))
    term.bod)
(Check.match src (Ins term.val) type dep) =
  ((IfSlf (Reduce 2 type)
    λtype.nam λtype.typ λtype.bod λterm.val
      (Check 0 term.val (type.bod (Ins term.val)) dep)
    λterm.val
      (Infer (Ins term.val) dep))
    term.val)
(Check.match src (Let term.nam term.val term.bod) type dep) =
  (Check 0 (term.bod term.val) type (+ 1 dep))
(Check.match src (Hol term.nam term.ctx) type dep) =
  (Checker.bind (Checker.log (Found term.nam type term.ctx dep)) λx
  (Checker.pure 0))
(Check.match src (Met term.nam (Some term.val)) type dep) =
  (Check src term.val type dep)
(Check.match src (Met term.nam None) type dep) =
  (Checker.pure 0)
(Check.match src (Ref term.nam term.sub (Ann term.val term.typ)) type dep) = // better printing
  (Checker.bind (Equal type term.typ dep) λequal
  (Check.report src equal term.typ type (Ref term.nam term.sub term.val) dep))
(Check.match src (Src term.src term.val) type dep) =
  (Check term.src term.val type dep)
//(Check.match src (Ref term.nam term.val) type dep) =
  //(Check term.val type dep)
(Check.match src term type dep) =
  (Check.verify src term type dep)

(Check.verify src term type dep) =
  (Checker.bind (Infer term dep) λinfer
  (Checker.bind (Equal type infer dep) λequal
  (Check.report src equal infer type term dep)))

(Check.report src 0 detected expected value dep) =
  (Checker.fail (Error src detected expected value dep))
(Check.report src n detected expected value dep) =
  (Checker.pure 0)

// Syntax
// ------

(Show (All nam inp bod) dep) =
  let nam = nam
  let inp = (Show inp dep)
  let bod = (Show (bod (Var nam dep)) (+ dep 1))
  (String.join ["∀(" nam ": " inp ") " bod])
(Show (Lam nam bod) dep) =
  let nam = nam
  let bod = (Show (bod (Var nam dep)) (+ dep 1))
  (String.join ["λ" nam " " bod])
(Show (App fun arg) dep) =
  let fun = (Show.unwrap (Show fun dep))
  let arg = (Show arg dep)
  (String.join ["(" fun " " arg ")"])
(Show (Ann val typ) dep) =
  let val = (Show val dep)
  let typ = (Show typ dep)
  (String.join ["{" val ": " typ "}"])
(Show (Slf nam typ bod) dep) =
  let nam = nam
  let typ = (Show typ dep)
  let bod = (Show (bod (Var nam dep)) (+ dep 1))
  (String.join ["$(" nam ": " typ ") " bod])
(Show (Ins val) dep) =
  let val = (Show val dep)
  (String.join ["~" val])
(Show (Ref nam sub val) dep) =
  nam
(Show (Let nam val bod) dep) =
  let nam = nam
  let val = (Show val dep)
  let bod = (Show (bod (Var nam dep)) (+ dep 1))
  (String.join ["let " nam " = " val "; " bod])
(Show Set dep) =
  "*"
(Show U60 dep) =
  "#U60"
(Show (Num val) dep) =
  let val = (U60.show val)
  (String.join ["#" val])
(Show (Op2 opr fst snd) dep) =
  let opr = (Op2.show opr)
  let fst = (Show fst dep)
  let snd = (Show snd dep)
  (String.join ["#(" opr " " fst " " snd ")"])
(Show (Mat nam x z s p) dep) =
  let nam = nam
  let x   = (Show x dep)
  let z   = (Show z dep)
  let s   = (Show (s (Var (String.concat nam "-1") dep)) (+ dep 1))
  let p   = (Show (p (Var nam dep)) dep)
  (String.join ["#match " nam " = " x " { #0: " z " #+: " s " }: " p])
(Show (Txt txt) dep) =
  (String.join [Quote txt Quote])
(Show (Hol nam ctx) dep) =
  (String.join ["? " nam])
(Show (Met nam None) dep) =
  "_"
(Show (Met nam (Some val)) dep) =
  (Show val dep)
(Show (Var nam idx) dep) =
  nam
(Show (Src src val) dep) =
  (Show val dep)

//(Show.many List.nil         dep) = ""
//(Show.many (List.cons x xs) dep) = (String.join [" " (Show x dep) (Show.many xs dep)])

(Show.trim (String.cons ' ' xs)) = xs
(Show.trim str)                  = str

(Show.unwrap (String.cons '(' xs)) = (Show.begin xs)
(Show.unwrap str)                  = str

(Show.begin (String.cons x (String.cons y String.nil))) = (String.cons x String.nil)
(Show.begin (String.cons x xs))                         = (String.cons x (Show.begin xs))
(Show.begin String.nil)                                 = String.nil

(Op2.show ADD) = "+"
(Op2.show SUB) = "-"
(Op2.show MUL) = "*"
(Op2.show DIV) = "/"
(Op2.show MOD) = "%"
(Op2.show EQ)  = "=="
(Op2.show NE)  = "!="
(Op2.show LT)  = "<"
(Op2.show GT)  = ">"
(Op2.show LTE) = "<="
(Op2.show GTE) = ">="
(Op2.show AND) = "&"
(Op2.show OR)  = "|"
(Op2.show XOR) = "^"
(Op2.show LSH) = "<<"
(Op2.show RSH) = ">>"

(Context.show List.nil         dep) = ""
(Context.show (List.cons x xs) dep) = (String.join [" " (Context.show.ann x dep) (Context.show xs dep)])

(Context.show.ann (Ann val typ) dep) = (String.join ["{" (Show (Normal 0 val dep) dep) ": " (Show (Normal 0 typ dep) dep) "}"])
(Context.show.ann term          dep) = (Show (Normal 0 term dep) dep)

(Message.show (Found name type ctx dep)) =
  let type  = (Show (Normal 1 type dep) dep)
  let ctx   = (String.tail (Context.show ctx dep))
  (String.join ["#found{" name " " type " [" ctx "]}"])
(Message.show (Error src detected expected value dep)) =
  let det = (Show (Normal 1 detected dep) dep)
  let exp = (Show (Normal 1 expected dep) dep)
  let val = (Show (Normal 1 value dep) dep)
  (String.join ["#error{" exp " " det " " val " " (U60.show src) "}"])
(Message.show (Solve name term dep)) =
  let term = (Show (Normal 1 term dep) dep)
  (String.join ["#solve{" name " "  term "}"])
(Message.show (Vague name)) =
  (String.join ["#vague{" name "}"])

// Compilation
// -----------

(Str.view str) = (str 0 λheadλtail(String.cons head (Str.view tail)) String.nil)

(Str.make (String.cons x xs)) = λP λcons λnil (cons x (Str.make xs))
(Str.make String.nil)         = λP λcons λnil nil

Compile.primitives = [
  (Pair "HVM.log" λA λB λmsg λret (HVM.log msg ret))
  (Pair "HVM.print" λA λmsg λret (HVM.print (Str.view msg) ret))
  (Pair "HVM.save" λA λname λdata λret (HVM.save (Str.view name) (Str.view data) ret))
  (Pair "HVM.load" λA λname λret (HVM.load (Str.view name) λdata (ret (Str.make data))))
]

(Compile (All nam inp bod)) = 0
(Compile (Lam nam bod))     = λx(Compile (bod (Var "" x)))
(Compile (App fun arg))     = ((Compile fun) (Compile arg))
(Compile (Ann val typ))     = (Compile val)
(Compile (Slf nam typ bod)) = 0
(Compile (Ins val))         = (Compile val)
(Compile (Ref nam sub val)) = (Compile.ref Compile.primitives nam val)
(Compile (Let nam val bod)) = (Compile (bod val))
(Compile Set)               = 0
(Compile U60)               = 0
(Compile (Num val))         = val
(Compile (Op2 opr fst snd)) = (Compile.op2 opr (Compile fst) (Compile snd))
(Compile (Mat nam x z s p)) = (Compile.mat (Compile x) (Compile z) λx(Compile (s (Var "" x))))
(Compile (Txt txt))         = (Str.make txt)
(Compile (Hol nam ctx))     = 0
(Compile (Var nam val))     = val
(Compile (Src src val))     = (Compile val)

//(Compile.txt (String.cons x xs)) = (App (App Book.String.cons (Num x)) (Compile.txt xs))
//(Compile.txt String.nil)         = Book.String.nil

(Compile.op2 ADD fst snd) = (+ fst snd)
(Compile.op2 SUB fst snd) = (- fst snd)
(Compile.op2 MUL fst snd) = (* fst snd)
(Compile.op2 DIV fst snd) = (/ fst snd)
(Compile.op2 MOD fst snd) = (% fst snd)
(Compile.op2 EQ  fst snd) = (== fst snd)
(Compile.op2 NE  fst snd) = (!= fst snd)
(Compile.op2 LT  fst snd) = (< fst snd)
(Compile.op2 GT  fst snd) = (> fst snd)
(Compile.op2 LTE fst snd) = (<= fst snd)
(Compile.op2 GTE fst snd) = (>= fst snd)
(Compile.op2 AND fst snd) = (& fst snd)
(Compile.op2 OR  fst snd) = (| fst snd)
(Compile.op2 XOR fst snd) = (^ fst snd)
(Compile.op2 LSH fst snd) = (<< fst snd)
(Compile.op2 RSH fst snd) = (>> fst snd)

(Compile.mat 0 z s) = z
(Compile.mat n z s) = (s (- n 1))

(Compile.ref (List.cons (Pair prim_name prim_func) prims) nam val) = (If (Same prim_name nam) prim_func (Compile.ref prims nam val))
(Compile.ref List.nil                                     nam val) = (Compile val)

// API
// ---

// Normalizes a definition.
(API.normal (Ref nam sub val)) =
  (Compile (Subst sub val))

// Checks a definition.
(API.check (Ref nam sub def)) =
  //(HVM.print (String.join ["API.check: " (Show (Subst sub def) 0)])
  (Result.match (Checker.run (API.check.do (Subst sub def)))
    // case done:
    λlogs λvalue
      //(API.check.log logs
      (Pair.get (API.check.fill sub logs) λfilled λsub
      (If filled
        // case true:
        (API.check (Ref nam sub def))
        // case false:
        (API.check.vague sub)))
    // case fail:
    λlogs λerror
      (API.check.log logs
      (API.check.log [error] 0)))

// Calls the type-checker *under* the metavar binders.
//(API.check.fn (List.cons _ subs) val) = λx (API.check.fn subs (val x))
//(API.check.fn List.nil           val) = (API.check.do val)

// Calls check on typed defs and infer on untyped defs.
(API.check.do (Ann val typ)) = (Check 0 val typ 0)
(API.check.do val)           = (Infer val 0)

// Moves solutions from the checker logs to a ref's subst list.
(API.check.fill sub (List.cons (Solve k v d) xs)) = (Pair.get (API.check.fill sub xs) λokλmap(Pair 1 (Map.set λxλy(Same x y) k (Some v) sub)))
(API.check.fill sub (List.cons message xs))       = (API.check.fill sub xs)
(API.check.fill sub List.nil)                     = (Pair 0 sub)

// Prints all messages returned by the checker.
(API.check.log (List.cons msg msgs) then) = (HVM.print (Message.show msg) (API.check.log msgs then))
(API.check.log List.nil             then) = then

// Reports solved holdes
(API.check.vague (List.cons (Pair name None)     xs)) = (HVM.print (Message.show (Vague name)) (& 0 (API.check.vague xs)))
(API.check.vague (List.cons (Pair name (Some x)) xs)) = (API.check.vague xs)
(API.check.vague List.nil)                            = 1

Book.Bool = (Ref "Bool" [] (Ann (Src 64871197573229 (Slf "self" (Src 64871205961751 (Book.Bool)) λxself (Src 64871214350445 (All "P" (Src 64871221690416 (All "x" (Src 64871229030445 (Book.Bool)) λxx (Src 64871235321904 (Set)))) λxP (Src 64871240564845 (All "t" (Src 64871247904840 (App (Src 64871248953405 xP) (Src 64871251050567 (Book.Bool.true)))) λxt (Src 64871265730669 (All "f" (Src 64871273070689 (App (Src 64871274119253 xP) (Src 64871276216416 (Book.Bool.false)))) λxf (Src 64871291945069 (App (Src 64871292993639 xP) (Src 64871295090796 xself))))))))))) (Src 64871193378824 (Set))))
Book.Bool.and = (Ref "Bool.and" [] (Ann (Src 95657561948315 (Lam "a" λxa (Src 95657568239771 (Let "P" (Src 95657580822614 (Lam "a" λxa (Src 95657585016918 (All "b" (Src 95657591308368 (Book.Bool)) λxb (Src 95657597599830 (Book.Bool)))))) λxP (Src 95657604939931 (Let "true" (Src 95657617522794 (Lam "b" λxb (Src 95657621717098 xb))) λxtrue (Src 95657625911451 (Let "false" (Src 95657638494343 (Lam "b" λxb (Src 95657642688647 (Book.Bool.false)))) λxfalse (Src 95657656320155 (App (App (App (Src 95657657368717 (Ins (Src 95657658417293 xa))) (Src 95657660514447 xP)) (Src 95657662611604 xtrue)) (Src 95657667854490 xfalse))))))))))) (Src 95657523150893 (All "a" (Src 95657530490902 (Book.Bool)) λxa (Src 95657538879533 (All "b" (Src 95657546219557 (Book.Bool)) λxb (Src 95657554608173 (Book.Bool))))))))
Book.Bool.false = (Ref "Bool.false" [] (Ann (Src 65970718638114 (Ins (Src 65970719686690 (Lam "P" λxP (Src 65970723880994 (Lam "t" λxt (Src 65970728075298 (Lam "f" λxf (Src 65970732269602 xf))))))))) (Src 65970711298065 (Book.Bool))))
Book.Bool.true = (Ref "Bool.true" [] (Ann (Src 63771694333985 (Ins (Src 63771695382561 (Lam "P" λxP (Src 63771699576865 (Lam "t" λxt (Src 63771703771169 (Lam "f" λxf (Src 63771707965473 xt))))))))) (Src 63771686993936 (Book.Bool))))
Book.Char = (Ref "Char" [] (Ann (Src 6597081301007 (U60)) (Src 6597077106696 (Set))))
Book.HVM.load = (Ref "HVM.load" [] (Ann (Src 16492755157106 (Lam "A" λxA (Src 16492759351410 (Lam "file" λxfile (Src 16492766691442 (Lam "cont" λxcont (Src 16492776128626 (App (Src 16492777177190 xcont) (Src 16492782420081 (Book.String.nil)))))))))) (Src 16492685951050 (All "A" (Src 16492693291027 (Set)) λxA (Src 16492698533962 (All "file" (Src 16492709019687 (Book.String)) λxfile (Src 16492719505482 (All "cont" (Src 16492729991237 (All "x" (Src 16492737331266 (Book.String)) λxx (Src 16492745719877 xA))) λxcont (Src 16492750962762 xA)))))))))
Book.HVM.print = (Ref "HVM.print" [] (Ann (Src 18691761635410 (Lam "A" λxA (Src 18691765829714 (Lam "msg" λxmsg (Src 18691772121170 (Lam "ret" λxret (Src 18691780509778 xret))))))) (Src 18691710255162 (All "A" (Src 18691717595156 (Set)) λxA (Src 18691722838074 (All "msg" (Src 18691732275239 (Book.String)) λxmsg (Src 18691742761018 (All "ret" (Src 18691752198197 xA) λxret (Src 18691757441082 xA)))))))))
Book.HVM.save = (Ref "HVM.save" [] (Ann (Src 19791295283313 (Lam "A" λxA (Src 19791299477617 (Lam "file" λxfile (Src 19791306817649 (Lam "data" λxdata (Src 19791314157681 (Lam "cont" λxcont (Src 19791323594865 xcont))))))))) (Src 19791220834383 (All "A" (Src 19791228174355 (Set)) λxA (Src 19791233417295 (All "file" (Src 19791243903015 (Book.String)) λxfile (Src 19791254388815 (All "data" (Src 19791264874555 (Book.String)) λxdata (Src 19791275360335 (All "cont" (Src 19791285846090 xA) λxcont (Src 19791291088975 xA)))))))))))
Book.IO = (Ref "IO" [] (Ann (Src 2199043178912 (Lam "A" λxA (Src 2199049470368 (Slf "self" (Src 2199057858599 (App (Src 2199058907172 (Book.IO)) (Src 2199062052902 xA))) λxself (Src 2199068344736 (All "P" (Src 2199075684418 (All "x" (Src 2199083024447 (App (Src 2199084073020 (Book.IO)) (Src 2199087218750 xA))) λxx (Src 2199091413058 (Set)))) λxP (Src 2199096656288 (All "print" (Src 2199108190364 (All "text" (Src 2199118676065 (Book.String)) λxtext (Src 2199127064732 (All "then" (Src 2199137550464 (All "x" (Src 2199144890488 (Book.Unit)) λxx (Src 2199151181952 (App (Src 2199152230525 (Book.IO)) (Src 2199155376255 xA))))) λxthen (Src 2199159570588 (App (Src 2199160619140 xP) (Src 2199162716315 (App (App (App (Src 2199163764878 (Book.IO.print)) (Src 2199173202064 xA)) (Src 2199175299221 xtext)) (Src 2199180542106 xthen))))))))) λxprint (Src 2199191028128 (All "load" (Src 2199201513718 (All "file" (Src 2199211999418 (Book.String)) λxfile (Src 2199220388086 (All "then" (Src 2199230873819 (All "x" (Src 2199238213843 (Book.String)) λxx (Src 2199246602459 (App (Src 2199247651032 (Book.IO)) (Src 2199250796762 xA))))) λxthen (Src 2199254991094 (App (Src 2199256039647 xP) (Src 2199258136821 (App (App (App (Src 2199259185384 (Book.IO.load)) (Src 2199267573994 xA)) (Src 2199269671151 xfile)) (Src 2199274914036 xthen))))))))) λxload (Src 2199285399968 (All "save" (Src 2199295885669 (All "file" (Src 2199306371348 (Book.String)) λxfile (Src 2199314760037 (All "data" (Src 2199325245734 (Book.String)) λxdata (Src 2199333634405 (All "then" (Src 2199344120133 (All "x" (Src 2199351460157 (Book.Unit)) λxx (Src 2199357751621 (App (Src 2199358800194 (Book.IO)) (Src 2199361945924 xA))))) λxthen (Src 2199366140261 (App (Src 2199367188809 xP) (Src 2199369285988 (App (App (App (App (Src 2199370334546 (Book.IO.save)) (Src 2199378723156 xA)) (Src 2199380820313 xfile)) (Src 2199386063198 xdata)) (Src 2199391306083 xthen))))))))))) λxsave (Src 2199401791904 (All "done" (Src 2199412277652 (All "term" (Src 2199422763390 xA) λxterm (Src 2199425909140 (App (Src 2199426957698 xP) (Src 2199429054867 (App (App (Src 2199430103435 (Book.IO.done)) (Src 2199438492045 xA)) (Src 2199440589202 xterm))))))) λxdone (Src 2199451074976 (App (Src 2199452123546 xP) (Src 2199454220703 xself))))))))))))))))) (Src 2199028498448 (All "A" (Src 2199035838477 (Set)) λxA (Src 2199038984208 (Set))))))
Book.IO.done = (Ref "IO.done" [] (Ann (Src 3298583117930 (Lam "A" λxA (Src 3298587312234 (Lam "term" λxterm (Src 3298596749418 (Ins (Src 3298597797994 (Lam "P" λxP (Src 3298601992298 (Lam "print" λxprint (Src 3298610380906 (Lam "load" λxload (Src 3298617720938 (Lam "save" λxsave (Src 3298625060970 (Lam "done" λxdone (Src 3298634498154 (App (Src 3298635546724 xdone) (Src 3298640789609 xterm))))))))))))))))))) (Src 3298545369131 (All "A" (Src 3298552709138 (Set)) λxA (Src 3298557952043 (All "term" (Src 3298568437793 xA) λxterm (Src 3298573680683 (App (Src 3298574729256 (Book.IO)) (Src 3298577874986 xA)))))))))
Book.IO.load = (Ref "IO.load" [] (Ann (Src 4398136688798 (Lam "A" λxA (Src 4398140883102 (Lam "file" λxfile (Src 4398148223134 (Lam "then" λxthen (Src 4398157660318 (Ins (Src 4398158708894 (Lam "P" λxP (Src 4398162903198 (Lam "print" λxprint (Src 4398171291806 (Lam "load" λxload (Src 4398178631838 (Lam "save" λxsave (Src 4398185971870 (Lam "done" λxdone (Src 4398195409054 (App (App (Src 4398196457619 xload) (Src 4398201700504 xfile)) (Src 4398206943389 xthen))))))))))))))))))))) (Src 4398056996947 (All "A" (Src 4398064336914 (Set)) λxA (Src 4398069579859 (All "file" (Src 4398080065574 (Book.String)) λxfile (Src 4398090551379 (All "then" (Src 4398101037129 (All "x" (Src 4398108377153 (Book.String)) λxx (Src 4398116765769 (App (Src 4398117814342 (Book.IO)) (Src 4398120960072 xA))))) λxthen (Src 4398127251539 (App (Src 4398128300112 (Book.IO)) (Src 4398131445842 xA)))))))))))
Book.IO.print = (Ref "IO.print" [] (Ann (Src 10995205406878 (Lam "A" λxA (Src 10995209601182 (Lam "text" λxtext (Src 10995216941214 (Lam "then" λxthen (Src 10995226378398 (Ins (Src 10995227426974 (Lam "P" λxP (Src 10995231621278 (Lam "print" λxprint (Src 10995240009886 (Lam "load" λxload (Src 10995247349918 (Lam "save" λxsave (Src 10995254689950 (Lam "done" λxdone (Src 10995264127134 (App (App (Src 10995265175699 xprint) (Src 10995271467160 xtext)) (Src 10995276710045 xthen))))))))))))))))))))) (Src 10995127812178 (All "A" (Src 10995135152147 (Set)) λxA (Src 10995140395090 (All "text" (Src 10995150880807 (Book.String)) λxtext (Src 10995161366610 (All "then" (Src 10995171852360 (All "x" (Src 10995179192384 (Book.Unit)) λxx (Src 10995185483848 (App (Src 10995186532421 (Book.IO)) (Src 10995189678151 xA))))) λxthen (Src 10995195969618 (App (Src 10995197018191 (Book.IO)) (Src 10995200163921 xA)))))))))))
Book.IO.print.do = (Ref "IO.print.do" [] (Ann (Src 114349257523298 (Lam "text" λxtext (Src 114349266960482 (App (App (App (Src 114349268009024 (Book.IO.print)) (Src 114349277446213 (Book.Unit))) (Src 114349282689098 xtext)) (Src 114349287932001 (Lam "x" λxx (Src 114349294223457 (App (App (Src 114349295272025 (Book.IO.done)) (Src 114349303660638 (Book.Unit))) (Src 114349308903520 xx))))))))) (Src 114349223968811 (All "text" (Src 114349234454558 (Book.String)) λxtext (Src 114349244940331 (App (Src 114349245988901 (Book.IO)) (Src 114349249134634 (Book.Unit))))))))
Book.IO.run = (Ref "IO.run" [] (Ann (Src 15393212072325 (Lam "A" λxA (Src 15393216266629 (Lam "x" λxx (Src 15393222558085 (Let "P" (Src 15393235140686 (Lam "x" λxx (Src 15393238286414 (App (Src 15393239334987 (Book.IO)) (Src 15393242480717 xA))))) λxP (Src 15393247723909 (Let "print" (Src 15393260306589 (Lam "text" λxtext (Src 15393267646621 (Lam "then" λxthen (Src 15393274986653 (App (App (App (Src 15393276035189 (Book.HVM.print)) (Src 15393286520956 (App (Src 15393287569529 (Book.IO)) (Src 15393290715259 xA)))) (Src 15393293860993 xtext)) (Src 15393299103900 (App (App (Src 15393300152457 (Book.IO.run)) (Src 15393307492491 xA)) (Src 15393309589659 (App (Src 15393310638225 xthen) (Src 15393315881114 (Book.Unit.one)))))))))))) λxprint (Src 15393330561413 (Let "load" (Src 15393343144167 (Lam "file" λxfile (Src 15393350484199 (Lam "then" λxthen (Src 15393357824231 (App (App (App (Src 15393358872771 (Book.HVM.load)) (Src 15393368309962 (App (Src 15393369358535 (Book.IO)) (Src 15393372504265 xA)))) (Src 15393375649999 xfile)) (Src 15393380892902 (Lam "s" λxs (Src 15393384038630 (App (App (Src 15393385087194 (Book.IO.run)) (Src 15393392427228 xA)) (Src 15393394524389 (App (Src 15393395572962 xthen) (Src 15393400815844 xs))))))))))))) λxload (Src 15393408156037 (Let "save" (Src 15393420738881 (Lam "file" λxfile (Src 15393428078913 (Lam "data" λxdata (Src 15393435418945 (Lam "then" λxthen (Src 15393442758977 (App (App (App (App (Src 15393443807508 (Book.HVM.save)) (Src 15393453244699 (App (Src 15393454293272 (Book.IO)) (Src 15393457439002 xA)))) (Src 15393460584736 xfile)) (Src 15393465827621 xdata)) (Src 15393471070528 (App (App (Src 15393472119085 (Book.IO.run)) (Src 15393479459119 xA)) (Src 15393481556287 (App (Src 15393482604853 xthen) (Src 15393487847742 (Book.Unit.one)))))))))))))) λxsave (Src 15393502527877 (Let "done" (Src 15393515110759 (Lam "term" λxterm (Src 15393522450791 (App (App (Src 15393523499359 (Book.IO.done)) (Src 15393531887969 xA)) (Src 15393533985126 xterm))))) λxdone (Src 15393542373765 (App (App (App (App (App (Src 15393543422317 (Ins (Src 15393544470893 xx))) (Src 15393546568047 xP)) (Src 15393548665205 xprint)) (Src 15393554956666 xload)) (Src 15393560199551 xsave)) (Src 15393565442436 xdone))))))))))))))))) (Src 15393172226092 (All "A" (Src 15393179566097 (Set)) λxA (Src 15393184809004 (All "x" (Src 15393192149026 (App (Src 15393193197599 (Book.IO)) (Src 15393196343329 xA))) λxx (Src 15393202634796 (App (Src 15393203683369 (Book.IO)) (Src 15393206829099 xA)))))))))
Book.IO.save = (Ref "IO.save" [] (Ann (Src 14293760213180 (Lam "A" λxA (Src 14293764407484 (Lam "file" λxfile (Src 14293771747516 (Lam "data" λxdata (Src 14293779087548 (Lam "then" λxthen (Src 14293788524732 (Ins (Src 14293789573308 (Lam "P" λxP (Src 14293793767612 (Lam "print" λxprint (Src 14293802156220 (Lam "load" λxload (Src 14293809496252 (Lam "save" λxsave (Src 14293816836284 (Lam "done" λxdone (Src 14293826273468 (App (App (App (Src 14293827322028 xsave) (Src 14293832564913 xfile)) (Src 14293837807798 xdata)) (Src 14293843050683 xthen))))))))))))))))))))))) (Src 14293661646949 (All "A" (Src 14293668986898 (Set)) λxA (Src 14293674229861 (All "file" (Src 14293684715558 (Book.String)) λxfile (Src 14293695201381 (All "data" (Src 14293705687098 (Book.String)) λxdata (Src 14293716172901 (All "then" (Src 14293726658651 (All "x" (Src 14293733998675 (Book.Unit)) λxx (Src 14293740290139 (App (Src 14293741338712 (Book.IO)) (Src 14293744484442 xA))))) λxthen (Src 14293750775909 (App (Src 14293751824482 (Book.IO)) (Src 14293754970212 xA)))))))))))))
Book.Kind.API.check = (Ref "Kind.API.check" [] (Ann (Src 1099566154026 (Lam "term" λxterm (Src 1099575591210 (App (App (Src 1099576639556 (Book.IO.run)) (Src 1099583979593 (Book.Unit))) (Src 1099591319849 (App (App (App (App (Src 1099592368216 (Book.Kind.if.ref)) (Src 1099604951133 xterm)) (Src 1099610194023 (App (Src 1099611242593 (Book.IO)) (Src 1099614388326 (Book.Unit))))) (Src 1099620679816 (Lam "nam" λxnam (Src 1099626971272 (Lam "val" λxval (Src 1099633262728 (App (Src 1099634311299 (Book.Kind.API.check)) (Src 1099650039943 xval)))))))) (Src 1099655282984 (Lam "term" λxterm (Src 1099664720168 (App (App (App (App (Src 1099665768606 (Book.Kind.if.ann)) (Src 1099678351523 xterm)) (Src 1099683594413 (App (Src 1099684642983 (Book.IO)) (Src 1099687788716 (Book.Unit))))) (Src 1099694080237 (Lam "val" λxval (Src 1099700371693 (Lam "typ" λxtyp (Src 1099706663149 (App (Src 1099707711694 (Book.Kind.API.check.done)) (Src 1099728683244 (App (App (App (Src 1099729731802 (Book.Kind.check)) (Src 1099741266142 xval)) (Src 1099745460450 xtyp)) (Src 1099749654763 (Book.Nat.zero))))))))))) (Src 1099761189159 (Lam "term" λxterm (Src 1099770626343 (App (Src 1099771674891 (Book.Kind.API.check.done)) (Src 1099792646438 (App (App (Src 1099793694999 (Book.Kind.infer)) (Src 1099805229340 xterm)) (Src 1099810472229 (Book.Nat.zero)))))))))))))))))) (Src 1099529453617 (All "term" (Src 1099539939364 (Book.Kind.Term)) λxterm (Src 1099553570865 (App (Src 1099554619435 (Book.IO)) (Src 1099557765168 (Book.Unit))))))))
Book.Kind.API.check.done = (Ref "Kind.API.check.done" [] (Ann (Src 1099896455672 (Lam "result" λxresult (Src 1099907990008 (Let "P" (Src 1099919524241 (Lam "x" λxx (Src 1099922669969 (App (Src 1099923718539 (Book.IO)) (Src 1099926864272 (Book.Unit)))))) λxP (Src 1099935252984 (Let "some" (Src 1099946787260 (Lam "value" λxvalue (Src 1099955175868 (App (Src 1099956224435 (Book.IO.print.do)) (Src 1099968807355 (Txt "check")))))) λxsome (Src 1099980341752 (Let "none" (Src 1099991876063 (App (Src 1099992924630 (Book.IO.print.do)) (Src 1100005507550 (Txt "error")))) λxnone (Src 1100018090488 (App (App (App (Src 1100019139051 (Ins (Src 1100020187627 xresult))) (Src 1100027527661 xP)) (Src 1100029624818 xsome)) (Src 1100034867703 xnone))))))))))) (Src 1099849269612 (All "result" (Src 1099861852511 (App (Src 1099862901076 (Book.Maybe)) (Src 1099869192542 (Book.Kind.Term)))) λxresult (Src 1099883872620 (App (Src 1099884921190 (Book.IO)) (Src 1099888066923 (Book.Unit))))))))
Book.Kind.Book.String = (Ref "Kind.Book.String" [] (Ann (Src 70368776683589 (App (App (Src 70368777732136 (Book.Kind.hol)) (Src 70368787169327 (Txt "TODO"))) (Src 70368794509380 (App (Src 70368795557945 (Book.List.nil)) (Src 70368804995139 (Book.Kind.Term)))))) (Src 70368764100636 (Book.Kind.Term))))
Book.Kind.Book.String.cons = (Ref "Kind.Book.String.cons" [] (Ann (Src 80264386576458 (App (App (Src 80264387625005 (Book.Kind.hol)) (Src 80264397062196 (Txt "TODO"))) (Src 80264404402249 (App (Src 80264405450814 (Book.List.nil)) (Src 80264414888008 (Book.Kind.Term)))))) (Src 80264373993505 (Book.Kind.Term))))
Book.Kind.Book.String.nil = (Ref "Kind.Book.String.nil" [] (Ann (Src 81363897155657 (App (App (Src 81363898204204 (Book.Kind.hol)) (Src 81363907641395 (Txt "TODO"))) (Src 81363914981448 (App (Src 81363916030013 (Book.List.nil)) (Src 81363925467207 (Book.Kind.Term)))))) (Src 81363884572704 (Book.Kind.Term))))
Book.Kind.Oper = (Ref "Kind.Oper" [] (Ann (Src 21990249333286 (Slf "self" (Src 21990257721377 (Book.Kind.Oper)) λxself (Src 21990271353382 (All "P" (Src 21990278692927 (All "x" (Src 21990286032956 (Book.Kind.Oper)) λxx (Src 21990297567295 (Set)))) λxP (Src 21990302810662 (All "add" (Src 21990312247389 (App (Src 21990313295950 xP) (Src 21990315393116 (Book.Kind.Oper.add)))) λxadd (Src 21990334267942 (All "mul" (Src 21990343704699 (App (Src 21990344753260 xP) (Src 21990346850426 (Book.Kind.Oper.mul)))) λxmul (Src 21990365725222 (All "sub" (Src 21990375162009 (App (Src 21990376210570 xP) (Src 21990378307736 (Book.Kind.Oper.sub)))) λxsub (Src 21990397182502 (All "div" (Src 21990406619319 (App (Src 21990407667880 xP) (Src 21990409765046 (Book.Kind.Oper.div)))) λxdiv (Src 21990428639782 (All "mod" (Src 21990438076629 (App (Src 21990439125190 xP) (Src 21990441222356 (Book.Kind.Oper.mod)))) λxmod (Src 21990460097062 (All "eq" (Src 21990469533938 (App (Src 21990470582500 xP) (Src 21990472679665 (Book.Kind.Oper.eq)))) λxeq (Src 21990490505766 (All "ne" (Src 21990499942671 (App (Src 21990500991233 xP) (Src 21990503088398 (Book.Kind.Oper.ne)))) λxne (Src 21990520914470 (All "lt" (Src 21990530351404 (App (Src 21990531399966 xP) (Src 21990533497131 (Book.Kind.Oper.lt)))) λxlt (Src 21990551323174 (All "gt" (Src 21990560760137 (App (Src 21990561808699 xP) (Src 21990563905864 (Book.Kind.Oper.gt)))) λxgt (Src 21990581731878 (All "lte" (Src 21990591168871 (App (Src 21990592217432 xP) (Src 21990594314598 (Book.Kind.Oper.lte)))) λxlte (Src 21990613189158 (All "gte" (Src 21990622626181 (App (Src 21990623674742 xP) (Src 21990625771908 (Book.Kind.Oper.gte)))) λxgte (Src 21990644646438 (All "and" (Src 21990654083491 (App (Src 21990655132052 xP) (Src 21990657229218 (Book.Kind.Oper.and)))) λxand (Src 21990676103718 (All "or" (Src 21990685540800 (App (Src 21990686589362 xP) (Src 21990688686527 (Book.Kind.Oper.or)))) λxor (Src 21990706512422 (All "xor" (Src 21990715949534 (App (Src 21990716998095 xP) (Src 21990719095261 (Book.Kind.Oper.xor)))) λxxor (Src 21990737969702 (All "lsh" (Src 21990747406844 (App (Src 21990748455405 xP) (Src 21990750552571 (Book.Kind.Oper.lsh)))) λxlsh (Src 21990769426982 (All "rsh" (Src 21990778864154 (App (Src 21990779912715 xP) (Src 21990782009881 (Book.Kind.Oper.rsh)))) λxrsh (Src 21990800884262 (App (Src 21990801932832 xP) (Src 21990804029989 xself))))))))))))))))))))))))))))))))))))))) (Src 21990245138445 (Set))))
Book.Kind.Oper.add = (Ref "Kind.Oper.add" [] (Ann (Src 23089773543555 (Ins (Src 23089774592131 (Lam "P" λxP (Src 23089778786435 (Lam "add" λxadd (Src 23089785077891 (Lam "mul" λxmul (Src 23089791369347 (Lam "sub" λxsub (Src 23089797660803 (Lam "div" λxdiv (Src 23089803952259 (Lam "mod" λxmod (Src 23089810243715 (Lam "eq" λxeq (Src 23089815486595 (Lam "ne" λxne (Src 23089820729475 (Lam "lt" λxlt (Src 23089825972355 (Lam "gt" λxgt (Src 23089831215235 (Lam "lte" λxlte (Src 23089837506691 (Lam "gte" λxgte (Src 23089843798147 (Lam "and" λxand (Src 23089850089603 (Lam "or" λxor (Src 23089855332483 (Lam "xor" λxxor (Src 23089861623939 (Lam "lsh" λxlsh (Src 23089867915395 (Lam "rsh" λxrsh (Src 23089876304003 (Src 23089877352578 xadd)))))))))))))))))))))))))))))))))))))) (Src 23089760960537 (Book.Kind.Oper))))
Book.Kind.Oper.and = (Ref "Kind.Oper.and" [] (Ann (Src 24189285171331 (Ins (Src 24189286219907 (Lam "P" λxP (Src 24189290414211 (Lam "add" λxadd (Src 24189296705667 (Lam "mul" λxmul (Src 24189302997123 (Lam "sub" λxsub (Src 24189309288579 (Lam "div" λxdiv (Src 24189315580035 (Lam "mod" λxmod (Src 24189321871491 (Lam "eq" λxeq (Src 24189327114371 (Lam "ne" λxne (Src 24189332357251 (Lam "lt" λxlt (Src 24189337600131 (Lam "gt" λxgt (Src 24189342843011 (Lam "lte" λxlte (Src 24189349134467 (Lam "gte" λxgte (Src 24189355425923 (Lam "and" λxand (Src 24189361717379 (Lam "or" λxor (Src 24189366960259 (Lam "xor" λxxor (Src 24189373251715 (Lam "lsh" λxlsh (Src 24189379543171 (Lam "rsh" λxrsh (Src 24189387931779 (Src 24189388980354 xand)))))))))))))))))))))))))))))))))))))) (Src 24189272588313 (Book.Kind.Oper))))
Book.Kind.Oper.div = (Ref "Kind.Oper.div" [] (Ann (Src 25288796799107 (Ins (Src 25288797847683 (Lam "P" λxP (Src 25288802041987 (Lam "add" λxadd (Src 25288808333443 (Lam "mul" λxmul (Src 25288814624899 (Lam "sub" λxsub (Src 25288820916355 (Lam "div" λxdiv (Src 25288827207811 (Lam "mod" λxmod (Src 25288833499267 (Lam "eq" λxeq (Src 25288838742147 (Lam "ne" λxne (Src 25288843985027 (Lam "lt" λxlt (Src 25288849227907 (Lam "gt" λxgt (Src 25288854470787 (Lam "lte" λxlte (Src 25288860762243 (Lam "gte" λxgte (Src 25288867053699 (Lam "and" λxand (Src 25288873345155 (Lam "or" λxor (Src 25288878588035 (Lam "xor" λxxor (Src 25288884879491 (Lam "lsh" λxlsh (Src 25288891170947 (Lam "rsh" λxrsh (Src 25288899559555 (Src 25288900608130 xdiv)))))))))))))))))))))))))))))))))))))) (Src 25288784216089 (Book.Kind.Oper))))
Book.Kind.Oper.eq = (Ref "Kind.Oper.eq" [] (Ann (Src 26388307378305 (Ins (Src 26388308426881 (Lam "P" λxP (Src 26388312621185 (Lam "add" λxadd (Src 26388318912641 (Lam "mul" λxmul (Src 26388325204097 (Lam "sub" λxsub (Src 26388331495553 (Lam "div" λxdiv (Src 26388337787009 (Lam "mod" λxmod (Src 26388344078465 (Lam "eq" λxeq (Src 26388349321345 (Lam "ne" λxne (Src 26388354564225 (Lam "lt" λxlt (Src 26388359807105 (Lam "gt" λxgt (Src 26388365049985 (Lam "lte" λxlte (Src 26388371341441 (Lam "gte" λxgte (Src 26388377632897 (Lam "and" λxand (Src 26388383924353 (Lam "or" λxor (Src 26388389167233 (Lam "xor" λxxor (Src 26388395458689 (Lam "lsh" λxlsh (Src 26388401750145 (Lam "rsh" λxrsh (Src 26388410138753 (Src 26388411187328 xeq)))))))))))))))))))))))))))))))))))))) (Src 26388294795288 (Book.Kind.Oper))))
Book.Kind.Oper.gt = (Ref "Kind.Oper.gt" [] (Ann (Src 27487819006081 (Ins (Src 27487820054657 (Lam "P" λxP (Src 27487824248961 (Lam "add" λxadd (Src 27487830540417 (Lam "mul" λxmul (Src 27487836831873 (Lam "sub" λxsub (Src 27487843123329 (Lam "div" λxdiv (Src 27487849414785 (Lam "mod" λxmod (Src 27487855706241 (Lam "eq" λxeq (Src 27487860949121 (Lam "ne" λxne (Src 27487866192001 (Lam "lt" λxlt (Src 27487871434881 (Lam "gt" λxgt (Src 27487876677761 (Lam "lte" λxlte (Src 27487882969217 (Lam "gte" λxgte (Src 27487889260673 (Lam "and" λxand (Src 27487895552129 (Lam "or" λxor (Src 27487900795009 (Lam "xor" λxxor (Src 27487907086465 (Lam "lsh" λxlsh (Src 27487913377921 (Lam "rsh" λxrsh (Src 27487921766529 (Src 27487922815104 xgt)))))))))))))))))))))))))))))))))))))) (Src 27487806423064 (Book.Kind.Oper))))
Book.Kind.Oper.gte = (Ref "Kind.Oper.gte" [] (Ann (Src 28587331682435 (Ins (Src 28587332731011 (Lam "P" λxP (Src 28587336925315 (Lam "add" λxadd (Src 28587343216771 (Lam "mul" λxmul (Src 28587349508227 (Lam "sub" λxsub (Src 28587355799683 (Lam "div" λxdiv (Src 28587362091139 (Lam "mod" λxmod (Src 28587368382595 (Lam "eq" λxeq (Src 28587373625475 (Lam "ne" λxne (Src 28587378868355 (Lam "lt" λxlt (Src 28587384111235 (Lam "gt" λxgt (Src 28587389354115 (Lam "lte" λxlte (Src 28587395645571 (Lam "gte" λxgte (Src 28587401937027 (Lam "and" λxand (Src 28587408228483 (Lam "or" λxor (Src 28587413471363 (Lam "xor" λxxor (Src 28587419762819 (Lam "lsh" λxlsh (Src 28587426054275 (Lam "rsh" λxrsh (Src 28587434442883 (Src 28587435491458 xgte)))))))))))))))))))))))))))))))))))))) (Src 28587319099417 (Book.Kind.Oper))))
Book.Kind.Oper.lsh = (Ref "Kind.Oper.lsh" [] (Ann (Src 29686843310211 (Ins (Src 29686844358787 (Lam "P" λxP (Src 29686848553091 (Lam "add" λxadd (Src 29686854844547 (Lam "mul" λxmul (Src 29686861136003 (Lam "sub" λxsub (Src 29686867427459 (Lam "div" λxdiv (Src 29686873718915 (Lam "mod" λxmod (Src 29686880010371 (Lam "eq" λxeq (Src 29686885253251 (Lam "ne" λxne (Src 29686890496131 (Lam "lt" λxlt (Src 29686895739011 (Lam "gt" λxgt (Src 29686900981891 (Lam "lte" λxlte (Src 29686907273347 (Lam "gte" λxgte (Src 29686913564803 (Lam "and" λxand (Src 29686919856259 (Lam "or" λxor (Src 29686925099139 (Lam "xor" λxxor (Src 29686931390595 (Lam "lsh" λxlsh (Src 29686937682051 (Lam "rsh" λxrsh (Src 29686946070659 (Src 29686947119234 xlsh)))))))))))))))))))))))))))))))))))))) (Src 29686830727193 (Book.Kind.Oper))))
Book.Kind.Oper.lt = (Ref "Kind.Oper.lt" [] (Ann (Src 30786353889409 (Ins (Src 30786354937985 (Lam "P" λxP (Src 30786359132289 (Lam "add" λxadd (Src 30786365423745 (Lam "mul" λxmul (Src 30786371715201 (Lam "sub" λxsub (Src 30786378006657 (Lam "div" λxdiv (Src 30786384298113 (Lam "mod" λxmod (Src 30786390589569 (Lam "eq" λxeq (Src 30786395832449 (Lam "ne" λxne (Src 30786401075329 (Lam "lt" λxlt (Src 30786406318209 (Lam "gt" λxgt (Src 30786411561089 (Lam "lte" λxlte (Src 30786417852545 (Lam "gte" λxgte (Src 30786424144001 (Lam "and" λxand (Src 30786430435457 (Lam "or" λxor (Src 30786435678337 (Lam "xor" λxxor (Src 30786441969793 (Lam "lsh" λxlsh (Src 30786448261249 (Lam "rsh" λxrsh (Src 30786456649857 (Src 30786457698432 xlt)))))))))))))))))))))))))))))))))))))) (Src 30786341306392 (Book.Kind.Oper))))
Book.Kind.Oper.lte = (Ref "Kind.Oper.lte" [] (Ann (Src 31885866565763 (Ins (Src 31885867614339 (Lam "P" λxP (Src 31885871808643 (Lam "add" λxadd (Src 31885878100099 (Lam "mul" λxmul (Src 31885884391555 (Lam "sub" λxsub (Src 31885890683011 (Lam "div" λxdiv (Src 31885896974467 (Lam "mod" λxmod (Src 31885903265923 (Lam "eq" λxeq (Src 31885908508803 (Lam "ne" λxne (Src 31885913751683 (Lam "lt" λxlt (Src 31885918994563 (Lam "gt" λxgt (Src 31885924237443 (Lam "lte" λxlte (Src 31885930528899 (Lam "gte" λxgte (Src 31885936820355 (Lam "and" λxand (Src 31885943111811 (Lam "or" λxor (Src 31885948354691 (Lam "xor" λxxor (Src 31885954646147 (Lam "lsh" λxlsh (Src 31885960937603 (Lam "rsh" λxrsh (Src 31885969326211 (Src 31885970374786 xlte)))))))))))))))))))))))))))))))))))))) (Src 31885853982745 (Book.Kind.Oper))))
Book.Kind.Oper.mod = (Ref "Kind.Oper.mod" [] (Ann (Src 32985378193539 (Ins (Src 32985379242115 (Lam "P" λxP (Src 32985383436419 (Lam "add" λxadd (Src 32985389727875 (Lam "mul" λxmul (Src 32985396019331 (Lam "sub" λxsub (Src 32985402310787 (Lam "div" λxdiv (Src 32985408602243 (Lam "mod" λxmod (Src 32985414893699 (Lam "eq" λxeq (Src 32985420136579 (Lam "ne" λxne (Src 32985425379459 (Lam "lt" λxlt (Src 32985430622339 (Lam "gt" λxgt (Src 32985435865219 (Lam "lte" λxlte (Src 32985442156675 (Lam "gte" λxgte (Src 32985448448131 (Lam "and" λxand (Src 32985454739587 (Lam "or" λxor (Src 32985459982467 (Lam "xor" λxxor (Src 32985466273923 (Lam "lsh" λxlsh (Src 32985472565379 (Lam "rsh" λxrsh (Src 32985480953987 (Src 32985482002562 xmod)))))))))))))))))))))))))))))))))))))) (Src 32985365610521 (Book.Kind.Oper))))
Book.Kind.Oper.mul = (Ref "Kind.Oper.mul" [] (Ann (Src 34084889821315 (Ins (Src 34084890869891 (Lam "P" λxP (Src 34084895064195 (Lam "add" λxadd (Src 34084901355651 (Lam "mul" λxmul (Src 34084907647107 (Lam "sub" λxsub (Src 34084913938563 (Lam "div" λxdiv (Src 34084920230019 (Lam "mod" λxmod (Src 34084926521475 (Lam "eq" λxeq (Src 34084931764355 (Lam "ne" λxne (Src 34084937007235 (Lam "lt" λxlt (Src 34084942250115 (Lam "gt" λxgt (Src 34084947492995 (Lam "lte" λxlte (Src 34084953784451 (Lam "gte" λxgte (Src 34084960075907 (Lam "and" λxand (Src 34084966367363 (Lam "or" λxor (Src 34084971610243 (Lam "xor" λxxor (Src 34084977901699 (Lam "lsh" λxlsh (Src 34084984193155 (Lam "rsh" λxrsh (Src 34084992581763 (Src 34084993630338 xmul)))))))))))))))))))))))))))))))))))))) (Src 34084877238297 (Book.Kind.Oper))))
Book.Kind.Oper.ne = (Ref "Kind.Oper.ne" [] (Ann (Src 35184400400513 (Ins (Src 35184401449089 (Lam "P" λxP (Src 35184405643393 (Lam "add" λxadd (Src 35184411934849 (Lam "mul" λxmul (Src 35184418226305 (Lam "sub" λxsub (Src 35184424517761 (Lam "div" λxdiv (Src 35184430809217 (Lam "mod" λxmod (Src 35184437100673 (Lam "eq" λxeq (Src 35184442343553 (Lam "ne" λxne (Src 35184447586433 (Lam "lt" λxlt (Src 35184452829313 (Lam "gt" λxgt (Src 35184458072193 (Lam "lte" λxlte (Src 35184464363649 (Lam "gte" λxgte (Src 35184470655105 (Lam "and" λxand (Src 35184476946561 (Lam "or" λxor (Src 35184482189441 (Lam "xor" λxxor (Src 35184488480897 (Lam "lsh" λxlsh (Src 35184494772353 (Lam "rsh" λxrsh (Src 35184503160961 (Src 35184504209536 xne)))))))))))))))))))))))))))))))))))))) (Src 35184387817496 (Book.Kind.Oper))))
Book.Kind.Oper.or = (Ref "Kind.Oper.or" [] (Ann (Src 36283912028289 (Ins (Src 36283913076865 (Lam "P" λxP (Src 36283917271169 (Lam "add" λxadd (Src 36283923562625 (Lam "mul" λxmul (Src 36283929854081 (Lam "sub" λxsub (Src 36283936145537 (Lam "div" λxdiv (Src 36283942436993 (Lam "mod" λxmod (Src 36283948728449 (Lam "eq" λxeq (Src 36283953971329 (Lam "ne" λxne (Src 36283959214209 (Lam "lt" λxlt (Src 36283964457089 (Lam "gt" λxgt (Src 36283969699969 (Lam "lte" λxlte (Src 36283975991425 (Lam "gte" λxgte (Src 36283982282881 (Lam "and" λxand (Src 36283988574337 (Lam "or" λxor (Src 36283993817217 (Lam "xor" λxxor (Src 36284000108673 (Lam "lsh" λxlsh (Src 36284006400129 (Lam "rsh" λxrsh (Src 36284014788737 (Src 36284015837312 xor)))))))))))))))))))))))))))))))))))))) (Src 36283899445272 (Book.Kind.Oper))))
Book.Kind.Oper.rsh = (Ref "Kind.Oper.rsh" [] (Ann (Src 37383424704643 (Ins (Src 37383425753219 (Lam "P" λxP (Src 37383429947523 (Lam "add" λxadd (Src 37383436238979 (Lam "mul" λxmul (Src 37383442530435 (Lam "sub" λxsub (Src 37383448821891 (Lam "div" λxdiv (Src 37383455113347 (Lam "mod" λxmod (Src 37383461404803 (Lam "eq" λxeq (Src 37383466647683 (Lam "ne" λxne (Src 37383471890563 (Lam "lt" λxlt (Src 37383477133443 (Lam "gt" λxgt (Src 37383482376323 (Lam "lte" λxlte (Src 37383488667779 (Lam "gte" λxgte (Src 37383494959235 (Lam "and" λxand (Src 37383501250691 (Lam "or" λxor (Src 37383506493571 (Lam "xor" λxxor (Src 37383512785027 (Lam "lsh" λxlsh (Src 37383519076483 (Lam "rsh" λxrsh (Src 37383527465091 (Src 37383528513666 xrsh)))))))))))))))))))))))))))))))))))))) (Src 37383412121625 (Book.Kind.Oper))))
Book.Kind.Oper.sub = (Ref "Kind.Oper.sub" [] (Ann (Src 38482936332419 (Ins (Src 38482937380995 (Lam "P" λxP (Src 38482941575299 (Lam "add" λxadd (Src 38482947866755 (Lam "mul" λxmul (Src 38482954158211 (Lam "sub" λxsub (Src 38482960449667 (Lam "div" λxdiv (Src 38482966741123 (Lam "mod" λxmod (Src 38482973032579 (Lam "eq" λxeq (Src 38482978275459 (Lam "ne" λxne (Src 38482983518339 (Lam "lt" λxlt (Src 38482988761219 (Lam "gt" λxgt (Src 38482994004099 (Lam "lte" λxlte (Src 38483000295555 (Lam "gte" λxgte (Src 38483006587011 (Lam "and" λxand (Src 38483012878467 (Lam "or" λxor (Src 38483018121347 (Lam "xor" λxxor (Src 38483024412803 (Lam "lsh" λxlsh (Src 38483030704259 (Lam "rsh" λxrsh (Src 38483039092867 (Src 38483040141442 xsub)))))))))))))))))))))))))))))))))))))) (Src 38482923749401 (Book.Kind.Oper))))
Book.Kind.Oper.xor = (Ref "Kind.Oper.xor" [] (Ann (Src 39582447960195 (Ins (Src 39582449008771 (Lam "P" λxP (Src 39582453203075 (Lam "add" λxadd (Src 39582459494531 (Lam "mul" λxmul (Src 39582465785987 (Lam "sub" λxsub (Src 39582472077443 (Lam "div" λxdiv (Src 39582478368899 (Lam "mod" λxmod (Src 39582484660355 (Lam "eq" λxeq (Src 39582489903235 (Lam "ne" λxne (Src 39582495146115 (Lam "lt" λxlt (Src 39582500388995 (Lam "gt" λxgt (Src 39582505631875 (Lam "lte" λxlte (Src 39582511923331 (Lam "gte" λxgte (Src 39582518214787 (Lam "and" λxand (Src 39582524506243 (Lam "or" λxor (Src 39582529749123 (Lam "xor" λxxor (Src 39582536040579 (Lam "lsh" λxlsh (Src 39582542332035 (Lam "rsh" λxrsh (Src 39582550720643 (Src 39582551769218 xxor)))))))))))))))))))))))))))))))))))))) (Src 39582435377177 (Book.Kind.Oper))))
Book.Kind.Term = (Ref "Kind.Term" [] (Ann (Src 20890737706269 (Slf "self" (Src 20890746093601 (Book.Kind.Term)) λxself (Src 20890759726365 (All "P" (Src 20890767065151 (All "x" (Src 20890774405180 (Book.Kind.Term)) λxx (Src 20890785939519 (Set)))) λxP (Src 20890791183645 (All "all" (Src 20890800619697 (All "nam" (Src 20890810056795 (Book.String)) λxnam (Src 20890818445489 (All "inp" (Src 20890827882607 (Book.Kind.Term)) λxinp (Src 20890839417009 (All "bod" (Src 20890848854165 (All "x" (Src 20890856194186 (Book.Kind.Term)) λxx (Src 20890867728533 (Book.Kind.Term)))) λxbod (Src 20890879262897 (App (Src 20890880311449 xP) (Src 20890882408624 (App (App (App (Src 20890883457187 (Book.Kind.all)) (Src 20890892894375 xnam)) (Src 20890897088683 xinp)) (Src 20890901282991 xbod))))))))))) λxall (Src 20890910721309 (All "lam" (Src 20890920157451 (All "nam" (Src 20890929594573 (Book.String)) λxnam (Src 20890937983243 (All "bod" (Src 20890947420403 (All "x" (Src 20890954760424 (Book.Kind.Term)) λxx (Src 20890966294771 (Book.Kind.Term)))) λxbod (Src 20890977829131 (App (Src 20890978877687 xP) (Src 20890980974858 (App (App (Src 20890982023425 (Book.Kind.lam)) (Src 20890991460613 xnam)) (Src 20890995654921 xbod))))))))) λxlam (Src 20891005093149 (All "app" (Src 20891014529366 (All "fun" (Src 20891023966506 (Book.Kind.Term)) λxfun (Src 20891035500886 (All "arg" (Src 20891044938046 (Book.Kind.Term)) λxarg (Src 20891056472406 (App (Src 20891057520962 xP) (Src 20891059618133 (App (App (Src 20891060666700 (Book.Kind.app)) (Src 20891070103888 xfun)) (Src 20891074298196 xarg))))))))) λxapp (Src 20891083736349 (All "ann" (Src 20891093172641 (All "val" (Src 20891102609781 (Book.Kind.Term)) λxval (Src 20891114144161 (All "typ" (Src 20891123581321 (Book.Kind.Term)) λxtyp (Src 20891135115681 (App (Src 20891136164237 xP) (Src 20891138261408 (App (App (Src 20891139309975 (Book.Kind.ann)) (Src 20891148747163 xval)) (Src 20891152941471 xtyp))))))))) λxann (Src 20891162379549 (All "slf" (Src 20891171815931 (All "nam" (Src 20891181253053 (Book.String)) λxnam (Src 20891189641723 (All "bod" (Src 20891199078883 (All "x" (Src 20891206418904 (Book.Kind.Term)) λxx (Src 20891217953251 (Book.Kind.Term)))) λxbod (Src 20891229487611 (App (Src 20891230536167 xP) (Src 20891232633338 (App (App (Src 20891233681905 (Book.Kind.slf)) (Src 20891243119093 xnam)) (Src 20891247313401 xbod))))))))) λxslf (Src 20891256751389 (All "ins" (Src 20891266187822 (All "val" (Src 20891275624986 (Book.Kind.Term)) λxval (Src 20891287159342 (App (Src 20891288207902 xP) (Src 20891290305069 (App (Src 20891291353640 (Book.Kind.ins)) (Src 20891300790828 xval))))))) λxins (Src 20891310228765 (All "ref" (Src 20891319665270 (All "nam" (Src 20891329102410 (Book.String)) λxnam (Src 20891337491062 (All "val" (Src 20891346928222 (Book.Kind.Term)) λxval (Src 20891358462582 (App (Src 20891359511138 xP) (Src 20891361608309 (App (App (Src 20891362656876 (Book.Kind.ref)) (Src 20891372094064 xnam)) (Src 20891376288372 xval))))))))) λxref (Src 20891385726237 (All "def" (Src 20891395162856 (All "nam" (Src 20891404599954 (Book.String)) λxnam (Src 20891412988648 (All "val" (Src 20891422425766 (Book.Kind.Term)) λxval (Src 20891433960168 (All "bod" (Src 20891443397324 (All "x" (Src 20891450737345 (Book.Kind.Term)) λxx (Src 20891462271692 (Book.Kind.Term)))) λxbod (Src 20891473806056 (App (Src 20891474854608 xP) (Src 20891476951783 (App (App (App (Src 20891478000346 (Book.Kind.def)) (Src 20891487437534 xnam)) (Src 20891491631842 xval)) (Src 20891495826150 xbod))))))))))) λxdef (Src 20891505263901 (All "set" (Src 20891514700545 (App (Src 20891515749111 xP) (Src 20891517846272 (Book.Kind.set)))) λxset (Src 20891531478301 (All "u60" (Src 20891540914970 (App (Src 20891541963536 xP) (Src 20891544060697 (Book.Kind.u60)))) λxu60 (Src 20891557692701 (All "num" (Src 20891567129416 (All "val" (Src 20891576566580 (U60)) λxval (Src 20891582858056 (App (Src 20891583906616 xP) (Src 20891586003783 (App (Src 20891587052354 (Book.Kind.num)) (Src 20891596489542 xval))))))) λxnum (Src 20891605927197 (All "op2" (Src 20891615364011 (All "opr" (Src 20891624801127 (Book.Kind.Oper)) λxopr (Src 20891636335531 (All "fst" (Src 20891645772667 (Book.Kind.Term)) λxfst (Src 20891657307051 (All "snd" (Src 20891666744207 (Book.Kind.Term)) λxsnd (Src 20891678278571 (App (Src 20891679327123 xP) (Src 20891681424298 (App (App (App (Src 20891682472861 (Book.Kind.op2)) (Src 20891691910049 xopr)) (Src 20891696104357 xfst)) (Src 20891700298665 xsnd))))))))))) λxop2 (Src 20891709736221 (All "mat" (Src 20891719173197 (All "nam" (Src 20891728610247 (Book.String)) λxnam (Src 20891736998989 (All "x" (Src 20891744338905 (Book.Kind.Term)) λxx (Src 20891755873357 (All "z" (Src 20891763213291 (Book.Kind.Term)) λxz (Src 20891774747725 (All "s" (Src 20891782087694 (All "x" (Src 20891789427716 (Book.Kind.Term)) λxx (Src 20891799913486 (Book.Kind.Term)))) λxs (Src 20891811447885 (All "p" (Src 20891818787889 (All "x" (Src 20891826127911 (Book.Kind.Term)) λxx (Src 20891836613681 (Book.Kind.Term)))) λxp (Src 20891848148045 (App (Src 20891849196597 xP) (Src 20891851293772 (App (App (App (App (App (Src 20891852342335 (Book.Kind.mat)) (Src 20891861779523 xnam)) (Src 20891865973829 xx)) (Src 20891868070983 xz)) (Src 20891870168137 xs)) (Src 20891872265291 xp))))))))))))))) λxmat (Src 20891879605533 (All "txt" (Src 20891889042560 (All "lit" (Src 20891898479724 (Book.Kind.Text)) λxlit (Src 20891910014080 (App (Src 20891911062640 xP) (Src 20891913159807 (App (Src 20891914208378 (Book.Kind.txt)) (Src 20891923645566 xlit))))))) λxtxt (Src 20891933082909 (All "hol" (Src 20891942520015 (All "nam" (Src 20891951957148 (Book.String)) λxnam (Src 20891960345807 (All "ctx" (Src 20891969782967 (App (Src 20891970831532 (Book.List)) (Src 20891976074422 (Book.Kind.Term)))) λxctx (Src 20891988657359 (App (Src 20891989705915 xP) (Src 20891991803086 (App (App (Src 20891992851653 (Book.Kind.hol)) (Src 20892002288841 xnam)) (Src 20892006483149 xctx))))))))) λxhol (Src 20892015920413 (All "var" (Src 20892025357585 (All "nam" (Src 20892034794731 (Book.String)) λxnam (Src 20892043183377 (All "idx" (Src 20892052620537 (Book.Nat)) λxidx (Src 20892057863441 (App (Src 20892058911997 xP) (Src 20892061009168 (App (App (Src 20892062057735 (Book.Kind.var)) (Src 20892071494923 xnam)) (Src 20892075689231 xidx))))))))) λxvar (Src 20892085126429 (App (Src 20892086174999 xP) (Src 20892088272156 xself))))))))))))))))))))))))))))))))))))))) (Src 20890733510669 (Set))))
Book.Kind.Text = (Ref "Kind.Text" [] (Ann (Src 40681947004950 (Book.String)) (Src 40681942810637 (Set))))
Book.Kind.all = (Ref "Kind.all" [] (Ann (Src 41781550907636 (Lam "nam" λxnam (Src 41781557199092 (Lam "inp" λxinp (Src 41781563490548 (Lam "bod" λxbod (Src 41781571879156 (Ins (Src 41781572927732 (Lam "P" λxP (Src 41781577122036 (Lam "all" λxall (Src 41781583413492 (Lam "lam" λxlam (Src 41781589704948 (Lam "app" λxapp (Src 41781595996404 (Lam "ann" λxann (Src 41781602287860 (Lam "slf" λxslf (Src 41781608579316 (Lam "ins" λxins (Src 41781614870772 (Lam "ref" λxref (Src 41781621162228 (Lam "def" λxdef (Src 41781627453684 (Lam "set" λxset (Src 41781633745140 (Lam "u60" λxu60 (Src 41781640036596 (Lam "num" λxnum (Src 41781646328052 (Lam "op2" λxop2 (Src 41781652619508 (Lam "mat" λxmat (Src 41781658910964 (Lam "txt" λxtxt (Src 41781665202420 (Lam "hol" λxhol (Src 41781671493876 (Lam "var" λxvar (Src 41781679882484 (App (App (App (Src 41781680931047 xall) (Src 41781685125355 xnam)) (Src 41781689319663 xinp)) (Src 41781693513971 xbod))))))))))))))))))))))))))))))))))))))))))))) (Src 41781453389925 (All "nam" (Src 41781462827034 (Book.String)) λxnam (Src 41781473312869 (All "inp" (Src 41781482750000 (Book.Kind.Term)) λxinp (Src 41781496381541 (All "bod" (Src 41781505818712 (All "x" (Src 41781513158733 (Book.Kind.Term)) λxx (Src 41781524693080 (Book.Kind.Term)))) λxbod (Src 41781538324581 (Book.Kind.Term))))))))))
Book.Kind.ann = (Ref "Kind.ann" [] (Ann (Src 42881023738053 (Lam "val" λxval (Src 42881030029509 (Lam "typ" λxtyp (Src 42881038418117 (Ins (Src 42881039466693 (Lam "P" λxP (Src 42881043660997 (Lam "all" λxall (Src 42881049952453 (Lam "lam" λxlam (Src 42881056243909 (Lam "app" λxapp (Src 42881062535365 (Lam "ann" λxann (Src 42881068826821 (Lam "slf" λxslf (Src 42881075118277 (Lam "ins" λxins (Src 42881081409733 (Lam "ref" λxref (Src 42881087701189 (Lam "def" λxdef (Src 42881093992645 (Lam "set" λxset (Src 42881100284101 (Lam "u60" λxu60 (Src 42881106575557 (Lam "num" λxnum (Src 42881112867013 (Lam "op2" λxop2 (Src 42881119158469 (Lam "mat" λxmat (Src 42881125449925 (Lam "txt" λxtxt (Src 42881131741381 (Lam "hol" λxhol (Src 42881138032837 (Lam "var" λxvar (Src 42881146421445 (App (App (Src 42881147470012 xann) (Src 42881151664320 xval)) (Src 42881155858628 xtyp))))))))))))))))))))))))))))))))))))))))))) (Src 42880965017664 (All "val" (Src 42880974454813 (Book.Kind.Term)) λxval (Src 42880988086336 (All "typ" (Src 42880997523507 (Book.Kind.Term)) λxtyp (Src 42881011155008 (Book.Kind.Term))))))))
Book.Kind.app = (Ref "Kind.app" [] (Ann (Src 43980535365829 (Lam "fun" λxfun (Src 43980541657285 (Lam "arg" λxarg (Src 43980550045893 (Ins (Src 43980551094469 (Lam "P" λxP (Src 43980555288773 (Lam "all" λxall (Src 43980561580229 (Lam "lam" λxlam (Src 43980567871685 (Lam "app" λxapp (Src 43980574163141 (Lam "ann" λxann (Src 43980580454597 (Lam "slf" λxslf (Src 43980586746053 (Lam "ins" λxins (Src 43980593037509 (Lam "ref" λxref (Src 43980599328965 (Lam "def" λxdef (Src 43980605620421 (Lam "set" λxset (Src 43980611911877 (Lam "u60" λxu60 (Src 43980618203333 (Lam "num" λxnum (Src 43980624494789 (Lam "op2" λxop2 (Src 43980630786245 (Lam "mat" λxmat (Src 43980637077701 (Lam "txt" λxtxt (Src 43980643369157 (Lam "hol" λxhol (Src 43980649660613 (Lam "var" λxvar (Src 43980658049221 (App (App (Src 43980659097788 xapp) (Src 43980663292096 xfun)) (Src 43980667486404 xarg))))))))))))))))))))))))))))))))))))))))))) (Src 43980476645440 (All "fun" (Src 43980486082589 (Book.Kind.Term)) λxfun (Src 43980499714112 (All "arg" (Src 43980509151283 (Book.Kind.Term)) λxarg (Src 43980522782784 (Book.Kind.Term))))))))
Book.Kind.check = (Ref "Kind.check" [] (Ann (Src 62672262400499 (Lam "term" λxterm (Src 62672269740531 (Lam "type" λxtype (Src 62672277080563 (Lam "dep" λxdep (Src 62672285469171 (Let "bind" (Src 62672297001120 (App (App (Src 62672298049675 (Book.Maybe.bind)) (Src 62672309584021 (Book.Kind.Term))) (Src 62672320069791 (Book.Kind.Term)))) λxbind (Src 62672333703667 (Let "pure" (Src 62672345235652 (App (Src 62672346284217 (Book.Maybe.some)) (Src 62672357818563 (Book.Kind.Term)))) λxpure (Src 62672372500979 (Let "none" (Src 62672384033001 (App (Src 62672385081566 (Book.Maybe.none)) (Src 62672396615912 (Book.Kind.Term)))) λxnone (Src 62672410249715 (Let "P" (Src 62672418636071 (Lam "x" λxx (Src 62672421781799 (All "type" (Src 62672431218953 (Book.Kind.Term)) λxtype (Src 62672441704743 (All "dep" (Src 62672450093333 (Book.Nat)) λxdep (Src 62672454287655 (App (Src 62672455336220 (Book.Maybe)) (Src 62672461627686 (Book.Kind.Term)))))))))) λxP (Src 62672475261427 (Let "all" (Src 62672485745058 (Lam "term.nam" λxterm.nam (Src 62672497279394 (Lam "term.inp" λxterm.inp (Src 62672508813730 (Lam "term.bod" λxterm.bod (Src 62672520348066 (Lam "type" λxtype (Src 62672527688098 (Lam "dep" λxdep (Src 62672538173858 (App (App (App (Src 62672539222386 (Book.Kind.verify)) (Src 62672551805336 (App (App (App (Src 62672552853884 (Book.Kind.all)) (Src 62672562291077 xterm.nam)) (Src 62672571728270 xterm.inp)) (Src 62672581165463 xterm.bod)))) (Src 62672591651229 xtype)) (Src 62672596894113 xdep))))))))))))) λxall (Src 62672604236275 (Let "lam" (Src 62672614720415 (Lam "term.nam" λxterm.nam (Src 62672626254751 (Lam "term.bod" λxterm.bod (Src 62672637789087 (Lam "type" λxtype (Src 62672645129119 (Lam "dep" λxdep (Src 62672655614879 (App (App (Src 62672656663435 (App (App (App (App (Src 62672657711587 (Book.Kind.if.all)) (Src 62672670294528 (App (App (Src 62672671343088 (Book.Kind.reduce)) (Src 62672683926010 (Book.Bool.true))) (Src 62672694411775 xtype)))) (Src 62672706994765 (All "dep" (Src 62672716431891 (Book.Nat)) λxdep (Src 62672720626253 (All "term.bod" (Src 62672735306299 (All "x" (Src 62672741597745 (Book.Kind.Term)) λxx (Src 62672752083515 (Book.Kind.Term)))) λxterm.bod (Src 62672762569293 (App (Src 62672763617858 (Book.Maybe)) (Src 62672769909324 (Book.Kind.Term))))))))) (Src 62672787735350 (Lam "type.nam" λxtype.nam (Src 62672799269686 (Lam "type.inp" λxtype.inp (Src 62672810804022 (Lam "type.bod" λxtype.bod (Src 62672822338358 (Lam "dep" λxdep (Src 62672828629814 (Lam "term.bod" λxterm.bod (Src 62672848552758 (Let "ann" (Src 62672860086980 (App (App (Src 62672861135522 (Book.Kind.ann)) (Src 62672870572730 (App (App (Src 62672871621292 (Book.Kind.var)) (Src 62672881058485 xterm.nam)) (Src 62672890495673 xdep)))) (Src 62672895738563 xtype.inp))) λxann (Src 62672914613046 (Let "term" (Src 62672926147302 (App (Src 62672927195873 xterm.bod) (Src 62672936633061 xann))) λxterm (Src 62672950264630 (Let "type" (Src 62672961798920 (App (Src 62672962847491 xtype.bod) (Src 62672972284679 xann))) λxtype (Src 62672985916214 (App (App (App (Src 62672986964764 (Book.Kind.check)) (Src 62672998499105 xterm)) (Src 62673003741990 xtype)) (Src 62673008984885 (App (Src 62673010033456 (Book.Nat.succ)) (Src 62673019470644 xdep)))))))))))))))))))))) (Src 62673032053642 (Lam "type" λxtype (Src 62673039393674 (Lam "dep" λxdep (Src 62673045685130 (Lam "term.bod" λxterm.bod (Src 62673065608074 (App (App (Src 62673066656616 (Book.Kind.infer)) (Src 62673078190981 (App (App (Src 62673079239538 (Book.Kind.lam)) (Src 62673088676731 xterm.nam)) (Src 62673098113924 xterm.bod)))) (Src 62673108599689 xdep))))))))))) (Src 62673121182613 xdep)) (Src 62673125376926 xterm.bod))))))))))) λxlam (Src 62673137961459 (Let "app" (Src 62673148445702 (Lam "term.fun" λxterm.fun (Src 62673159980038 (Lam "term.arg" λxterm.arg (Src 62673171514374 (Lam "type" λxtype (Src 62673178854406 (Lam "dep" λxdep (Src 62673189340166 (App (App (App (Src 62673190388703 (Book.Kind.verify)) (Src 62673202971644 (App (App (Src 62673204020201 (Book.Kind.app)) (Src 62673213457394 xterm.fun)) (Src 62673222894587 xterm.arg)))) (Src 62673233380353 xtype)) (Src 62673238623237 xdep))))))))))) λxapp (Src 62673245964787 (Let "ann" (Src 62673256449113 (Lam "val" λxval (Src 62673262740569 (Lam "typ" λxtyp (Src 62673269032025 (Lam "type" λxtype (Src 62673276372057 (Lam "dep" λxdep (Src 62673286857817 (App (App (App (Src 62673287906364 (Book.Kind.verify)) (Src 62673300489295 (App (App (Src 62673301537862 (Book.Kind.ann)) (Src 62673310975050 xval)) (Src 62673315169358 xtyp)))) (Src 62673320412244 xtype)) (Src 62673325655128 xdep))))))))))) λxann (Src 62673332996595 (Let "slf" (Src 62673343481024 (Lam "term.nam" λxterm.nam (Src 62673355015360 (Lam "term.bod" λxterm.bod (Src 62673366549696 (Lam "type" λxtype (Src 62673373889728 (Lam "dep" λxdep (Src 62673384375488 (App (App (App (Src 62673385424025 (Book.Kind.verify)) (Src 62673398006966 (App (App (Src 62673399055523 (Book.Kind.slf)) (Src 62673408492716 xterm.nam)) (Src 62673417929909 xterm.bod)))) (Src 62673428415675 xtype)) (Src 62673433658559 xdep))))))))))) λxslf (Src 62673440999923 (Let "ins" (Src 62673451484673 (Lam "term.val" λxterm.val (Src 62673463019009 (Lam "type" λxtype (Src 62673470359041 (Lam "dep" λxdep (Src 62673480844801 (App (Src 62673481893361 (App (App (App (App (Src 62673482941686 (Book.Kind.if.slf)) (Src 62673495524627 (App (App (Src 62673496573187 (Book.Kind.reduce)) (Src 62673509156109 (Book.Bool.true))) (Src 62673519641874 xtype)))) (Src 62673532224835 (All "term.val" (Src 62673546904881 (Book.Kind.Term)) λxterm.val (Src 62673557390659 (App (Src 62673558439224 (Book.Maybe)) (Src 62673564730690 (Book.Kind.Term))))))) (Src 62673582556587 (Lam "type.nam" λxtype.nam (Src 62673594090923 (Lam "type.bod" λxtype.bod (Src 62673605625259 (Lam "term.val" λxterm.val (Src 62673625548203 (App (App (App (Src 62673626596734 (Book.Kind.check)) (Src 62673638131079 xterm.val)) (Src 62673647568294 (App (Src 62673648616849 xtype.bod) (Src 62673658054053 (App (Src 62673659102619 (Book.Kind.ins)) (Src 62673668539812 xterm.val)))))) (Src 62673680074154 xdep)))))))))) (Src 62673691608560 (Lam "type" λxtype (Src 62673698948592 (Lam "term.val" λxterm.val (Src 62673718871536 (App (App (Src 62673719920087 (Book.Kind.infer)) (Src 62673731454443 (App (Src 62673732503009 (Book.Kind.ins)) (Src 62673741940202 xterm.val)))) (Src 62673752425967 xdep))))))))) (Src 62673765008896 xterm.val))))))))) λxins (Src 62673777592819 (Let "ref" (Src 62673788077651 (Lam "term.nam" λxterm.nam (Src 62673799611987 (Lam "term.val" λxterm.val (Src 62673811146323 (Lam "type" λxtype (Src 62673818486355 (Lam "dep" λxdep (Src 62673828972115 (App (App (App (Src 62673830020672 (Book.Kind.check)) (Src 62673841555017 xterm.val)) (Src 62673850992206 xtype)) (Src 62673856235090 xdep))))))))))) λxref (Src 62673863576051 (Let "def" (Src 62673874060998 (Lam "term.nam" λxterm.nam (Src 62673885595334 (Lam "term.val" λxterm.val (Src 62673897129670 (Lam "term.bod" λxterm.bod (Src 62673908664006 (Lam "type" λxtype (Src 62673916004038 (Lam "dep" λxdep (Src 62673926489798 (App (App (App (Src 62673927538333 (Book.Kind.check)) (Src 62673939072689 (App (Src 62673940121255 xterm.bod) (Src 62673949558448 xterm.val)))) (Src 62673960044214 xtype)) (Src 62673965287109 (App (Src 62673966335680 (Book.Nat.succ)) (Src 62673975772868 xdep))))))))))))))) λxdef (Src 62673984162291 (Let "set" (Src 62673994647299 (Lam "type" λxtype (Src 62674001987331 (Lam "dep" λxdep (Src 62674012473091 (App (App (App (Src 62674013521648 (Book.Kind.verify)) (Src 62674026104569 (Book.Kind.set))) (Src 62674035541758 xtype)) (Src 62674040784642 xdep))))))) λxset (Src 62674048125427 (Let "u60" (Src 62674058610496 (Lam "type" λxtype (Src 62674065950528 (Lam "dep" λxdep (Src 62674076436288 (App (App (App (Src 62674077484845 (Book.Kind.verify)) (Src 62674090067766 (Book.Kind.u60))) (Src 62674099504955 xtype)) (Src 62674104747839 xdep))))))) λxu60 (Src 62674112088563 (Let "num" (Src 62674122573715 (Lam "term.num" λxterm.num (Src 62674134108051 (Lam "type" λxtype (Src 62674141448083 (Lam "dep" λxdep (Src 62674151933843 (App (App (App (Src 62674152982389 (Book.Kind.verify)) (Src 62674165565321 (App (Src 62674166613887 (Book.Kind.num)) (Src 62674176051080 xterm.num)))) (Src 62674186536846 xtype)) (Src 62674191779730 xdep))))))))) λxnum (Src 62674199120371 (Let "op2" (Src 62674209605646 (Lam "term.opr" λxterm.opr (Src 62674221139982 (Lam "term.fst" λxterm.fst (Src 62674232674318 (Lam "term.snd" λxterm.snd (Src 62674244208654 (Lam "type" λxtype (Src 62674251548686 (Lam "dep" λxdep (Src 62674262034446 (App (App (App (Src 62674263082974 (Book.Kind.verify)) (Src 62674275665924 (App (App (App (Src 62674276714472 (Book.Kind.op2)) (Src 62674286151665 xterm.opr)) (Src 62674295588858 xterm.fst)) (Src 62674305026051 xterm.snd)))) (Src 62674315511817 xtype)) (Src 62674320754701 xdep))))))))))))) λxop2 (Src 62674328095219 (Let "mat" (Src 62674338580641 (Lam "term.nam" λxterm.nam (Src 62674350114977 (Lam "term.x" λxterm.x (Src 62674359552161 (Lam "term.z" λxterm.z (Src 62674368989345 (Lam "term.s" λxterm.s (Src 62674378426529 (Lam "term.p" λxterm.p (Src 62674387863713 (Lam "type" λxtype (Src 62674395203745 (Lam "dep" λxdep (Src 62674405689505 (App (App (App (Src 62674406738023 (Book.Kind.verify)) (Src 62674419320983 (App (App (App (App (App (Src 62674420369521 (Book.Kind.mat)) (Src 62674429806714 xterm.nam)) (Src 62674439243905 xterm.x)) (Src 62674446583944 xterm.z)) (Src 62674453923983 xterm.s)) (Src 62674461264022 xterm.p)))) (Src 62674469652636 xtype)) (Src 62674474895520 xdep))))))))))))))))) λxmat (Src 62674482235891 (Let "txt" (Src 62674492721396 (Lam "term.txt" λxterm.txt (Src 62674504255732 (Lam "type" λxtype (Src 62674511595764 (Lam "dep" λxdep (Src 62674522081524 (App (App (App (Src 62674523130070 (Book.Kind.verify)) (Src 62674535713002 (App (Src 62674536761568 (Book.Kind.txt)) (Src 62674546198761 xterm.txt)))) (Src 62674556684527 xtype)) (Src 62674561927411 xdep))))))))) λxtxt (Src 62674569267699 (Let "hol" (Src 62674579753271 (Lam "term.nam" λxterm.nam (Src 62674591287607 (Lam "term.ctx" λxterm.ctx (Src 62674602821943 (Lam "type" λxtype (Src 62674610161975 (Lam "dep" λxdep (Src 62674620647735 (App (Src 62674621696301 xpure) (Src 62674626939190 (Book.Kind.set)))))))))))) λxhol (Src 62674639522291 (Let "var" (Src 62674650007966 (Lam "term.nam" λxterm.nam (Src 62674661542302 (Lam "term.idx" λxterm.idx (Src 62674673076638 (Lam "type" λxtype (Src 62674680416670 (Lam "dep" λxdep (Src 62674690902430 (App (App (App (Src 62674691950967 (Book.Kind.verify)) (Src 62674704533908 (App (App (Src 62674705582465 (Book.Kind.var)) (Src 62674715019658 xterm.nam)) (Src 62674724456851 xterm.idx)))) (Src 62674734942617 xtype)) (Src 62674740185501 xdep))))))))))) λxvar (Src 62674747525619 (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (Src 62674748574119 (Ins (Src 62674749622695 xterm))) (Src 62674754865577 xP)) (Src 62674756962733 xall)) (Src 62674761157041 xlam)) (Src 62674765351349 xapp)) (Src 62674769545657 xann)) (Src 62674773739965 xslf)) (Src 62674777934273 xins)) (Src 62674782128581 xref)) (Src 62674786322889 xdef)) (Src 62674790517197 xset)) (Src 62674794711505 xu60)) (Src 62674798905813 xnum)) (Src 62674803100121 xop2)) (Src 62674807294429 xmat)) (Src 62674811488737 xtxt)) (Src 62674815683045 xhol)) (Src 62674819877353 xvar)) (Src 62674824071662 xtype)) (Src 62674829314546 xdep))))))))))))))))))))))))))))))))))))))))))))))))) (Src 62672176414812 (All "term" (Src 62672186900512 (Book.Kind.Term)) λxterm (Src 62672200532060 (All "type" (Src 62672211017783 (Book.Kind.Term)) λxtype (Src 62672224649308 (All "dep" (Src 62672234086471 (Book.Nat)) λxdep (Src 62672241426524 (App (Src 62672242475089 (Book.Maybe)) (Src 62672248766555 (Book.Kind.Term))))))))))))
Book.Kind.comparer = (Ref "Kind.comparer" [] (Ann (Src 94558157279151 (Lam "rec" λxrec (Src 94558163570607 (Lam "a" λxa (Src 94558167764911 (Lam "b" λxb (Src 94558171959215 (Lam "dep" λxdep (Src 94558180347823 (Let "VAR" (Src 94558190829758 (Book.Kind.var)) λxVAR (Src 94558202367919 (Let "SUC" (Src 94558212849875 (Book.Nat.succ)) λxSUC (Src 94558253748143 (Let "a" (Src 94558262132999 (App (Src 94558263181572 (Book.Kind.skip)) (Src 94558273667334 xa))) λxa (Src 94558278913967 (Let "b" (Src 94558287298847 (App (Src 94558288347420 (Book.Kind.skip)) (Src 94558298833182 xb))) λxb (Src 94558330294191 (Let "R" (Src 94558338679141 (All "b" (Src 94558344970578 (Book.Kind.Term)) λxb (Src 94558356504933 (All "dep" (Src 94558364893535 (Book.Nat)) λxdep (Src 94558370136421 (Book.Bool)))))) λxR (Src 94558377480111 (Let "Y" (Src 94558385865107 (Lam "a.nam" λxa.nam (Src 94558394253715 (Lam "a.ctx" λxa.ctx (Src 94558402642323 (Lam "b" λxb (Src 94558406836627 (Lam "dep" λxdep (Src 94558413128083 (Book.Bool.true)))))))))) λxY (Src 94558425714607 (Let "N" (Src 94558434103185 (Lam "a" λxa (Src 94558438297489 (Lam "b" λxb (Src 94558442491793 (Lam "dep" λxdep (Src 94558481289105 (Let "R" (Src 94558489674229 (All "dep" (Src 94558498062814 (Book.Nat)) λxdep (Src 94558503305717 (All "a" (Src 94558509597167 (Book.Kind.Term)) λxa (Src 94558521131509 (Book.Bool)))))) λxR (Src 94558530572177 (Let "Y" (Src 94558538957349 (Lam "b.nam" λxb.nam (Src 94558547345957 (Lam "b.ctx" λxb.ctx (Src 94558555734565 (Lam "dep" λxdep (Src 94558562026021 (Lam "a" λxa (Src 94558566220325 (Book.Bool.true)))))))))) λxY (Src 94558580903825 (Let "N" (Src 94558589292401 (Lam "b" λxb (Src 94558593486705 (Lam "dep" λxdep (Src 94558599778161 (Lam "a" λxa (Src 94558645915505 (Let "P" (Src 94558656397978 (Lam "x" λxx (Src 94558660592282 (All "b" (Src 94558667932294 (Book.Kind.Term)) λxb (Src 94558679466650 (All "dep" (Src 94558688903828 (Book.Nat)) λxdep (Src 94558694146714 (Book.Bool)))))))) λxP (Src 94558705684337 (Let "all" (Src 94558716167110 (Lam "a.nam" λxa.nam (Src 94558724555718 (Lam "a.inp" λxa.inp (Src 94558732944326 (Lam "a.bod" λxa.bod (Src 94558741332934 (Lam "b" λxb (Src 94558745527238 (Lam "dep" λxdep (Src 94558760207302 (Let "P" (Src 94558768595694 (All "dep" (Src 94558776984296 (Book.Nat)) λxdep (Src 94558782227182 (Book.Bool)))) λxP (Src 94558795858886 (Let "Y" (Src 94558804247421 (Lam "b.nam" λxb.nam (Src 94558812636029 (Lam "b.inp" λxb.inp (Src 94558821024637 (Lam "b.bod" λxb.bod (Src 94558829413245 (Lam "dep" λxdep (Src 94558835704701 (App (App (Src 94558836753190 (Book.Bool.and)) (Src 94558846190396 (App (App (App (Src 94558847238955 xrec) (Src 94558851433265 xa.inp)) (Src 94558857724727 xb.inp)) (Src 94558864016187 xdep)))) (Src 94558869259132 (App (App (App (Src 94558870307649 xrec) (Src 94558874501977 (App (Src 94558875550536 xa.bod) (Src 94558881842008 (App (App (Src 94558882890573 xVAR) (Src 94558887084883 xa.nam)) (Src 94558893376343 xdep)))))) (Src 94558899667825 (App (Src 94558900716384 xb.bod) (Src 94558907007856 (App (App (Src 94558908056421 xVAR) (Src 94558912250731 xb.nam)) (Src 94558918542191 xdep)))))) (Src 94558924833659 (App (Src 94558925882230 xSUC) (Src 94558930076538 xdep))))))))))))))) λxY (Src 94558945805254 (Let "N" (Src 94558954193828 (Lam "val" λxval (Src 94558960485284 (Lam "dep" λxdep (Src 94558966776740 (Book.Bool.false)))))) λxN (Src 94558986699718 (App (App (App (App (App (Src 94558987748281 (Book.Kind.if.all)) (Src 94559000331195 xb)) (Src 94559002428349 xP)) (Src 94559004525503 xY)) (Src 94559006622657 xN)) (Src 94559008719813 xdep))))))))))))))))))) λxall (Src 94559020257137 (Let "lam" (Src 94559030740161 (Lam "a.nam" λxa.nam (Src 94559039128769 (Lam "a.bod" λxa.bod (Src 94559047517377 (Lam "b" λxb (Src 94559051711681 (Lam "dep" λxdep (Src 94559066391745 (Let "P" (Src 94559074780178 (All "dep" (Src 94559083168780 (Book.Nat)) λxdep (Src 94559088411666 (Book.Bool)))) λxP (Src 94559102043329 (Let "Y" (Src 94559110431864 (Lam "b.nam" λxb.nam (Src 94559118820472 (Lam "b.bod" λxb.bod (Src 94559127209080 (Lam "dep" λxdep (Src 94559133500536 (App (App (App (Src 94559134549053 xrec) (Src 94559138743381 (App (Src 94559139791940 xa.bod) (Src 94559146083412 (App (App (Src 94559147131977 xVAR) (Src 94559151326287 xa.nam)) (Src 94559157617747 xdep)))))) (Src 94559163909229 (App (Src 94559164957788 xb.bod) (Src 94559171249260 (App (App (Src 94559172297825 xVAR) (Src 94559176492135 xb.nam)) (Src 94559182783595 xdep)))))) (Src 94559189075063 (App (Src 94559190123634 xSUC) (Src 94559194317942 xdep))))))))))) λxY (Src 94559208998081 (Let "N" (Src 94559217386655 (Lam "val" λxval (Src 94559223678111 (Lam "dep" λxdep (Src 94559229969567 (Book.Bool.false)))))) λxN (Src 94559249892545 (App (App (App (App (App (Src 94559250941108 (Book.Kind.if.lam)) (Src 94559263524022 xb)) (Src 94559265621176 xP)) (Src 94559267718330 xY)) (Src 94559269815484 xN)) (Src 94559271912640 xdep))))))))))))))))) λxlam (Src 94559283449713 (Let "app" (Src 94559293932979 (Lam "a.fun" λxa.fun (Src 94559302321587 (Lam "a.arg" λxa.arg (Src 94559310710195 (Lam "b" λxb (Src 94559314904499 (Lam "dep" λxdep (Src 94559329584563 (Let "P" (Src 94559337973005 (All "dep" (Src 94559346361607 (Book.Nat)) λxdep (Src 94559351604493 (Book.Bool)))) λxP (Src 94559365236147 (Let "Y" (Src 94559373624682 (Lam "b.fun" λxb.fun (Src 94559382013290 (Lam "b.arg" λxb.arg (Src 94559390401898 (Lam "dep" λxdep (Src 94559396693354 (App (App (Src 94559397741885 (Book.Bool.and)) (Src 94559407179091 (App (App (App (Src 94559408227650 xrec) (Src 94559412421960 xa.fun)) (Src 94559418713422 xb.fun)) (Src 94559425004882 xdep)))) (Src 94559430247785 (App (App (App (Src 94559431296344 xrec) (Src 94559435490654 xa.arg)) (Src 94559441782116 xb.arg)) (Src 94559448073576 xdep))))))))))) λxY (Src 94559462753715 (Let "N" (Src 94559471142289 (Lam "val" λxval (Src 94559477433745 (Lam "dep" λxdep (Src 94559483725201 (Book.Bool.false)))))) λxN (Src 94559503648179 (App (App (App (App (App (Src 94559504696742 (Book.Kind.if.app)) (Src 94559517279656 xb)) (Src 94559519376810 xP)) (Src 94559521473964 xY)) (Src 94559523571118 xN)) (Src 94559525668274 xdep))))))))))))))))) λxapp (Src 94559537205105 (Let "ann" (Src 94559547688432 (Lam "a.val" λxa.val (Src 94559556077040 (Lam "a.typ" λxa.typ (Src 94559564465648 (Lam "b" λxb (Src 94559568659952 (Lam "dep" λxdep (Src 94559583340016 (Book.Bool.false)))))))))) λxann (Src 94559616896881 (Let "slf" (Src 94559627380474 (Lam "a.nam" λxa.nam (Src 94559635769082 (Lam "a.bod" λxa.bod (Src 94559644157690 (Lam "b" λxb (Src 94559648351994 (Lam "dep" λxdep (Src 94559663032058 (Let "P" (Src 94559671420491 (All "dep" (Src 94559679809093 (Book.Nat)) λxdep (Src 94559685051979 (Book.Bool)))) λxP (Src 94559698683642 (Let "Y" (Src 94559707072177 (Lam "b.nam" λxb.nam (Src 94559715460785 (Lam "b.bod" λxb.bod (Src 94559723849393 (Lam "dep" λxdep (Src 94559730140849 (App (App (App (Src 94559731189366 xrec) (Src 94559735383694 (App (Src 94559736432253 xa.bod) (Src 94559742723725 (App (App (Src 94559743772290 xVAR) (Src 94559747966600 xa.nam)) (Src 94559754258060 xdep)))))) (Src 94559760549542 (App (Src 94559761598101 xb.bod) (Src 94559767889573 (App (App (Src 94559768938138 xVAR) (Src 94559773132448 xb.nam)) (Src 94559779423908 xdep)))))) (Src 94559785715376 (App (Src 94559786763947 xSUC) (Src 94559790958255 xdep))))))))))) λxY (Src 94559805638394 (Let "N" (Src 94559814026968 (Lam "val" λxval (Src 94559820318424 (Lam "dep" λxdep (Src 94559826609880 (Book.Bool.false)))))) λxN (Src 94559846532858 (App (App (App (App (App (Src 94559847581421 (Book.Kind.if.slf)) (Src 94559860164335 xb)) (Src 94559862261489 xP)) (Src 94559864358643 xY)) (Src 94559866455797 xN)) (Src 94559868552953 xdep))))))))))))))))) λxslf (Src 94559880089457 (Let "ins" (Src 94559890573103 (Lam "a.val" λxa.val (Src 94559898961711 (Lam "b" λxb (Src 94559903156015 (Lam "dep" λxdep (Src 94559917836079 (Book.Bool.false)))))))) λxins (Src 94559951392625 (Let "ref" (Src 94559961876500 (Lam "a.nam" λxa.nam (Src 94559970265108 (Lam "a.val" λxa.val (Src 94559978653716 (Lam "b" λxb (Src 94559982848020 (Lam "dep" λxdep (Src 94559997528084 (Let "P" (Src 94560005916554 (All "dep" (Src 94560014305156 (Book.Nat)) λxdep (Src 94560019548042 (Book.Bool)))) λxP (Src 94560033179668 (Let "Y" (Src 94560041568203 (Lam "b.nam" λxb.nam (Src 94560049956811 (Lam "b.val" λxb.val (Src 94560058345419 (Lam "dep" λxdep (Src 94560064636875 (App (App (Src 94560065685438 (Book.String.equal)) (Src 94560079316932 xa.nam)) (Src 94560085608394 xb.nam))))))))) λxY (Src 94560101337108 (Let "N" (Src 94560109725682 (Lam "val" λxval (Src 94560116017138 (Lam "dep" λxdep (Src 94560122308594 (Book.Bool.false)))))) λxN (Src 94560142231572 (App (App (App (App (App (Src 94560143280135 (Book.Kind.if.ref)) (Src 94560155863049 xb)) (Src 94560157960203 xP)) (Src 94560160057357 xY)) (Src 94560162154511 xN)) (Src 94560164251667 xdep))))))))))))))))) λxref (Src 94560175787889 (Let "def" (Src 94560186271833 (Lam "a.nam" λxa.nam (Src 94560194660441 (Lam "a.val" λxa.val (Src 94560203049049 (Lam "a.bod" λxa.bod (Src 94560211437657 (Lam "b" λxb (Src 94560215631961 (Lam "dep" λxdep (Src 94560230312025 (Book.Bool.false)))))))))))) λxdef (Src 94560263868273 (Let "set" (Src 94560274352397 (Lam "b" λxb (Src 94560278546701 (Lam "dep" λxdep (Src 94560293226765 (Let "P" (Src 94560301615268 (All "dep" (Src 94560310003870 (Book.Nat)) λxdep (Src 94560315246756 (Book.Bool)))) λxP (Src 94560328878349 (Let "Y" (Src 94560337266884 (Lam "dep" λxdep (Src 94560343558340 (Book.Bool.true)))) λxY (Src 94560362432781 (Let "F" (Src 94560370821355 (Lam "val" λxval (Src 94560377112811 (Lam "dep" λxdep (Src 94560383404267 (Book.Bool.false)))))) λxF (Src 94560403327245 (App (App (App (App (App (Src 94560404375808 (Book.Kind.if.set)) (Src 94560416958722 xb)) (Src 94560419055876 xP)) (Src 94560421153030 xY)) (Src 94560423250184 xF)) (Src 94560425347340 xdep))))))))))))) λxset (Src 94560436883313 (Let "u60" (Src 94560447367602 (Lam "b" λxb (Src 94560451561906 (Lam "dep" λxdep (Src 94560466241970 (Let "P" (Src 94560474630473 (All "dep" (Src 94560483019075 (Book.Nat)) λxdep (Src 94560488261961 (Book.Bool)))) λxP (Src 94560501893554 (Let "Y" (Src 94560510282089 (Lam "dep" λxdep (Src 94560516573545 (Book.Bool.true)))) λxY (Src 94560535447986 (Let "N" (Src 94560543836560 (Lam "val" λxval (Src 94560550128016 (Lam "dep" λxdep (Src 94560556419472 (Book.Bool.false)))))) λxN (Src 94560576342450 (App (App (App (App (App (Src 94560577391013 (Book.Kind.if.u60)) (Src 94560589973927 xb)) (Src 94560592071081 xP)) (Src 94560594168235 xY)) (Src 94560596265389 xN)) (Src 94560598362545 xdep))))))))))))) λxu60 (Src 94560609898353 (Let "num" (Src 94560620382837 (Lam "a.val" λxa.val (Src 94560628771445 (Lam "b" λxb (Src 94560632965749 (Lam "dep" λxdep (Src 94560647645813 (Let "P" (Src 94560656034294 (All "dep" (Src 94560664422896 (Book.Nat)) λxdep (Src 94560669665782 (Book.Bool)))) λxP (Src 94560683297397 (Let "Y" (Src 94560691685932 (Lam "b.val" λxb.val (Src 94560700074540 (Lam "dep" λxdep (Src 94560706365996 (App (App (Src 94560707414559 (Book.U60.equal)) (Src 94560717900325 xa.val)) (Src 94560724191787 xb.val))))))) λxY (Src 94560739920501 (Let "N" (Src 94560748309075 (Lam "val" λxval (Src 94560754600531 (Lam "dep" λxdep (Src 94560760891987 (Book.Bool.false)))))) λxN (Src 94560780814965 (App (App (App (App (App (Src 94560781863528 (Book.Kind.if.num)) (Src 94560794446442 xb)) (Src 94560796543596 xP)) (Src 94560798640750 xY)) (Src 94560800737904 xN)) (Src 94560802835060 xdep))))))))))))))) λxnum (Src 94560814370673 (Let "op2" (Src 94560824855415 (Lam "a.opr" λxa.opr (Src 94560833244023 (Lam "a.fst" λxa.fst (Src 94560841632631 (Lam "a.snd" λxa.snd (Src 94560850021239 (Lam "b" λxb (Src 94560854215543 (Lam "dep" λxdep (Src 94560868895607 (Let "P" (Src 94560877284041 (All "dep" (Src 94560885672643 (Book.Nat)) λxdep (Src 94560890915529 (Book.Bool)))) λxP (Src 94560904547191 (Let "Y" (Src 94560912935726 (Lam "b.opr" λxb.opr (Src 94560921324334 (Lam "b.fst" λxb.fst (Src 94560929712942 (Lam "b.snd" λxb.snd (Src 94560938101550 (Lam "dep" λxdep (Src 94560944393006 (App (App (Src 94560945441537 (Book.Bool.and)) (Src 94560954878743 (App (App (App (Src 94560955927302 xrec) (Src 94560960121612 xa.fst)) (Src 94560966413074 xb.fst)) (Src 94560972704534 xdep)))) (Src 94560977947437 (App (App (App (Src 94560978995996 xrec) (Src 94560983190306 xa.snd)) (Src 94560989481768 xb.snd)) (Src 94560995773228 xdep))))))))))))) λxY (Src 94561010453367 (Let "N" (Src 94561018841941 (Lam "val" λxval (Src 94561025133397 (Lam "dep" λxdep (Src 94561031424853 (Book.Bool.false)))))) λxN (Src 94561051347831 (App (App (App (App (App (Src 94561052396394 (Book.Kind.if.op2)) (Src 94561064979308 xb)) (Src 94561067076462 xP)) (Src 94561069173616 xY)) (Src 94561071270770 xN)) (Src 94561073367926 xdep))))))))))))))))))) λxop2 (Src 94561084903281 (Let "mat" (Src 94561095388473 (Lam "a.nam" λxa.nam (Src 94561103777081 (Lam "a.x" λxa.x (Src 94561110068537 (Lam "a.z" λxa.z (Src 94561116359993 (Lam "a.s" λxa.s (Src 94561122651449 (Lam "a.p" λxa.p (Src 94561128942905 (Lam "b" λxb (Src 94561133137209 (Lam "dep" λxdep (Src 94561147817273 (Let "P" (Src 94561156205523 (All "dep" (Src 94561164594125 (Book.Nat)) λxdep (Src 94561169837011 (Book.Bool)))) λxP (Src 94561183468857 (Let "Y" (Src 94561191857392 (Lam "b.nam" λxb.nam (Src 94561200246000 (Lam "b.x" λxb.x (Src 94561206537456 (Lam "b.z" λxb.z (Src 94561212828912 (Lam "b.s" λxb.s (Src 94561219120368 (Lam "b.p" λxb.p (Src 94561225411824 (Lam "dep" λxdep (Src 94561231703280 (App (App (Src 94561232751635 (Book.Bool.and)) (Src 94561242188837 (App (App (App (Src 94561243237400 xrec) (Src 94561247431708 xa.x)) (Src 94561251626016 xb.x)) (Src 94561255820324 xdep)))) (Src 94561261063407 (App (App (Src 94561262111791 (Book.Bool.and)) (Src 94561271548993 (App (App (App (Src 94561272597556 xrec) (Src 94561276791864 xa.z)) (Src 94561280986172 xb.z)) (Src 94561285180480 xdep)))) (Src 94561290423534 (App (App (Src 94561291471947 (Book.Bool.and)) (Src 94561300909233 (App (App (App (Src 94561301957712 xrec) (Src 94561306152059 (App (Src 94561307200597 xa.s) (Src 94561311394938 (App (App (Src 94561312443482 xVAR) (Src 94561316637813 (App (App (Src 94561317686377 (Book.String.concat)) (Src 94561332366447 xa.nam)) (Src 94561338657908 (Txt "-1"))))) (Src 94561344949369 xdep)))))) (Src 94561351240870 (App (Src 94561352289408 xb.s) (Src 94561356483749 (App (App (Src 94561357532293 xVAR) (Src 94561361726624 (App (App (Src 94561362775188 (Book.String.concat)) (Src 94561377455258 xb.nam)) (Src 94561383746719 (Txt "-1"))))) (Src 94561390038180 xdep)))))) (Src 94561396329648 (App (Src 94561397378219 xSUC) (Src 94561401572527 xdep)))))) (Src 94561407864045 (App (App (App (Src 94561408912566 xrec) (Src 94561413106892 (App (Src 94561414155451 xa.p) (Src 94561418349771 (App (App (Src 94561419398336 xVAR) (Src 94561423592646 xa.nam)) (Src 94561429884106 xdep)))))) (Src 94561436175586 (App (Src 94561437224145 xb.p) (Src 94561441418465 (App (App (Src 94561442467030 xVAR) (Src 94561446661340 xb.nam)) (Src 94561452952800 xdep)))))) (Src 94561459244268 (App (Src 94561460292839 xSUC) (Src 94561464487147 xdep))))))))))))))))))))))) λxY (Src 94561482313017 (Let "N" (Src 94561490701591 (Lam "val" λxval (Src 94561496993047 (Lam "dep" λxdep (Src 94561503284503 (Book.Bool.false)))))) λxN (Src 94561523207481 (App (App (App (App (App (Src 94561524256044 (Book.Kind.if.mat)) (Src 94561536838958 xb)) (Src 94561538936112 xP)) (Src 94561541033266 xY)) (Src 94561543130420 xN)) (Src 94561545227576 xdep))))))))))))))))))))))) λxmat (Src 94561556762481 (Let "txt" (Src 94561567247871 (Lam "a.txt" λxa.txt (Src 94561575636479 (Lam "b" λxb (Src 94561579830783 (Lam "dep" λxdep (Src 94561594510847 (Let "P" (Src 94561602899325 (All "dep" (Src 94561611287927 (Book.Nat)) λxdep (Src 94561616530813 (Book.Bool)))) λxP (Src 94561630162431 (Let "Y" (Src 94561638550966 (Lam "b.txt" λxb.txt (Src 94561646939574 (Lam "dep" λxdep (Src 94561653231030 (App (App (Src 94561654279593 (Book.String.equal)) (Src 94561667911087 xa.txt)) (Src 94561674202549 xb.txt))))))) λxY (Src 94561689931263 (Let "N" (Src 94561698319837 (Lam "val" λxval (Src 94561704611293 (Lam "dep" λxdep (Src 94561710902749 (Book.Bool.false)))))) λxN (Src 94561730825727 (App (App (App (App (App (Src 94561731874290 (Book.Kind.if.txt)) (Src 94561744457204 xb)) (Src 94561746554358 xP)) (Src 94561748651512 xY)) (Src 94561750748666 xN)) (Src 94561752845822 xdep))))))))))))))) λxtxt (Src 94561764380529 (Let "hol" (Src 94561774865980 (Lam "a.nam" λxa.nam (Src 94561783254588 (Lam "a.ctx" λxa.ctx (Src 94561791643196 (Lam "b" λxb (Src 94561795837500 (Lam "dep" λxdep (Src 94561810517564 (Book.Bool.false)))))))))) λxhol (Src 94561844072305 (Let "var" (Src 94561854557982 (Lam "a.nam" λxa.nam (Src 94561862946590 (Lam "a.idx" λxa.idx (Src 94561871335198 (Lam "b" λxb (Src 94561875529502 (Lam "dep" λxdep (Src 94561890209566 (Let "P" (Src 94561898598039 (All "dep" (Src 94561906986641 (Book.Nat)) λxdep (Src 94561912229527 (Book.Bool)))) λxP (Src 94561925861150 (Let "Y" (Src 94561934249685 (Lam "b.nam" λxb.nam (Src 94561942638293 (Lam "b.idx" λxb.idx (Src 94561951026901 (Lam "dep" λxdep (Src 94561957318357 (App (App (Src 94561958366920 (Book.Nat.equal)) (Src 94561968852686 xa.idx)) (Src 94561975144148 xb.idx))))))))) λxY (Src 94561990872862 (Let "N" (Src 94561999261436 (Lam "val" λxval (Src 94562005552892 (Lam "dep" λxdep (Src 94562011844348 (Book.Bool.false)))))) λxN (Src 94562031767326 (App (App (App (App (App (Src 94562032815889 (Book.Kind.if.var)) (Src 94562045398803 xb)) (Src 94562047495957 xP)) (Src 94562049593111 xY)) (Src 94562051690265 xN)) (Src 94562053787421 xdep))))))))))))))))) λxvar (Src 94562065321841 (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (Src 94562066370344 (Ins (Src 94562067418920 xa))) (Src 94562069516074 xP)) (Src 94562071613230 xall)) (Src 94562075807538 xlam)) (Src 94562080001846 xapp)) (Src 94562084196154 xann)) (Src 94562088390462 xslf)) (Src 94562092584770 xins)) (Src 94562096779078 xref)) (Src 94562100973386 xdef)) (Src 94562105167694 xset)) (Src 94562109362002 xu60)) (Src 94562113556310 xnum)) (Src 94562117750618 xop2)) (Src 94562121944926 xmat)) (Src 94562126139234 xtxt)) (Src 94562130333542 xhol)) (Src 94562134527850 xvar)) (Src 94562138722156 xb)) (Src 94562140819312 xdep))))))))))))))))))))))))))))))))))))))))))) λxN (Src 94562150256529 (App (App (App (App (App (App (Src 94562151305090 (Book.Kind.if.hol)) (Src 94562163888004 xb)) (Src 94562165985158 xR)) (Src 94562168082312 xY)) (Src 94562170179466 xN)) (Src 94562172276622 xdep)) (Src 94562176470928 xa))))))))))))))) λxN (Src 94562181713839 (App (App (App (App (App (App (Src 94562182762400 (Book.Kind.if.hol)) (Src 94562195345314 xa)) (Src 94562197442468 xR)) (Src 94562199539622 xY)) (Src 94562201636776 xN)) (Src 94562203733930 xb)) (Src 94562205831086 xdep))))))))))))))))))))))))) (Src 94558016766099 (All "rec" (Src 94558026203215 (All "a" (Src 94558033543209 (Book.Kind.Term)) λxa (Src 94558045077583 (All "b" (Src 94558052417595 (Book.Kind.Term)) λxb (Src 94558063951951 (All "dep" (Src 94558073389129 (Book.Nat)) λxdep (Src 94558078632015 (Book.Bool)))))))) λxrec (Src 94558087020691 (All "a" (Src 94558096457829 (Book.Kind.Term)) λxa (Src 94558110089363 (All "b" (Src 94558119526523 (Book.Kind.Term)) λxb (Src 94558133158035 (All "dep" (Src 94558142595211 (Book.Nat)) λxdep (Src 94558149935251 (Book.Bool))))))))))))
Book.Kind.def = (Ref "Kind.def" [] (Ann (Src 45080085790964 (Lam "nam" λxnam (Src 45080092082420 (Lam "val" λxval (Src 45080098373876 (Lam "bod" λxbod (Src 45080106762484 (Ins (Src 45080107811060 (Lam "P" λxP (Src 45080112005364 (Lam "all" λxall (Src 45080118296820 (Lam "lam" λxlam (Src 45080124588276 (Lam "app" λxapp (Src 45080130879732 (Lam "ann" λxann (Src 45080137171188 (Lam "slf" λxslf (Src 45080143462644 (Lam "ins" λxins (Src 45080149754100 (Lam "ref" λxref (Src 45080156045556 (Lam "def" λxdef (Src 45080162337012 (Lam "set" λxset (Src 45080168628468 (Lam "u60" λxu60 (Src 45080174919924 (Lam "num" λxnum (Src 45080181211380 (Lam "op2" λxop2 (Src 45080187502836 (Lam "mat" λxmat (Src 45080193794292 (Lam "txt" λxtxt (Src 45080200085748 (Lam "hol" λxhol (Src 45080206377204 (Lam "var" λxvar (Src 45080214765812 (App (App (App (Src 45080215814375 xdef) (Src 45080220008683 xnam)) (Src 45080224202991 xval)) (Src 45080228397299 xbod))))))))))))))))))))))))))))))))))))))))))))) (Src 45079988273253 (All "nam" (Src 45079997710362 (Book.String)) λxnam (Src 45080008196197 (All "val" (Src 45080017633328 (Book.Kind.Term)) λxval (Src 45080031264869 (All "bod" (Src 45080040702040 (All "x" (Src 45080048042061 (Book.Kind.Term)) λxx (Src 45080059576408 (Book.Kind.Term)))) λxbod (Src 45080073207909 (Book.Kind.Term))))))))))
Book.Kind.equal = (Ref "Kind.equal" [] (Ann (Src 90160033169551 (Lam "a" λxa (Src 90160037363855 (Lam "b" λxb (Src 90160041558159 (Lam "dep" λxdep (Src 90160049946767 (App (App (App (App (Src 90160050995309 (Book.Kind.equal.minor)) (Src 90160068821126 (App (App (App (Src 90160069869693 (Book.Kind.identical)) (Src 90160085598335 xa)) (Src 90160087695489 xb)) (Src 90160089792645 xdep)))) (Src 90160095035528 xa)) (Src 90160097132682 xb)) (Src 90160099229838 xdep))))))))) (Src 90159967109193 (All "a" (Src 90159974449181 (Book.Kind.Term)) λxa (Src 90159988080713 (All "b" (Src 90159995420721 (Book.Kind.Term)) λxb (Src 90160009052233 (All "dep" (Src 90160018489409 (Book.Nat)) λxdep (Src 90160025829449 (Book.Bool))))))))))
Book.Kind.equal.enter = (Ref "Kind.equal.enter" [] (Ann (Src 93458590073148 (Lam "e" λxe (Src 93458594267452 (Lam "a" λxa (Src 93458598461756 (Lam "b" λxb (Src 93458602656060 (Lam "dep" λxdep (Src 93458611044668 (Let "P" (Src 93458623627451 (Lam "x" λxx (Src 93458627821755 (All "a" (Src 93458635161749 (Book.Kind.Term)) λxa (Src 93458646696123 (All "b" (Src 93458654036135 (Book.Kind.Term)) λxb (Src 93458665570491 (All "dep" (Src 93458675007669 (Book.Nat)) λxdep (Src 93458680250555 (Book.Bool)))))))))) λxP (Src 93458687590716 (Let "true" (Src 93458700173537 (Lam "a" λxa (Src 93458704367841 (Lam "b" λxb (Src 93458708562145 (Lam "dep" λxdep (Src 93458714853601 (Book.Bool.true)))))))) λxtrue (Src 93458727436604 (Let "false" (Src 93458740019488 (Lam "a" λxa (Src 93458744213792 (Lam "b" λxb (Src 93458748408096 (Lam "dep" λxdep (Src 93458754699552 (App (App (App (App (Src 93458755748108 (Book.Kind.comparer)) (Src 93458770428183 (Book.Kind.equal))) (Src 93458781962521 xa)) (Src 93458784059675 xb)) (Src 93458786156831 xdep))))))))) λxfalse (Src 93458793496892 (App (App (App (App (App (App (Src 93458794545446 (Ins (Src 93458795594022 xe))) (Src 93458797691176 xP)) (Src 93458799788333 xtrue)) (Src 93458805031219 xfalse)) (Src 93458811322677 xa)) (Src 93458813419831 xb)) (Src 93458815516987 xdep))))))))))))))))) (Src 93458508283998 (All "e" (Src 93458515623966 (Book.Bool)) λxe (Src 93458524012638 (All "a" (Src 93458531352626 (Book.Kind.Term)) λxa (Src 93458544984158 (All "b" (Src 93458552324166 (Book.Kind.Term)) λxb (Src 93458565955678 (All "dep" (Src 93458575392854 (Book.Nat)) λxdep (Src 93458582732894 (Book.Bool))))))))))))
Book.Kind.equal.major = (Ref "Kind.equal.major" [] (Ann (Src 92359078445493 (Lam "e" λxe (Src 92359082639797 (Lam "a" λxa (Src 92359086834101 (Lam "b" λxb (Src 92359091028405 (Lam "dep" λxdep (Src 92359099417013 (Let "P" (Src 92359111999675 (Lam "x" λxx (Src 92359116193979 (All "a" (Src 92359123533973 (Book.Kind.Term)) λxa (Src 92359135068347 (All "b" (Src 92359142408359 (Book.Kind.Term)) λxb (Src 92359153942715 (All "dep" (Src 92359163379893 (Book.Nat)) λxdep (Src 92359168622779 (Book.Bool)))))))))) λxP (Src 92359175963061 (Let "true" (Src 92359188545761 (Lam "a" λxa (Src 92359192740065 (Lam "b" λxb (Src 92359196934369 (Lam "dep" λxdep (Src 92359203225825 (Book.Bool.true)))))))) λxtrue (Src 92359215808949 (Let "false" (Src 92359228391833 (Lam "a" λxa (Src 92359232586137 (Lam "b" λxb (Src 92359236780441 (Lam "dep" λxdep (Src 92359247266201 (Let "a_wnf" (Src 92359259848999 (App (App (Src 92359260897562 (Book.Kind.reduce)) (Src 92359273480484 (Book.Bool.true))) (Src 92359283966246 xa))) λxa_wnf (Src 92359291306393 (Let "b_wnf" (Src 92359303889233 (App (App (Src 92359304937796 (Book.Kind.reduce)) (Src 92359317520718 (Book.Bool.true))) (Src 92359328006480 xb))) λxb_wnf (Src 92359335346585 (App (App (App (App (Src 92359336395111 (Book.Kind.equal.enter)) (Src 92359354220936 (App (App (App (Src 92359355269495 (Book.Kind.identical)) (Src 92359370998141 xa_wnf)) (Src 92359377289603 xb_wnf)) (Src 92359383581063 xdep)))) (Src 92359388823950 xa_wnf)) (Src 92359395115412 xb_wnf)) (Src 92359401406872 xdep))))))))))))) λxfalse (Src 92359408746933 (App (App (App (App (App (App (Src 92359409795487 (Ins (Src 92359410844063 xe))) (Src 92359412941217 xP)) (Src 92359415038374 xtrue)) (Src 92359420281260 xfalse)) (Src 92359426572718 xa)) (Src 92359428669872 xb)) (Src 92359430767028 xdep))))))))))))))))) (Src 92358996656222 (All "e" (Src 92359003996190 (Book.Bool)) λxe (Src 92359012384862 (All "a" (Src 92359019724850 (Book.Kind.Term)) λxa (Src 92359033356382 (All "b" (Src 92359040696390 (Book.Kind.Term)) λxb (Src 92359054327902 (All "dep" (Src 92359063765078 (Book.Nat)) λxdep (Src 92359071105118 (Book.Bool))))))))))))
Book.Kind.equal.minor = (Ref "Kind.equal.minor" [] (Ann (Src 91259566817719 (Lam "e" λxe (Src 91259571012023 (Lam "a" λxa (Src 91259575206327 (Lam "b" λxb (Src 91259579400631 (Lam "dep" λxdep (Src 91259587789239 (Let "P" (Src 91259600371899 (Lam "x" λxx (Src 91259604566203 (All "a" (Src 91259611906197 (Book.Kind.Term)) λxa (Src 91259623440571 (All "b" (Src 91259630780583 (Book.Kind.Term)) λxb (Src 91259642314939 (All "dep" (Src 91259651752117 (Book.Nat)) λxdep (Src 91259656995003 (Book.Bool)))))))))) λxP (Src 91259664335287 (Let "true" (Src 91259676917985 (Lam "a" λxa (Src 91259681112289 (Lam "b" λxb (Src 91259685306593 (Lam "dep" λxdep (Src 91259691598049 (Book.Bool.true)))))))) λxtrue (Src 91259704181175 (Let "false" (Src 91259716764059 (Lam "a" λxa (Src 91259720958363 (Lam "b" λxb (Src 91259725152667 (Lam "dep" λxdep (Src 91259735638427 (Let "a_wnf" (Src 91259748221224 (App (App (Src 91259749269786 (Book.Kind.reduce)) (Src 91259761852709 (Book.Bool.false))) (Src 91259773387047 xa))) λxa_wnf (Src 91259780727195 (Let "b_wnf" (Src 91259793310035 (App (App (Src 91259794358597 (Book.Kind.reduce)) (Src 91259806941520 (Book.Bool.false))) (Src 91259818475858 xb))) λxb_wnf (Src 91259825815963 (App (App (App (App (Src 91259826864489 (Book.Kind.equal.major)) (Src 91259844690314 (App (App (App (Src 91259845738873 (Book.Kind.identical)) (Src 91259861467519 xa_wnf)) (Src 91259867758981 xb_wnf)) (Src 91259874050441 xdep)))) (Src 91259879293328 xa_wnf)) (Src 91259885584790 xb_wnf)) (Src 91259891876250 xdep))))))))))))) λxfalse (Src 91259899216311 (App (App (App (App (App (App (Src 91259900264865 (Ins (Src 91259901313441 xe))) (Src 91259903410595 xP)) (Src 91259905507752 xtrue)) (Src 91259910750638 xfalse)) (Src 91259917042096 xa)) (Src 91259919139250 xb)) (Src 91259921236406 xdep))))))))))))))))) (Src 91259485028446 (All "e" (Src 91259492368414 (Book.Bool)) λxe (Src 91259500757086 (All "a" (Src 91259508097074 (Book.Kind.Term)) λxa (Src 91259521728606 (All "b" (Src 91259529068614 (Book.Kind.Term)) λxb (Src 91259542700126 (All "dep" (Src 91259552137302 (Book.Nat)) λxdep (Src 91259559477342 (Book.Bool))))))))))))
Book.Kind.hol = (Ref "Kind.hol" [] (Ann (Src 46179562815689 (Lam "nam" λxnam (Src 46179569107145 (Lam "ctx" λxctx (Src 46179577495753 (Ins (Src 46179578544329 (Lam "P" λxP (Src 46179582738633 (Lam "all" λxall (Src 46179589030089 (Lam "lam" λxlam (Src 46179595321545 (Lam "app" λxapp (Src 46179601613001 (Lam "ann" λxann (Src 46179607904457 (Lam "slf" λxslf (Src 46179614195913 (Lam "ins" λxins (Src 46179620487369 (Lam "ref" λxref (Src 46179626778825 (Lam "def" λxdef (Src 46179633070281 (Lam "set" λxset (Src 46179639361737 (Lam "u60" λxu60 (Src 46179645653193 (Lam "num" λxnum (Src 46179651944649 (Lam "op2" λxop2 (Src 46179658236105 (Lam "mat" λxmat (Src 46179664527561 (Lam "txt" λxtxt (Src 46179670819017 (Lam "hol" λxhol (Src 46179677110473 (Lam "var" λxvar (Src 46179685499081 (App (App (Src 46179686547648 xhol) (Src 46179690741956 xnam)) (Src 46179694936264 xctx))))))))))))))))))))))))))))))))))))))))))) (Src 46179499900996 (All "nam" (Src 46179509338138 (Book.String)) λxnam (Src 46179519823940 (All "ctx" (Src 46179529261111 (App (Src 46179530309676 (Book.List)) (Src 46179535552566 (Book.Kind.Term)))) λxctx (Src 46179550232644 (Book.Kind.Term))))))))
Book.Kind.identical = (Ref "Kind.identical" [] (Ann (Src 111050758291590 (Lam "a" λxa (Src 111050762485894 (Lam "b" λxb (Src 111050766680198 (Lam "dep" λxdep (Src 111050775068806 (App (App (App (App (Src 111050776117358 (Book.Kind.comparer)) (Src 111050790797437 (Book.Kind.identical))) (Src 111050806526079 xa)) (Src 111050808623233 xb)) (Src 111050810720389 xdep))))))))) (Src 111050692231245 (All "a" (Src 111050699571233 (Book.Kind.Term)) λxa (Src 111050713202765 (All "b" (Src 111050720542773 (Book.Kind.Term)) λxb (Src 111050734174285 (All "dep" (Src 111050743611461 (Book.Nat)) λxdep (Src 111050750951501 (Book.Bool))))))))))
Book.Kind.if.all = (Ref "Kind.if.all" [] (Ann (Src 67070389650775 (Lam "term" λxterm (Src 67070396990807 (Lam "P" λxP (Src 67070401185111 (Lam "Y" λxY (Src 67070405379415 (Lam "N" λxN (Src 67070411670871 (Let "P" (Src 67070422155587 (Lam "x" λxx (Src 67070426349891 (All "Y" (Src 67070433689890 (All "nam" (Src 67070443127013 (Book.String)) λxnam (Src 67070451515682 (All "inp" (Src 67070460952825 (Book.Kind.Term)) λxinp (Src 67070472487202 (All "bod" (Src 67070481924383 (All "x" (Src 67070489264404 (Book.Kind.Term)) λxx (Src 67070500798751 (Book.Kind.Term)))) λxbod (Src 67070512333090 xP))))))) λxY (Src 67070515478851 (All "N" (Src 67070522818880 (All "val" (Src 67070532256061 (Book.Kind.Term)) λxval (Src 67070543790400 xP))) λxN (Src 67070546936131 xP))))))) λxP (Src 67070551131479 (Let "all" (Src 67070561616251 (Lam "nam" λxnam (Src 67070567907707 (Lam "inp" λxinp (Src 67070574199163 (Lam "bod" λxbod (Src 67070582587771 (Lam "Y" λxY (Src 67070586782075 (Lam "N" λxN (Src 67070590976379 (App (App (App (Src 67070592024942 xY) (Src 67070594122098 xnam)) (Src 67070598316406 xinp)) (Src 67070602510714 xbod))))))))))))) λxall (Src 67070609851735 (Let "lam" (Src 67070620336569 (Lam "nam" λxnam (Src 67070626628025 (Lam "bod" λxbod (Src 67070640259513 (Lam "Y" λxY (Src 67070644453817 (Lam "N" λxN (Src 67070648648121 (App (Src 67070649696677 xN) (Src 67070651793848 (App (App (Src 67070652842415 (Book.Kind.lam)) (Src 67070662279603 xnam)) (Src 67070666473911 xbod))))))))))))) λxlam (Src 67070674863447 (Let "app" (Src 67070685348343 (Lam "fun" λxfun (Src 67070691639799 (Lam "arg" λxarg (Src 67070705271287 (Lam "Y" λxY (Src 67070709465591 (Lam "N" λxN (Src 67070713659895 (App (Src 67070714708451 xN) (Src 67070716805622 (App (App (Src 67070717854189 (Book.Kind.app)) (Src 67070727291377 xfun)) (Src 67070731485685 xarg))))))))))))) λxapp (Src 67070739875159 (Let "ann" (Src 67070750360117 (Lam "val" λxval (Src 67070756651573 (Lam "typ" λxtyp (Src 67070770283061 (Lam "Y" λxY (Src 67070774477365 (Lam "N" λxN (Src 67070778671669 (App (Src 67070779720225 xN) (Src 67070781817396 (App (App (Src 67070782865963 (Book.Kind.ann)) (Src 67070792303151 xval)) (Src 67070796497459 xtyp))))))))))))) λxann (Src 67070804886871 (Let "slf" (Src 67070815371891 (Lam "nam" λxnam (Src 67070821663347 (Lam "bod" λxbod (Src 67070835294835 (Lam "Y" λxY (Src 67070839489139 (Lam "N" λxN (Src 67070843683443 (App (Src 67070844731999 xN) (Src 67070846829170 (App (App (Src 67070847877737 (Book.Kind.slf)) (Src 67070857314925 xnam)) (Src 67070861509233 xbod))))))))))))) λxslf (Src 67070869898583 (Let "ins" (Src 67070880383660 (Lam "val" λxval (Src 67070899258028 (Lam "Y" λxY (Src 67070903452332 (Lam "N" λxN (Src 67070907646636 (App (Src 67070908695196 xN) (Src 67070910792363 (App (Src 67070911840934 (Book.Kind.ins)) (Src 67070921278122 xval))))))))))) λxins (Src 67070929667415 (Let "ref" (Src 67070940152554 (Lam "nam" λxnam (Src 67070946444010 (Lam "val" λxval (Src 67070960075498 (Lam "Y" λxY (Src 67070964269802 (Lam "N" λxN (Src 67070968464106 (App (Src 67070969512662 xN) (Src 67070971609833 (App (App (Src 67070972658400 (Book.Kind.ref)) (Src 67070982095588 xnam)) (Src 67070986289896 xval))))))))))))) λxref (Src 67070994679127 (Let "def" (Src 67071005164333 (Lam "nam" λxnam (Src 67071011455789 (Lam "val" λxval (Src 67071017747245 (Lam "bod" λxbod (Src 67071026135853 (Lam "Y" λxY (Src 67071030330157 (Lam "N" λxN (Src 67071034524461 (App (Src 67071035573013 xN) (Src 67071037670188 (App (App (App (Src 67071038718751 (Book.Kind.def)) (Src 67071048155939 xnam)) (Src 67071052350247 xval)) (Src 67071056544555 xbod))))))))))))))) λxdef (Src 67071064933719 (Let "set" (Src 67071093244767 (Lam "Y" λxY (Src 67071097439071 (Lam "N" λxN (Src 67071101633375 (App (Src 67071102681941 xN) (Src 67071104779102 (Book.Kind.set)))))))) λxset (Src 67071117362519 (Let "u60" (Src 67071145673617 (Lam "Y" λxY (Src 67071149867921 (Lam "N" λxN (Src 67071154062225 (App (Src 67071155110791 xN) (Src 67071157207952 (Book.Kind.u60)))))))) λxu60 (Src 67071169791319 (Let "num" (Src 67071180276682 (Lam "val" λxval (Src 67071199151050 (Lam "Y" λxY (Src 67071203345354 (Lam "N" λxN (Src 67071207539658 (App (Src 67071208588218 xN) (Src 67071210685385 (App (Src 67071211733956 (Book.Kind.num)) (Src 67071221171144 xval))))))))))) λxnum (Src 67071229560151 (Let "op2" (Src 67071240045581 (Lam "opr" λxopr (Src 67071246337037 (Lam "fst" λxfst (Src 67071252628493 (Lam "snd" λxsnd (Src 67071261017101 (Lam "Y" λxY (Src 67071265211405 (Lam "N" λxN (Src 67071269405709 (App (Src 67071270454261 xN) (Src 67071272551436 (App (App (App (Src 67071273599999 (Book.Kind.op2)) (Src 67071283037187 xopr)) (Src 67071287231495 xfst)) (Src 67071291425803 xsnd))))))))))))))) λxop2 (Src 67071299814743 (Let "mat" (Src 67071310300242 (Lam "nam" λxnam (Src 67071316591698 (Lam "x" λxx (Src 67071320786002 (Lam "z" λxz (Src 67071324980306 (Lam "s" λxs (Src 67071329174610 (Lam "p" λxp (Src 67071333368914 (Lam "Y" λxY (Src 67071337563218 (Lam "N" λxN (Src 67071341757522 (App (Src 67071342806074 xN) (Src 67071344903249 (App (App (App (App (App (Src 67071345951812 (Book.Kind.mat)) (Src 67071355389000 xnam)) (Src 67071359583306 xx)) (Src 67071361680460 xz)) (Src 67071363777614 xs)) (Src 67071365874768 xp))))))))))))))))))) λxmat (Src 67071372166487 (Let "txt" (Src 67071382652043 (Lam "lit" λxlit (Src 67071401526411 (Lam "Y" λxY (Src 67071405720715 (Lam "N" λxN (Src 67071409915019 (App (Src 67071410963579 xN) (Src 67071413060746 (App (Src 67071414109317 (Book.Kind.txt)) (Src 67071423546505 xlit))))))))))) λxtxt (Src 67071431935319 (Let "hol" (Src 67071442420937 (Lam "nam" λxnam (Src 67071448712393 (Lam "ctx" λxctx (Src 67071462343881 (Lam "Y" λxY (Src 67071466538185 (Lam "N" λxN (Src 67071470732489 (App (Src 67071471781045 xN) (Src 67071473878216 (App (App (Src 67071474926783 (Book.Kind.hol)) (Src 67071484363971 xnam)) (Src 67071488558279 xctx))))))))))))) λxhol (Src 67071496947031 (Let "var" (Src 67071507432711 (Lam "nam" λxnam (Src 67071513724167 (Lam "idx" λxidx (Src 67071527355655 (Lam "Y" λxY (Src 67071531549959 (Lam "N" λxN (Src 67071535744263 (App (Src 67071536792819 xN) (Src 67071538889990 (App (App (Src 67071539938557 (Book.Kind.var)) (Src 67071549375745 xnam)) (Src 67071553570053 xidx))))))))))))) λxvar (Src 67071561958743 (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (Src 67071563007248 (Ins (Src 67071564055824 xterm))) (Src 67071569298706 xP)) (Src 67071571395862 xall)) (Src 67071575590170 xlam)) (Src 67071579784478 xapp)) (Src 67071583978786 xann)) (Src 67071588173094 xslf)) (Src 67071592367402 xins)) (Src 67071596561710 xref)) (Src 67071600756018 xdef)) (Src 67071604950326 xset)) (Src 67071609144634 xu60)) (Src 67071613338942 xnum)) (Src 67071617533250 xop2)) (Src 67071621727558 xmat)) (Src 67071625921866 xtxt)) (Src 67071630116174 xhol)) (Src 67071634310482 xvar)) (Src 67071638504788 xY)) (Src 67071640601942 xN))))))))))))))))))))))))))))))))))))))))))))) (Src 67070223974569 (All "term" (Src 67070234460193 (Book.Kind.Term)) λxterm (Src 67070248091817 (All "P" (Src 67070255431725 (Set)) λxP (Src 67070260674729 (All "Y" (Src 67070268014724 (All "nam" (Src 67070277451847 (Book.String)) λxnam (Src 67070285840516 (All "inp" (Src 67070295277659 (Book.Kind.Term)) λxinp (Src 67070306812036 (All "bod" (Src 67070316249217 (All "x" (Src 67070323589238 (Book.Kind.Term)) λxx (Src 67070335123585 (Book.Kind.Term)))) λxbod (Src 67070346657924 xP))))))) λxY (Src 67070351900841 (All "N" (Src 67070359240868 (All "val" (Src 67070368678049 (Book.Kind.Term)) λxval (Src 67070380212388 xP))) λxN (Src 67070385455273 xP)))))))))))
Book.Kind.if.ann = (Ref "Kind.if.ann" [] (Ann (Src 113249841317137 (Lam "term" λxterm (Src 113249848657169 (Lam "P" λxP (Src 113249852851473 (Lam "Y" λxY (Src 113249857045777 (Lam "N" λxN (Src 113249863337233 (Let "P" (Src 113249873821949 (Lam "x" λxx (Src 113249878016253 (All "Y" (Src 113249885356252 (All "val" (Src 113249894793413 (Book.Kind.Term)) λxval (Src 113249906327772 (All "typ" (Src 113249915764953 (Book.Kind.Term)) λxtyp (Src 113249927299292 xP))))) λxY (Src 113249930445053 (All "N" (Src 113249937785082 (All "val" (Src 113249947222263 (Book.Kind.Term)) λxval (Src 113249958756602 xP))) λxN (Src 113249961902333 xP))))))) λxP (Src 113249966097681 (Let "all" (Src 113249976582464 (Lam "nam" λxnam (Src 113249982873920 (Lam "inp" λxinp (Src 113249989165376 (Lam "bod" λxbod (Src 113249997553984 (Lam "Y" λxY (Src 113250001748288 (Lam "N" λxN (Src 113250005942592 (App (Src 113250006991144 xN) (Src 113250009088319 (App (App (App (Src 113250010136882 (Book.Kind.all)) (Src 113250019574070 xnam)) (Src 113250023768378 xinp)) (Src 113250027962686 xbod))))))))))))))) λxall (Src 113250036352273 (Let "lam" (Src 113250046837118 (Lam "nam" λxnam (Src 113250053128574 (Lam "bod" λxbod (Src 113250066760062 (Lam "Y" λxY (Src 113250070954366 (Lam "N" λxN (Src 113250075148670 (App (Src 113250076197226 xN) (Src 113250078294397 (App (App (Src 113250079342964 (Book.Kind.lam)) (Src 113250088780152 xnam)) (Src 113250092974460 xbod))))))))))))) λxlam (Src 113250101363985 (Let "app" (Src 113250111848892 (Lam "fun" λxfun (Src 113250118140348 (Lam "arg" λxarg (Src 113250131771836 (Lam "Y" λxY (Src 113250135966140 (Lam "N" λxN (Src 113250140160444 (App (Src 113250141209000 xN) (Src 113250143306171 (App (App (Src 113250144354738 (Book.Kind.app)) (Src 113250153791926 xfun)) (Src 113250157986234 xarg))))))))))))) λxapp (Src 113250166375697 (Let "ann" (Src 113250176860655 (Lam "val" λxval (Src 113250183152111 (Lam "typ" λxtyp (Src 113250196783599 (Lam "Y" λxY (Src 113250200977903 (Lam "N" λxN (Src 113250205172207 (App (App (Src 113250206220774 xY) (Src 113250208317930 xval)) (Src 113250212512238 xtyp))))))))))) λxann (Src 113250219853073 (Let "slf" (Src 113250230338093 (Lam "nam" λxnam (Src 113250236629549 (Lam "bod" λxbod (Src 113250250261037 (Lam "Y" λxY (Src 113250254455341 (Lam "N" λxN (Src 113250258649645 (App (Src 113250259698201 xN) (Src 113250261795372 (App (App (Src 113250262843939 (Book.Kind.slf)) (Src 113250272281127 xnam)) (Src 113250276475435 xbod))))))))))))) λxslf (Src 113250284864785 (Let "ins" (Src 113250295349862 (Lam "val" λxval (Src 113250314224230 (Lam "Y" λxY (Src 113250318418534 (Lam "N" λxN (Src 113250322612838 (App (Src 113250323661398 xN) (Src 113250325758565 (App (Src 113250326807136 (Book.Kind.ins)) (Src 113250336244324 xval))))))))))) λxins (Src 113250344633617 (Let "ref" (Src 113250355118756 (Lam "nam" λxnam (Src 113250361410212 (Lam "val" λxval (Src 113250375041700 (Lam "Y" λxY (Src 113250379236004 (Lam "N" λxN (Src 113250383430308 (App (Src 113250384478864 xN) (Src 113250386576035 (App (App (Src 113250387624602 (Book.Kind.ref)) (Src 113250397061790 xnam)) (Src 113250401256098 xval))))))))))))) λxref (Src 113250409645329 (Let "def" (Src 113250420130535 (Lam "nam" λxnam (Src 113250426421991 (Lam "val" λxval (Src 113250432713447 (Lam "bod" λxbod (Src 113250441102055 (Lam "Y" λxY (Src 113250445296359 (Lam "N" λxN (Src 113250449490663 (App (Src 113250450539215 xN) (Src 113250452636390 (App (App (App (Src 113250453684953 (Book.Kind.def)) (Src 113250463122141 xnam)) (Src 113250467316449 xval)) (Src 113250471510757 xbod))))))))))))))) λxdef (Src 113250479899921 (Let "set" (Src 113250508210969 (Lam "Y" λxY (Src 113250512405273 (Lam "N" λxN (Src 113250516599577 (App (Src 113250517648143 xN) (Src 113250519745304 (Book.Kind.set)))))))) λxset (Src 113250532328721 (Let "u60" (Src 113250560639819 (Lam "Y" λxY (Src 113250564834123 (Lam "N" λxN (Src 113250569028427 (App (Src 113250570076993 xN) (Src 113250572174154 (Book.Kind.u60)))))))) λxu60 (Src 113250584757521 (Let "num" (Src 113250595242884 (Lam "val" λxval (Src 113250614117252 (Lam "Y" λxY (Src 113250618311556 (Lam "N" λxN (Src 113250622505860 (App (Src 113250623554420 xN) (Src 113250625651587 (App (Src 113250626700158 (Book.Kind.num)) (Src 113250636137346 xval))))))))))) λxnum (Src 113250644526353 (Let "op2" (Src 113250655011783 (Lam "opr" λxopr (Src 113250661303239 (Lam "fst" λxfst (Src 113250667594695 (Lam "snd" λxsnd (Src 113250675983303 (Lam "Y" λxY (Src 113250680177607 (Lam "N" λxN (Src 113250684371911 (App (Src 113250685420463 xN) (Src 113250687517638 (App (App (App (Src 113250688566201 (Book.Kind.op2)) (Src 113250698003389 xopr)) (Src 113250702197697 xfst)) (Src 113250706392005 xsnd))))))))))))))) λxop2 (Src 113250714780945 (Let "mat" (Src 113250725266444 (Lam "nam" λxnam (Src 113250731557900 (Lam "x" λxx (Src 113250735752204 (Lam "z" λxz (Src 113250739946508 (Lam "s" λxs (Src 113250744140812 (Lam "p" λxp (Src 113250748335116 (Lam "Y" λxY (Src 113250752529420 (Lam "N" λxN (Src 113250756723724 (App (Src 113250757772276 xN) (Src 113250759869451 (App (App (App (App (App (Src 113250760918014 (Book.Kind.mat)) (Src 113250770355202 xnam)) (Src 113250774549508 xx)) (Src 113250776646662 xz)) (Src 113250778743816 xs)) (Src 113250780840970 xp))))))))))))))))))) λxmat (Src 113250787132689 (Let "txt" (Src 113250797618245 (Lam "lit" λxlit (Src 113250816492613 (Lam "Y" λxY (Src 113250820686917 (Lam "N" λxN (Src 113250824881221 (App (Src 113250825929781 xN) (Src 113250828026948 (App (Src 113250829075519 (Book.Kind.txt)) (Src 113250838512707 xlit))))))))))) λxtxt (Src 113250846901521 (Let "hol" (Src 113250857387139 (Lam "nam" λxnam (Src 113250863678595 (Lam "ctx" λxctx (Src 113250877310083 (Lam "Y" λxY (Src 113250881504387 (Lam "N" λxN (Src 113250885698691 (App (Src 113250886747247 xN) (Src 113250888844418 (App (App (Src 113250889892985 (Book.Kind.hol)) (Src 113250899330173 xnam)) (Src 113250903524481 xctx))))))))))))) λxhol (Src 113250911913233 (Let "var" (Src 113250922398913 (Lam "nam" λxnam (Src 113250928690369 (Lam "idx" λxidx (Src 113250942321857 (Lam "Y" λxY (Src 113250946516161 (Lam "N" λxN (Src 113250950710465 (App (Src 113250951759021 xN) (Src 113250953856192 (App (App (Src 113250954904759 (Book.Kind.var)) (Src 113250964341947 xnam)) (Src 113250968536255 xidx))))))))))))) λxvar (Src 113250976924945 (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (Src 113250977973450 (Ins (Src 113250979022026 xterm))) (Src 113250984264908 xP)) (Src 113250986362064 xall)) (Src 113250990556372 xlam)) (Src 113250994750680 xapp)) (Src 113250998944988 xann)) (Src 113251003139296 xslf)) (Src 113251007333604 xins)) (Src 113251011527912 xref)) (Src 113251015722220 xdef)) (Src 113251019916528 xset)) (Src 113251024110836 xu60)) (Src 113251028305144 xnum)) (Src 113251032499452 xop2)) (Src 113251036693760 xmat)) (Src 113251040888068 xtxt)) (Src 113251045082376 xhol)) (Src 113251049276684 xvar)) (Src 113251053470990 xY)) (Src 113251055568144 xN))))))))))))))))))))))))))))))))))))))))))))) (Src 113249712341126 (All "term" (Src 113249722826785 (Book.Kind.Term)) λxterm (Src 113249736458374 (All "P" (Src 113249743798317 (Set)) λxP (Src 113249749041286 (All "Y" (Src 113249756381281 (All "val" (Src 113249765818442 (Book.Kind.Term)) λxval (Src 113249777352801 (All "typ" (Src 113249786789982 (Book.Kind.Term)) λxtyp (Src 113249798324321 xP))))) λxY (Src 113249803567238 (All "N" (Src 113249810907265 (All "val" (Src 113249820344446 (Book.Kind.Term)) λxval (Src 113249831878785 xP))) λxN (Src 113249837121670 xP)))))))))))
Book.Kind.if.app = (Ref "Kind.if.app" [] (Ann (Src 96757166900497 (Lam "term" λxterm (Src 96757174240529 (Lam "P" λxP (Src 96757178434833 (Lam "Y" λxY (Src 96757182629137 (Lam "N" λxN (Src 96757188920593 (Let "P" (Src 96757199405309 (Lam "x" λxx (Src 96757203599613 (All "Y" (Src 96757210939612 (All "fun" (Src 96757220376773 (Book.Kind.Term)) λxfun (Src 96757231911132 (All "arg" (Src 96757241348313 (Book.Kind.Term)) λxarg (Src 96757252882652 xP))))) λxY (Src 96757256028413 (All "N" (Src 96757263368442 (All "val" (Src 96757272805623 (Book.Kind.Term)) λxval (Src 96757284339962 xP))) λxN (Src 96757287485693 xP))))))) λxP (Src 96757291681041 (Let "all" (Src 96757302165824 (Lam "nam" λxnam (Src 96757308457280 (Lam "inp" λxinp (Src 96757314748736 (Lam "bod" λxbod (Src 96757323137344 (Lam "Y" λxY (Src 96757327331648 (Lam "N" λxN (Src 96757331525952 (App (Src 96757332574504 xN) (Src 96757334671679 (App (App (App (Src 96757335720242 (Book.Kind.all)) (Src 96757345157430 xnam)) (Src 96757349351738 xinp)) (Src 96757353546046 xbod))))))))))))))) λxall (Src 96757361935633 (Let "lam" (Src 96757372420478 (Lam "nam" λxnam (Src 96757378711934 (Lam "bod" λxbod (Src 96757392343422 (Lam "Y" λxY (Src 96757396537726 (Lam "N" λxN (Src 96757400732030 (App (Src 96757401780586 xN) (Src 96757403877757 (App (App (Src 96757404926324 (Book.Kind.lam)) (Src 96757414363512 xnam)) (Src 96757418557820 xbod))))))))))))) λxlam (Src 96757426947345 (Let "app" (Src 96757437432241 (Lam "fun" λxfun (Src 96757443723697 (Lam "arg" λxarg (Src 96757457355185 (Lam "Y" λxY (Src 96757461549489 (Lam "N" λxN (Src 96757465743793 (App (App (Src 96757466792360 xY) (Src 96757468889516 xfun)) (Src 96757473083824 xarg))))))))))) λxapp (Src 96757480424721 (Let "ann" (Src 96757490909679 (Lam "val" λxval (Src 96757497201135 (Lam "typ" λxtyp (Src 96757510832623 (Lam "Y" λxY (Src 96757515026927 (Lam "N" λxN (Src 96757519221231 (App (Src 96757520269787 xN) (Src 96757522366958 (App (App (Src 96757523415525 (Book.Kind.ann)) (Src 96757532852713 xval)) (Src 96757537047021 xtyp))))))))))))) λxann (Src 96757545436433 (Let "slf" (Src 96757555921453 (Lam "nam" λxnam (Src 96757562212909 (Lam "bod" λxbod (Src 96757575844397 (Lam "Y" λxY (Src 96757580038701 (Lam "N" λxN (Src 96757584233005 (App (Src 96757585281561 xN) (Src 96757587378732 (App (App (Src 96757588427299 (Book.Kind.slf)) (Src 96757597864487 xnam)) (Src 96757602058795 xbod))))))))))))) λxslf (Src 96757610448145 (Let "ins" (Src 96757620933222 (Lam "val" λxval (Src 96757639807590 (Lam "Y" λxY (Src 96757644001894 (Lam "N" λxN (Src 96757648196198 (App (Src 96757649244758 xN) (Src 96757651341925 (App (Src 96757652390496 (Book.Kind.ins)) (Src 96757661827684 xval))))))))))) λxins (Src 96757670216977 (Let "ref" (Src 96757680702116 (Lam "nam" λxnam (Src 96757686993572 (Lam "val" λxval (Src 96757700625060 (Lam "Y" λxY (Src 96757704819364 (Lam "N" λxN (Src 96757709013668 (App (Src 96757710062224 xN) (Src 96757712159395 (App (App (Src 96757713207962 (Book.Kind.ref)) (Src 96757722645150 xnam)) (Src 96757726839458 xval))))))))))))) λxref (Src 96757735228689 (Let "def" (Src 96757745713895 (Lam "nam" λxnam (Src 96757752005351 (Lam "val" λxval (Src 96757758296807 (Lam "bod" λxbod (Src 96757766685415 (Lam "Y" λxY (Src 96757770879719 (Lam "N" λxN (Src 96757775074023 (App (Src 96757776122575 xN) (Src 96757778219750 (App (App (App (Src 96757779268313 (Book.Kind.def)) (Src 96757788705501 xnam)) (Src 96757792899809 xval)) (Src 96757797094117 xbod))))))))))))))) λxdef (Src 96757805483281 (Let "set" (Src 96757833794329 (Lam "Y" λxY (Src 96757837988633 (Lam "N" λxN (Src 96757842182937 (App (Src 96757843231503 xN) (Src 96757845328664 (Book.Kind.set)))))))) λxset (Src 96757857912081 (Let "u60" (Src 96757886223179 (Lam "Y" λxY (Src 96757890417483 (Lam "N" λxN (Src 96757894611787 (App (Src 96757895660353 xN) (Src 96757897757514 (Book.Kind.u60)))))))) λxu60 (Src 96757910340881 (Let "num" (Src 96757920826244 (Lam "val" λxval (Src 96757939700612 (Lam "Y" λxY (Src 96757943894916 (Lam "N" λxN (Src 96757948089220 (App (Src 96757949137780 xN) (Src 96757951234947 (App (Src 96757952283518 (Book.Kind.num)) (Src 96757961720706 xval))))))))))) λxnum (Src 96757970109713 (Let "op2" (Src 96757980595143 (Lam "opr" λxopr (Src 96757986886599 (Lam "fst" λxfst (Src 96757993178055 (Lam "snd" λxsnd (Src 96758001566663 (Lam "Y" λxY (Src 96758005760967 (Lam "N" λxN (Src 96758009955271 (App (Src 96758011003823 xN) (Src 96758013100998 (App (App (App (Src 96758014149561 (Book.Kind.op2)) (Src 96758023586749 xopr)) (Src 96758027781057 xfst)) (Src 96758031975365 xsnd))))))))))))))) λxop2 (Src 96758040364305 (Let "mat" (Src 96758050849804 (Lam "nam" λxnam (Src 96758057141260 (Lam "x" λxx (Src 96758061335564 (Lam "z" λxz (Src 96758065529868 (Lam "s" λxs (Src 96758069724172 (Lam "p" λxp (Src 96758073918476 (Lam "Y" λxY (Src 96758078112780 (Lam "N" λxN (Src 96758082307084 (App (Src 96758083355636 xN) (Src 96758085452811 (App (App (App (App (App (Src 96758086501374 (Book.Kind.mat)) (Src 96758095938562 xnam)) (Src 96758100132868 xx)) (Src 96758102230022 xz)) (Src 96758104327176 xs)) (Src 96758106424330 xp))))))))))))))))))) λxmat (Src 96758112716049 (Let "txt" (Src 96758123201605 (Lam "lit" λxlit (Src 96758142075973 (Lam "Y" λxY (Src 96758146270277 (Lam "N" λxN (Src 96758150464581 (App (Src 96758151513141 xN) (Src 96758153610308 (App (Src 96758154658879 (Book.Kind.txt)) (Src 96758164096067 xlit))))))))))) λxtxt (Src 96758172484881 (Let "hol" (Src 96758182970499 (Lam "nam" λxnam (Src 96758189261955 (Lam "ctx" λxctx (Src 96758202893443 (Lam "Y" λxY (Src 96758207087747 (Lam "N" λxN (Src 96758211282051 (App (Src 96758212330607 xN) (Src 96758214427778 (App (App (Src 96758215476345 (Book.Kind.hol)) (Src 96758224913533 xnam)) (Src 96758229107841 xctx))))))))))))) λxhol (Src 96758237496593 (Let "var" (Src 96758247982273 (Lam "nam" λxnam (Src 96758254273729 (Lam "idx" λxidx (Src 96758267905217 (Lam "Y" λxY (Src 96758272099521 (Lam "N" λxN (Src 96758276293825 (App (Src 96758277342381 xN) (Src 96758279439552 (App (App (Src 96758280488119 (Book.Kind.var)) (Src 96758289925307 xnam)) (Src 96758294119615 xidx))))))))))))) λxvar (Src 96758302508305 (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (Src 96758303556810 (Ins (Src 96758304605386 xterm))) (Src 96758309848268 xP)) (Src 96758311945424 xall)) (Src 96758316139732 xlam)) (Src 96758320334040 xapp)) (Src 96758324528348 xann)) (Src 96758328722656 xslf)) (Src 96758332916964 xins)) (Src 96758337111272 xref)) (Src 96758341305580 xdef)) (Src 96758345499888 xset)) (Src 96758349694196 xu60)) (Src 96758353888504 xnum)) (Src 96758358082812 xop2)) (Src 96758362277120 xmat)) (Src 96758366471428 xtxt)) (Src 96758370665736 xhol)) (Src 96758374860044 xvar)) (Src 96758379054350 xY)) (Src 96758381151504 xN))))))))))))))))))))))))))))))))))))))))))))) (Src 96757037924486 (All "term" (Src 96757048410145 (Book.Kind.Term)) λxterm (Src 96757062041734 (All "P" (Src 96757069381677 (Set)) λxP (Src 96757074624646 (All "Y" (Src 96757081964641 (All "fun" (Src 96757091401802 (Book.Kind.Term)) λxfun (Src 96757102936161 (All "arg" (Src 96757112373342 (Book.Kind.Term)) λxarg (Src 96757123907681 xP))))) λxY (Src 96757129150598 (All "N" (Src 96757136490625 (All "val" (Src 96757145927806 (Book.Kind.Term)) λxval (Src 96757157462145 xP))) λxN (Src 96757162705030 xP)))))))))))
Book.Kind.if.hol = (Ref "Kind.if.hol" [] (Ann (Src 97856682722585 (Lam "term" λxterm (Src 97856690062617 (Lam "P" λxP (Src 97856694256921 (Lam "Y" λxY (Src 97856698451225 (Lam "N" λxN (Src 97856704742681 (Let "P" (Src 97856715227397 (Lam "x" λxx (Src 97856719421701 (All "Y" (Src 97856726761700 (All "nam" (Src 97856736198854 (Book.String)) λxnam (Src 97856744587492 (All "ctx" (Src 97856754024673 (App (Src 97856755073238 (Book.List)) (Src 97856760316128 (Book.Kind.Term)))) λxctx (Src 97856772899044 xP))))) λxY (Src 97856776044805 (All "N" (Src 97856783384834 (All "val" (Src 97856792822015 (Book.Kind.Term)) λxval (Src 97856804356354 xP))) λxN (Src 97856807502085 xP))))))) λxP (Src 97856811697433 (Let "all" (Src 97856822182216 (Lam "nam" λxnam (Src 97856828473672 (Lam "inp" λxinp (Src 97856834765128 (Lam "bod" λxbod (Src 97856843153736 (Lam "Y" λxY (Src 97856847348040 (Lam "N" λxN (Src 97856851542344 (App (Src 97856852590896 xN) (Src 97856854688071 (App (App (App (Src 97856855736634 (Book.Kind.all)) (Src 97856865173822 xnam)) (Src 97856869368130 xinp)) (Src 97856873562438 xbod))))))))))))))) λxall (Src 97856881952025 (Let "lam" (Src 97856892436870 (Lam "nam" λxnam (Src 97856898728326 (Lam "bod" λxbod (Src 97856912359814 (Lam "Y" λxY (Src 97856916554118 (Lam "N" λxN (Src 97856920748422 (App (Src 97856921796978 xN) (Src 97856923894149 (App (App (Src 97856924942716 (Book.Kind.lam)) (Src 97856934379904 xnam)) (Src 97856938574212 xbod))))))))))))) λxlam (Src 97856946963737 (Let "app" (Src 97856957448644 (Lam "fun" λxfun (Src 97856963740100 (Lam "arg" λxarg (Src 97856977371588 (Lam "Y" λxY (Src 97856981565892 (Lam "N" λxN (Src 97856985760196 (App (Src 97856986808752 xN) (Src 97856988905923 (App (App (Src 97856989954490 (Book.Kind.app)) (Src 97856999391678 xfun)) (Src 97857003585986 xarg))))))))))))) λxapp (Src 97857011975449 (Let "ann" (Src 97857022460418 (Lam "val" λxval (Src 97857028751874 (Lam "typ" λxtyp (Src 97857042383362 (Lam "Y" λxY (Src 97857046577666 (Lam "N" λxN (Src 97857050771970 (App (Src 97857051820526 xN) (Src 97857053917697 (App (App (Src 97857054966264 (Book.Kind.ann)) (Src 97857064403452 xval)) (Src 97857068597760 xtyp))))))))))))) λxann (Src 97857076987161 (Let "slf" (Src 97857087472192 (Lam "nam" λxnam (Src 97857093763648 (Lam "bod" λxbod (Src 97857107395136 (Lam "Y" λxY (Src 97857111589440 (Lam "N" λxN (Src 97857115783744 (App (Src 97857116832300 xN) (Src 97857118929471 (App (App (Src 97857119978038 (Book.Kind.slf)) (Src 97857129415226 xnam)) (Src 97857133609534 xbod))))))))))))) λxslf (Src 97857141998873 (Let "ins" (Src 97857152483961 (Lam "val" λxval (Src 97857171358329 (Lam "Y" λxY (Src 97857175552633 (Lam "N" λxN (Src 97857179746937 (App (Src 97857180795497 xN) (Src 97857182892664 (App (Src 97857183941235 (Book.Kind.ins)) (Src 97857193378423 xval))))))))))) λxins (Src 97857201767705 (Let "ref" (Src 97857212252855 (Lam "nam" λxnam (Src 97857218544311 (Lam "val" λxval (Src 97857232175799 (Lam "Y" λxY (Src 97857236370103 (Lam "N" λxN (Src 97857240564407 (App (Src 97857241612963 xN) (Src 97857243710134 (App (App (Src 97857244758701 (Book.Kind.ref)) (Src 97857254195889 xnam)) (Src 97857258390197 xval))))))))))))) λxref (Src 97857266779417 (Let "def" (Src 97857277264634 (Lam "nam" λxnam (Src 97857283556090 (Lam "val" λxval (Src 97857289847546 (Lam "bod" λxbod (Src 97857298236154 (Lam "Y" λxY (Src 97857302430458 (Lam "N" λxN (Src 97857306624762 (App (Src 97857307673314 xN) (Src 97857309770489 (App (App (App (Src 97857310819052 (Book.Kind.def)) (Src 97857320256240 xnam)) (Src 97857324450548 xval)) (Src 97857328644856 xbod))))))))))))))) λxdef (Src 97857337034009 (Let "set" (Src 97857365345068 (Lam "Y" λxY (Src 97857369539372 (Lam "N" λxN (Src 97857373733676 (App (Src 97857374782242 xN) (Src 97857376879403 (Book.Kind.set)))))))) λxset (Src 97857389462809 (Let "u60" (Src 97857417773918 (Lam "Y" λxY (Src 97857421968222 (Lam "N" λxN (Src 97857426162526 (App (Src 97857427211092 xN) (Src 97857429308253 (Book.Kind.u60)))))))) λxu60 (Src 97857441891609 (Let "num" (Src 97857452376983 (Lam "val" λxval (Src 97857471251351 (Lam "Y" λxY (Src 97857475445655 (Lam "N" λxN (Src 97857479639959 (App (Src 97857480688519 xN) (Src 97857482785686 (App (Src 97857483834257 (Book.Kind.num)) (Src 97857493271445 xval))))))))))) λxnum (Src 97857501660441 (Let "op2" (Src 97857512145882 (Lam "opr" λxopr (Src 97857518437338 (Lam "fst" λxfst (Src 97857524728794 (Lam "snd" λxsnd (Src 97857533117402 (Lam "Y" λxY (Src 97857537311706 (Lam "N" λxN (Src 97857541506010 (App (Src 97857542554562 xN) (Src 97857544651737 (App (App (App (Src 97857545700300 (Book.Kind.op2)) (Src 97857555137488 xopr)) (Src 97857559331796 xfst)) (Src 97857563526104 xsnd))))))))))))))) λxop2 (Src 97857571915033 (Let "mat" (Src 97857582400543 (Lam "nam" λxnam (Src 97857588691999 (Lam "x" λxx (Src 97857592886303 (Lam "z" λxz (Src 97857597080607 (Lam "s" λxs (Src 97857601274911 (Lam "p" λxp (Src 97857605469215 (Lam "Y" λxY (Src 97857609663519 (Lam "N" λxN (Src 97857613857823 (App (Src 97857614906375 xN) (Src 97857617003550 (App (App (App (App (App (Src 97857618052113 (Book.Kind.mat)) (Src 97857627489301 xnam)) (Src 97857631683607 xx)) (Src 97857633780761 xz)) (Src 97857635877915 xs)) (Src 97857637975069 xp))))))))))))))))))) λxmat (Src 97857644266777 (Let "txt" (Src 97857654752344 (Lam "lit" λxlit (Src 97857673626712 (Lam "Y" λxY (Src 97857677821016 (Lam "N" λxN (Src 97857682015320 (App (Src 97857683063880 xN) (Src 97857685161047 (App (Src 97857686209618 (Book.Kind.txt)) (Src 97857695646806 xlit))))))))))) λxtxt (Src 97857704035609 (Let "hol" (Src 97857714521227 (Lam "nam" λxnam (Src 97857720812683 (Lam "ctx" λxctx (Src 97857734444171 (Lam "Y" λxY (Src 97857738638475 (Lam "N" λxN (Src 97857742832779 (App (App (Src 97857743881346 xY) (Src 97857745978502 xnam)) (Src 97857750172810 xctx))))))))))) λxhol (Src 97857757512985 (Let "var" (Src 97857767998665 (Lam "nam" λxnam (Src 97857774290121 (Lam "idx" λxidx (Src 97857787921609 (Lam "Y" λxY (Src 97857792115913 (Lam "N" λxN (Src 97857796310217 (App (Src 97857797358773 xN) (Src 97857799455944 (App (App (Src 97857800504511 (Book.Kind.var)) (Src 97857809941699 xnam)) (Src 97857814136007 xidx))))))))))))) λxvar (Src 97857822524697 (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (Src 97857823573202 (Ins (Src 97857824621778 xterm))) (Src 97857829864660 xP)) (Src 97857831961816 xall)) (Src 97857836156124 xlam)) (Src 97857840350432 xapp)) (Src 97857844544740 xann)) (Src 97857848739048 xslf)) (Src 97857852933356 xins)) (Src 97857857127664 xref)) (Src 97857861321972 xdef)) (Src 97857865516280 xset)) (Src 97857869710588 xu60)) (Src 97857873904896 xnum)) (Src 97857878099204 xop2)) (Src 97857882293512 xmat)) (Src 97857886487820 xtxt)) (Src 97857890682128 xhol)) (Src 97857894876436 xvar)) (Src 97857899070742 xY)) (Src 97857901167896 xN))))))))))))))))))))))))))))))))))))))))))))) (Src 97856549552266 (All "term" (Src 97856560037921 (Book.Kind.Term)) λxterm (Src 97856573669514 (All "P" (Src 97856581009453 (Set)) λxP (Src 97856586252426 (All "Y" (Src 97856593592421 (All "nam" (Src 97856603029575 (Book.String)) λxnam (Src 97856611418213 (All "ctx" (Src 97856620855394 (App (Src 97856621903959 (Book.List)) (Src 97856627146849 (Book.Kind.Term)))) λxctx (Src 97856639729765 xP))))) λxY (Src 97856644972682 (All "N" (Src 97856652312709 (All "val" (Src 97856661749890 (Book.Kind.Term)) λxval (Src 97856673284229 xP))) λxN (Src 97856678527114 xP)))))))))))
Book.Kind.if.lam = (Ref "Kind.if.lam" [] (Ann (Src 73667438445871 (Lam "term" λxterm (Src 73667445785903 (Lam "P" λxP (Src 73667449980207 (Lam "Y" λxY (Src 73667454174511 (Lam "N" λxN (Src 73667460465967 (Let "P" (Src 73667470950683 (Lam "x" λxx (Src 73667475144987 (All "Y" (Src 73667482484986 (All "nam" (Src 73667491922129 (Book.String)) λxnam (Src 73667500310778 (All "bod" (Src 73667509747959 (All "x" (Src 73667517087980 (Book.Kind.Term)) λxx (Src 73667528622327 (Book.Kind.Term)))) λxbod (Src 73667540156666 xP))))) λxY (Src 73667543302427 (All "N" (Src 73667550642456 (All "val" (Src 73667560079637 (Book.Kind.Term)) λxval (Src 73667571613976 xP))) λxN (Src 73667574759707 xP))))))) λxP (Src 73667578955055 (Let "all" (Src 73667589439838 (Lam "nam" λxnam (Src 73667595731294 (Lam "inp" λxinp (Src 73667602022750 (Lam "bod" λxbod (Src 73667610411358 (Lam "Y" λxY (Src 73667614605662 (Lam "N" λxN (Src 73667618799966 (App (Src 73667619848518 xN) (Src 73667621945693 (App (App (App (Src 73667622994256 (Book.Kind.all)) (Src 73667632431444 xnam)) (Src 73667636625752 xinp)) (Src 73667640820060 xbod))))))))))))))) λxall (Src 73667649209647 (Let "lam" (Src 73667659694481 (Lam "nam" λxnam (Src 73667665985937 (Lam "bod" λxbod (Src 73667679617425 (Lam "Y" λxY (Src 73667683811729 (Lam "N" λxN (Src 73667688006033 (App (App (Src 73667689054600 xY) (Src 73667691151756 xnam)) (Src 73667695346064 xbod))))))))))) λxlam (Src 73667702687023 (Let "app" (Src 73667713171919 (Lam "fun" λxfun (Src 73667719463375 (Lam "arg" λxarg (Src 73667733094863 (Lam "Y" λxY (Src 73667737289167 (Lam "N" λxN (Src 73667741483471 (App (Src 73667742532027 xN) (Src 73667744629198 (App (App (Src 73667745677765 (Book.Kind.app)) (Src 73667755114953 xfun)) (Src 73667759309261 xarg))))))))))))) λxapp (Src 73667767698735 (Let "ann" (Src 73667778183693 (Lam "val" λxval (Src 73667784475149 (Lam "typ" λxtyp (Src 73667798106637 (Lam "Y" λxY (Src 73667802300941 (Lam "N" λxN (Src 73667806495245 (App (Src 73667807543801 xN) (Src 73667809640972 (App (App (Src 73667810689539 (Book.Kind.ann)) (Src 73667820126727 xval)) (Src 73667824321035 xtyp))))))))))))) λxann (Src 73667832710447 (Let "slf" (Src 73667843195467 (Lam "nam" λxnam (Src 73667849486923 (Lam "bod" λxbod (Src 73667863118411 (Lam "Y" λxY (Src 73667867312715 (Lam "N" λxN (Src 73667871507019 (App (Src 73667872555575 xN) (Src 73667874652746 (App (App (Src 73667875701313 (Book.Kind.slf)) (Src 73667885138501 xnam)) (Src 73667889332809 xbod))))))))))))) λxslf (Src 73667897722159 (Let "ins" (Src 73667908207236 (Lam "val" λxval (Src 73667927081604 (Lam "Y" λxY (Src 73667931275908 (Lam "N" λxN (Src 73667935470212 (App (Src 73667936518772 xN) (Src 73667938615939 (App (Src 73667939664510 (Book.Kind.ins)) (Src 73667949101698 xval))))))))))) λxins (Src 73667957490991 (Let "ref" (Src 73667967976130 (Lam "nam" λxnam (Src 73667974267586 (Lam "val" λxval (Src 73667987899074 (Lam "Y" λxY (Src 73667992093378 (Lam "N" λxN (Src 73667996287682 (App (Src 73667997336238 xN) (Src 73667999433409 (App (App (Src 73668000481976 (Book.Kind.ref)) (Src 73668009919164 xnam)) (Src 73668014113472 xval))))))))))))) λxref (Src 73668022502703 (Let "def" (Src 73668032987909 (Lam "nam" λxnam (Src 73668039279365 (Lam "val" λxval (Src 73668045570821 (Lam "bod" λxbod (Src 73668053959429 (Lam "Y" λxY (Src 73668058153733 (Lam "N" λxN (Src 73668062348037 (App (Src 73668063396589 xN) (Src 73668065493764 (App (App (App (Src 73668066542327 (Book.Kind.def)) (Src 73668075979515 xnam)) (Src 73668080173823 xval)) (Src 73668084368131 xbod))))))))))))))) λxdef (Src 73668092757295 (Let "set" (Src 73668121068343 (Lam "Y" λxY (Src 73668125262647 (Lam "N" λxN (Src 73668129456951 (App (Src 73668130505517 xN) (Src 73668132602678 (Book.Kind.set)))))))) λxset (Src 73668145186095 (Let "u60" (Src 73668173497193 (Lam "Y" λxY (Src 73668177691497 (Lam "N" λxN (Src 73668181885801 (App (Src 73668182934367 xN) (Src 73668185031528 (Book.Kind.u60)))))))) λxu60 (Src 73668197614895 (Let "num" (Src 73668208100258 (Lam "val" λxval (Src 73668226974626 (Lam "Y" λxY (Src 73668231168930 (Lam "N" λxN (Src 73668235363234 (App (Src 73668236411794 xN) (Src 73668238508961 (App (Src 73668239557532 (Book.Kind.num)) (Src 73668248994720 xval))))))))))) λxnum (Src 73668257383727 (Let "op2" (Src 73668267869157 (Lam "opr" λxopr (Src 73668274160613 (Lam "fst" λxfst (Src 73668280452069 (Lam "snd" λxsnd (Src 73668288840677 (Lam "Y" λxY (Src 73668293034981 (Lam "N" λxN (Src 73668297229285 (App (Src 73668298277837 xN) (Src 73668300375012 (App (App (App (Src 73668301423575 (Book.Kind.op2)) (Src 73668310860763 xopr)) (Src 73668315055071 xfst)) (Src 73668319249379 xsnd))))))))))))))) λxop2 (Src 73668327638319 (Let "mat" (Src 73668338123818 (Lam "nam" λxnam (Src 73668344415274 (Lam "x" λxx (Src 73668348609578 (Lam "z" λxz (Src 73668352803882 (Lam "s" λxs (Src 73668356998186 (Lam "p" λxp (Src 73668361192490 (Lam "Y" λxY (Src 73668365386794 (Lam "N" λxN (Src 73668369581098 (App (Src 73668370629650 xN) (Src 73668372726825 (App (App (App (App (App (Src 73668373775388 (Book.Kind.mat)) (Src 73668383212576 xnam)) (Src 73668387406882 xx)) (Src 73668389504036 xz)) (Src 73668391601190 xs)) (Src 73668393698344 xp))))))))))))))))))) λxmat (Src 73668399990063 (Let "txt" (Src 73668410475619 (Lam "lit" λxlit (Src 73668429349987 (Lam "Y" λxY (Src 73668433544291 (Lam "N" λxN (Src 73668437738595 (App (Src 73668438787155 xN) (Src 73668440884322 (App (Src 73668441932893 (Book.Kind.txt)) (Src 73668451370081 xlit))))))))))) λxtxt (Src 73668459758895 (Let "hol" (Src 73668470244513 (Lam "nam" λxnam (Src 73668476535969 (Lam "ctx" λxctx (Src 73668490167457 (Lam "Y" λxY (Src 73668494361761 (Lam "N" λxN (Src 73668498556065 (App (Src 73668499604621 xN) (Src 73668501701792 (App (App (Src 73668502750359 (Book.Kind.hol)) (Src 73668512187547 xnam)) (Src 73668516381855 xctx))))))))))))) λxhol (Src 73668524770607 (Let "var" (Src 73668535256287 (Lam "nam" λxnam (Src 73668541547743 (Lam "idx" λxidx (Src 73668555179231 (Lam "Y" λxY (Src 73668559373535 (Lam "N" λxN (Src 73668563567839 (App (Src 73668564616395 xN) (Src 73668566713566 (App (App (Src 73668567762133 (Book.Kind.var)) (Src 73668577199321 xnam)) (Src 73668581393629 xidx))))))))))))) λxvar (Src 73668589782319 (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (Src 73668590830824 (Ins (Src 73668591879400 xterm))) (Src 73668597122282 xP)) (Src 73668599219438 xall)) (Src 73668603413746 xlam)) (Src 73668607608054 xapp)) (Src 73668611802362 xann)) (Src 73668615996670 xslf)) (Src 73668620190978 xins)) (Src 73668624385286 xref)) (Src 73668628579594 xdef)) (Src 73668632773902 xset)) (Src 73668636968210 xu60)) (Src 73668641162518 xnum)) (Src 73668645356826 xop2)) (Src 73668649551134 xmat)) (Src 73668653745442 xtxt)) (Src 73668657939750 xhol)) (Src 73668662134058 xvar)) (Src 73668666328364 xY)) (Src 73668668425518 xN))))))))))))))))))))))))))))))))))))))))))))) (Src 73667293741205 (All "term" (Src 73667304226849 (Book.Kind.Term)) λxterm (Src 73667317858453 (All "P" (Src 73667325198381 (Set)) λxP (Src 73667330441365 (All "Y" (Src 73667337781360 (All "nam" (Src 73667347218503 (Book.String)) λxnam (Src 73667355607152 (All "bod" (Src 73667365044333 (All "x" (Src 73667372384354 (Book.Kind.Term)) λxx (Src 73667383918701 (Book.Kind.Term)))) λxbod (Src 73667395453040 xP))))) λxY (Src 73667400695957 (All "N" (Src 73667408035984 (All "val" (Src 73667417473165 (Book.Kind.Term)) λxval (Src 73667429007504 xP))) λxN (Src 73667434250389 xP)))))))))))
Book.Kind.if.mat = (Ref "Kind.if.mat" [] (Ann (Src 98956279285179 (Lam "term" λxterm (Src 98956286625211 (Lam "P" λxP (Src 98956290819515 (Lam "Y" λxY (Src 98956295013819 (Lam "N" λxN (Src 98956301305275 (Let "P" (Src 98956311789991 (Lam "x" λxx (Src 98956315984295 (All "Y" (Src 98956323324294 (All "nam" (Src 98956332761367 (Book.String)) λxnam (Src 98956341150086 (All "x" (Src 98956348490025 (Book.Kind.Term)) λxx (Src 98956360024454 (All "z" (Src 98956367364411 (Book.Kind.Term)) λxz (Src 98956378898822 (All "s" (Src 98956386238815 (All "x" (Src 98956393578836 (Book.Kind.Term)) λxx (Src 98956405113183 (Book.Kind.Term)))) λxs (Src 98956416647558 (All "p" (Src 98956423987587 (All "x" (Src 98956431327608 (Book.Kind.Term)) λxx (Src 98956442861955 (Book.Kind.Term)))) λxp (Src 98956454396294 xP))))))))))) λxY (Src 98956457542055 (All "N" (Src 98956464882084 (All "val" (Src 98956474319265 (Book.Kind.Term)) λxval (Src 98956485853604 xP))) λxN (Src 98956488999335 xP))))))) λxP (Src 98956493194683 (Let "all" (Src 98956503679466 (Lam "nam" λxnam (Src 98956509970922 (Lam "inp" λxinp (Src 98956516262378 (Lam "bod" λxbod (Src 98956524650986 (Lam "Y" λxY (Src 98956528845290 (Lam "N" λxN (Src 98956533039594 (App (Src 98956534088146 xN) (Src 98956536185321 (App (App (App (Src 98956537233884 (Book.Kind.all)) (Src 98956546671072 xnam)) (Src 98956550865380 xinp)) (Src 98956555059688 xbod))))))))))))))) λxall (Src 98956563449275 (Let "lam" (Src 98956573934120 (Lam "nam" λxnam (Src 98956580225576 (Lam "bod" λxbod (Src 98956593857064 (Lam "Y" λxY (Src 98956598051368 (Lam "N" λxN (Src 98956602245672 (App (Src 98956603294228 xN) (Src 98956605391399 (App (App (Src 98956606439966 (Book.Kind.lam)) (Src 98956615877154 xnam)) (Src 98956620071462 xbod))))))))))))) λxlam (Src 98956628460987 (Let "app" (Src 98956638945894 (Lam "fun" λxfun (Src 98956645237350 (Lam "arg" λxarg (Src 98956658868838 (Lam "Y" λxY (Src 98956663063142 (Lam "N" λxN (Src 98956667257446 (App (Src 98956668306002 xN) (Src 98956670403173 (App (App (Src 98956671451740 (Book.Kind.app)) (Src 98956680888928 xfun)) (Src 98956685083236 xarg))))))))))))) λxapp (Src 98956693472699 (Let "ann" (Src 98956703957668 (Lam "val" λxval (Src 98956710249124 (Lam "typ" λxtyp (Src 98956723880612 (Lam "Y" λxY (Src 98956728074916 (Lam "N" λxN (Src 98956732269220 (App (Src 98956733317776 xN) (Src 98956735414947 (App (App (Src 98956736463514 (Book.Kind.ann)) (Src 98956745900702 xval)) (Src 98956750095010 xtyp))))))))))))) λxann (Src 98956758484411 (Let "slf" (Src 98956768969442 (Lam "nam" λxnam (Src 98956775260898 (Lam "bod" λxbod (Src 98956788892386 (Lam "Y" λxY (Src 98956793086690 (Lam "N" λxN (Src 98956797280994 (App (Src 98956798329550 xN) (Src 98956800426721 (App (App (Src 98956801475288 (Book.Kind.slf)) (Src 98956810912476 xnam)) (Src 98956815106784 xbod))))))))))))) λxslf (Src 98956823496123 (Let "ins" (Src 98956833981211 (Lam "val" λxval (Src 98956852855579 (Lam "Y" λxY (Src 98956857049883 (Lam "N" λxN (Src 98956861244187 (App (Src 98956862292747 xN) (Src 98956864389914 (App (Src 98956865438485 (Book.Kind.ins)) (Src 98956874875673 xval))))))))))) λxins (Src 98956883264955 (Let "ref" (Src 98956893750105 (Lam "nam" λxnam (Src 98956900041561 (Lam "val" λxval (Src 98956913673049 (Lam "Y" λxY (Src 98956917867353 (Lam "N" λxN (Src 98956922061657 (App (Src 98956923110213 xN) (Src 98956925207384 (App (App (Src 98956926255951 (Book.Kind.ref)) (Src 98956935693139 xnam)) (Src 98956939887447 xval))))))))))))) λxref (Src 98956948276667 (Let "def" (Src 98956958761884 (Lam "nam" λxnam (Src 98956965053340 (Lam "val" λxval (Src 98956971344796 (Lam "bod" λxbod (Src 98956979733404 (Lam "Y" λxY (Src 98956983927708 (Lam "N" λxN (Src 98956988122012 (App (Src 98956989170564 xN) (Src 98956991267739 (App (App (App (Src 98956992316302 (Book.Kind.def)) (Src 98957001753490 xnam)) (Src 98957005947798 xval)) (Src 98957010142106 xbod))))))))))))))) λxdef (Src 98957018531259 (Let "set" (Src 98957046842318 (Lam "Y" λxY (Src 98957051036622 (Lam "N" λxN (Src 98957055230926 (App (Src 98957056279492 xN) (Src 98957058376653 (Book.Kind.set)))))))) λxset (Src 98957070960059 (Let "u60" (Src 98957099271168 (Lam "Y" λxY (Src 98957103465472 (Lam "N" λxN (Src 98957107659776 (App (Src 98957108708342 xN) (Src 98957110805503 (Book.Kind.u60)))))))) λxu60 (Src 98957123388859 (Let "num" (Src 98957133874233 (Lam "val" λxval (Src 98957152748601 (Lam "Y" λxY (Src 98957156942905 (Lam "N" λxN (Src 98957161137209 (App (Src 98957162185769 xN) (Src 98957164282936 (App (Src 98957165331507 (Book.Kind.num)) (Src 98957174768695 xval))))))))))) λxnum (Src 98957183157691 (Let "op2" (Src 98957193643132 (Lam "opr" λxopr (Src 98957199934588 (Lam "fst" λxfst (Src 98957206226044 (Lam "snd" λxsnd (Src 98957214614652 (Lam "Y" λxY (Src 98957218808956 (Lam "N" λxN (Src 98957223003260 (App (Src 98957224051812 xN) (Src 98957226148987 (App (App (App (Src 98957227197550 (Book.Kind.op2)) (Src 98957236634738 xopr)) (Src 98957240829046 xfst)) (Src 98957245023354 xsnd))))))))))))))) λxop2 (Src 98957253412283 (Let "mat" (Src 98957263897782 (Lam "nam" λxnam (Src 98957270189238 (Lam "x" λxx (Src 98957274383542 (Lam "z" λxz (Src 98957278577846 (Lam "s" λxs (Src 98957282772150 (Lam "p" λxp (Src 98957286966454 (Lam "Y" λxY (Src 98957291160758 (Lam "N" λxN (Src 98957295355062 (App (App (App (App (App (Src 98957296403625 xY) (Src 98957298500781 xnam)) (Src 98957302695087 xx)) (Src 98957304792241 xz)) (Src 98957306889395 xs)) (Src 98957308986549 xp))))))))))))))))) λxmat (Src 98957314229691 (Let "txt" (Src 98957324715247 (Lam "lit" λxlit (Src 98957343589615 (Lam "Y" λxY (Src 98957347783919 (Lam "N" λxN (Src 98957351978223 (App (Src 98957353026783 xN) (Src 98957355123950 (App (Src 98957356172521 (Book.Kind.txt)) (Src 98957365609709 xlit))))))))))) λxtxt (Src 98957373998523 (Let "hol" (Src 98957384484141 (Lam "nam" λxnam (Src 98957390775597 (Lam "ctx" λxctx (Src 98957404407085 (Lam "Y" λxY (Src 98957408601389 (Lam "N" λxN (Src 98957412795693 (App (Src 98957413844249 xN) (Src 98957415941420 (App (App (Src 98957416989987 (Book.Kind.hol)) (Src 98957426427175 xnam)) (Src 98957430621483 xctx))))))))))))) λxhol (Src 98957439010235 (Let "var" (Src 98957449495915 (Lam "nam" λxnam (Src 98957455787371 (Lam "idx" λxidx (Src 98957469418859 (Lam "Y" λxY (Src 98957473613163 (Lam "N" λxN (Src 98957477807467 (App (Src 98957478856023 xN) (Src 98957480953194 (App (App (Src 98957482001761 (Book.Kind.var)) (Src 98957491438949 xnam)) (Src 98957495633257 xidx))))))))))))) λxvar (Src 98957504021947 (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (Src 98957505070452 (Ins (Src 98957506119028 xterm))) (Src 98957511361910 xP)) (Src 98957513459066 xall)) (Src 98957517653374 xlam)) (Src 98957521847682 xapp)) (Src 98957526041990 xann)) (Src 98957530236298 xslf)) (Src 98957534430606 xins)) (Src 98957538624914 xref)) (Src 98957542819222 xdef)) (Src 98957547013530 xset)) (Src 98957551207838 xu60)) (Src 98957555402146 xnum)) (Src 98957559596454 xop2)) (Src 98957563790762 xmat)) (Src 98957567985070 xtxt)) (Src 98957572179378 xhol)) (Src 98957576373686 xvar)) (Src 98957580567992 xY)) (Src 98957582665146 xN))))))))))))))))))))))))))))))))))))))))))))) (Src 98956061180123 (All "term" (Src 98956071665697 (Book.Kind.Term)) λxterm (Src 98956085297371 (All "P" (Src 98956092637229 (Set)) λxP (Src 98956097880283 (All "Y" (Src 98956105220278 (All "nam" (Src 98956114657351 (Book.String)) λxnam (Src 98956123046070 (All "x" (Src 98956130386009 (Book.Kind.Term)) λxx (Src 98956141920438 (All "z" (Src 98956149260395 (Book.Kind.Term)) λxz (Src 98956160794806 (All "s" (Src 98956168134799 (All "x" (Src 98956175474820 (Book.Kind.Term)) λxx (Src 98956187009167 (Book.Kind.Term)))) λxs (Src 98956198543542 (All "p" (Src 98956205883571 (All "x" (Src 98956213223592 (Book.Kind.Term)) λxx (Src 98956224757939 (Book.Kind.Term)))) λxp (Src 98956236292278 xP))))))))))) λxY (Src 98956241535195 (All "N" (Src 98956248875222 (All "val" (Src 98956258312403 (Book.Kind.Term)) λxval (Src 98956269846742 xP))) λxN (Src 98956275089627 xP)))))))))))
Book.Kind.if.num = (Ref "Kind.if.num" [] (Ann (Src 75866419758303 (Lam "term" λxterm (Src 75866427098335 (Lam "P" λxP (Src 75866431292639 (Lam "Y" λxY (Src 75866435486943 (Lam "N" λxN (Src 75866441778399 (Let "P" (Src 75866452263115 (Lam "x" λxx (Src 75866456457419 (All "Y" (Src 75866463797418 (All "val" (Src 75866473234599 (U60)) λxval (Src 75866479526058 xP))) λxY (Src 75866482671819 (All "N" (Src 75866490011848 (All "val" (Src 75866499449029 (Book.Kind.Term)) λxval (Src 75866510983368 xP))) λxN (Src 75866514129099 xP))))))) λxP (Src 75866518324447 (Let "all" (Src 75866528809230 (Lam "nam" λxnam (Src 75866535100686 (Lam "inp" λxinp (Src 75866541392142 (Lam "bod" λxbod (Src 75866549780750 (Lam "Y" λxY (Src 75866553975054 (Lam "N" λxN (Src 75866558169358 (App (Src 75866559217910 xN) (Src 75866561315085 (App (App (App (Src 75866562363648 (Book.Kind.all)) (Src 75866571800836 xnam)) (Src 75866575995144 xinp)) (Src 75866580189452 xbod))))))))))))))) λxall (Src 75866588579039 (Let "lam" (Src 75866599063884 (Lam "nam" λxnam (Src 75866605355340 (Lam "bod" λxbod (Src 75866618986828 (Lam "Y" λxY (Src 75866623181132 (Lam "N" λxN (Src 75866627375436 (App (Src 75866628423992 xN) (Src 75866630521163 (App (App (Src 75866631569730 (Book.Kind.lam)) (Src 75866641006918 xnam)) (Src 75866645201226 xbod))))))))))))) λxlam (Src 75866653590751 (Let "app" (Src 75866664075658 (Lam "fun" λxfun (Src 75866670367114 (Lam "arg" λxarg (Src 75866683998602 (Lam "Y" λxY (Src 75866688192906 (Lam "N" λxN (Src 75866692387210 (App (Src 75866693435766 xN) (Src 75866695532937 (App (App (Src 75866696581504 (Book.Kind.app)) (Src 75866706018692 xfun)) (Src 75866710213000 xarg))))))))))))) λxapp (Src 75866718602463 (Let "ann" (Src 75866729087432 (Lam "val" λxval (Src 75866735378888 (Lam "typ" λxtyp (Src 75866749010376 (Lam "Y" λxY (Src 75866753204680 (Lam "N" λxN (Src 75866757398984 (App (Src 75866758447540 xN) (Src 75866760544711 (App (App (Src 75866761593278 (Book.Kind.ann)) (Src 75866771030466 xval)) (Src 75866775224774 xtyp))))))))))))) λxann (Src 75866783614175 (Let "slf" (Src 75866794099206 (Lam "nam" λxnam (Src 75866800390662 (Lam "bod" λxbod (Src 75866814022150 (Lam "Y" λxY (Src 75866818216454 (Lam "N" λxN (Src 75866822410758 (App (Src 75866823459314 xN) (Src 75866825556485 (App (App (Src 75866826605052 (Book.Kind.slf)) (Src 75866836042240 xnam)) (Src 75866840236548 xbod))))))))))))) λxslf (Src 75866848625887 (Let "ins" (Src 75866859110975 (Lam "val" λxval (Src 75866877985343 (Lam "Y" λxY (Src 75866882179647 (Lam "N" λxN (Src 75866886373951 (App (Src 75866887422511 xN) (Src 75866889519678 (App (Src 75866890568249 (Book.Kind.ins)) (Src 75866900005437 xval))))))))))) λxins (Src 75866908394719 (Let "ref" (Src 75866918879869 (Lam "nam" λxnam (Src 75866925171325 (Lam "val" λxval (Src 75866938802813 (Lam "Y" λxY (Src 75866942997117 (Lam "N" λxN (Src 75866947191421 (App (Src 75866948239977 xN) (Src 75866950337148 (App (App (Src 75866951385715 (Book.Kind.ref)) (Src 75866960822903 xnam)) (Src 75866965017211 xval))))))))))))) λxref (Src 75866973406431 (Let "def" (Src 75866983891648 (Lam "nam" λxnam (Src 75866990183104 (Lam "val" λxval (Src 75866996474560 (Lam "bod" λxbod (Src 75867004863168 (Lam "Y" λxY (Src 75867009057472 (Lam "N" λxN (Src 75867013251776 (App (Src 75867014300328 xN) (Src 75867016397503 (App (App (App (Src 75867017446066 (Book.Kind.def)) (Src 75867026883254 xnam)) (Src 75867031077562 xval)) (Src 75867035271870 xbod))))))))))))))) λxdef (Src 75867043661023 (Let "set" (Src 75867071972082 (Lam "Y" λxY (Src 75867076166386 (Lam "N" λxN (Src 75867080360690 (App (Src 75867081409256 xN) (Src 75867083506417 (Book.Kind.set)))))))) λxset (Src 75867096089823 (Let "u60" (Src 75867124400932 (Lam "Y" λxY (Src 75867128595236 (Lam "N" λxN (Src 75867132789540 (App (Src 75867133838106 xN) (Src 75867135935267 (Book.Kind.u60)))))))) λxu60 (Src 75867148518623 (Let "num" (Src 75867159003986 (Lam "val" λxval (Src 75867177878354 (Lam "Y" λxY (Src 75867182072658 (Lam "N" λxN (Src 75867186266962 (App (Src 75867187315533 xY) (Src 75867189412689 xval))))))))) λxnum (Src 75867196753119 (Let "op2" (Src 75867207238549 (Lam "opr" λxopr (Src 75867213530005 (Lam "fst" λxfst (Src 75867219821461 (Lam "snd" λxsnd (Src 75867228210069 (Lam "Y" λxY (Src 75867232404373 (Lam "N" λxN (Src 75867236598677 (App (Src 75867237647229 xN) (Src 75867239744404 (App (App (App (Src 75867240792967 (Book.Kind.op2)) (Src 75867250230155 xopr)) (Src 75867254424463 xfst)) (Src 75867258618771 xsnd))))))))))))))) λxop2 (Src 75867267007711 (Let "mat" (Src 75867277493210 (Lam "nam" λxnam (Src 75867283784666 (Lam "x" λxx (Src 75867287978970 (Lam "z" λxz (Src 75867292173274 (Lam "s" λxs (Src 75867296367578 (Lam "p" λxp (Src 75867300561882 (Lam "Y" λxY (Src 75867304756186 (Lam "N" λxN (Src 75867308950490 (App (Src 75867309999042 xN) (Src 75867312096217 (App (App (App (App (App (Src 75867313144780 (Book.Kind.mat)) (Src 75867322581968 xnam)) (Src 75867326776274 xx)) (Src 75867328873428 xz)) (Src 75867330970582 xs)) (Src 75867333067736 xp))))))))))))))))))) λxmat (Src 75867339359455 (Let "txt" (Src 75867349845011 (Lam "lit" λxlit (Src 75867368719379 (Lam "Y" λxY (Src 75867372913683 (Lam "N" λxN (Src 75867377107987 (App (Src 75867378156547 xN) (Src 75867380253714 (App (Src 75867381302285 (Book.Kind.txt)) (Src 75867390739473 xlit))))))))))) λxtxt (Src 75867399128287 (Let "hol" (Src 75867409613905 (Lam "nam" λxnam (Src 75867415905361 (Lam "ctx" λxctx (Src 75867429536849 (Lam "Y" λxY (Src 75867433731153 (Lam "N" λxN (Src 75867437925457 (App (Src 75867438974013 xN) (Src 75867441071184 (App (App (Src 75867442119751 (Book.Kind.hol)) (Src 75867451556939 xnam)) (Src 75867455751247 xctx))))))))))))) λxhol (Src 75867464139999 (Let "var" (Src 75867474625679 (Lam "nam" λxnam (Src 75867480917135 (Lam "idx" λxidx (Src 75867494548623 (Lam "Y" λxY (Src 75867498742927 (Lam "N" λxN (Src 75867502937231 (App (Src 75867503985787 xN) (Src 75867506082958 (App (App (Src 75867507131525 (Book.Kind.var)) (Src 75867516568713 xnam)) (Src 75867520763021 xidx))))))))))))) λxvar (Src 75867529151711 (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (Src 75867530200216 (Ins (Src 75867531248792 xterm))) (Src 75867536491674 xP)) (Src 75867538588830 xall)) (Src 75867542783138 xlam)) (Src 75867546977446 xapp)) (Src 75867551171754 xann)) (Src 75867555366062 xslf)) (Src 75867559560370 xins)) (Src 75867563754678 xref)) (Src 75867567948986 xdef)) (Src 75867572143294 xset)) (Src 75867576337602 xu60)) (Src 75867580531910 xnum)) (Src 75867584726218 xop2)) (Src 75867588920526 xmat)) (Src 75867593114834 xtxt)) (Src 75867597309142 xhol)) (Src 75867601503450 xvar)) (Src 75867605697756 xY)) (Src 75867607794910 xN))))))))))))))))))))))))))))))))))))))))))))) (Src 75866316996717 (All "term" (Src 75866327482401 (Book.Kind.Term)) λxterm (Src 75866341113965 (All "P" (Src 75866348453933 (Set)) λxP (Src 75866353696877 (All "Y" (Src 75866361036872 (All "val" (Src 75866370474053 (U60)) λxval (Src 75866376765512 xP))) λxY (Src 75866382008429 (All "N" (Src 75866389348456 (All "val" (Src 75866398785637 (Book.Kind.Term)) λxval (Src 75866410319976 xP))) λxN (Src 75866415562861 xP)))))))))))
Book.Kind.if.op2 = (Ref "Kind.if.op2" [] (Ann (Src 100055722755385 (Lam "term" λxterm (Src 100055730095417 (Lam "P" λxP (Src 100055734289721 (Lam "Y" λxY (Src 100055738484025 (Lam "N" λxN (Src 100055744775481 (Let "P" (Src 100055755260197 (Lam "x" λxx (Src 100055759454501 (All "Y" (Src 100055766794500 (All "opr" (Src 100055776231641 (Book.Kind.Oper)) λxopr (Src 100055787766020 (All "fst" (Src 100055797203181 (Book.Kind.Term)) λxfst (Src 100055808737540 (All "snd" (Src 100055818174721 (Book.Kind.Term)) λxsnd (Src 100055829709060 xP))))))) λxY (Src 100055832854821 (All "N" (Src 100055840194850 (All "val" (Src 100055849632031 (Book.Kind.Term)) λxval (Src 100055861166370 xP))) λxN (Src 100055864312101 xP))))))) λxP (Src 100055868507449 (Let "all" (Src 100055878992232 (Lam "nam" λxnam (Src 100055885283688 (Lam "inp" λxinp (Src 100055891575144 (Lam "bod" λxbod (Src 100055899963752 (Lam "Y" λxY (Src 100055904158056 (Lam "N" λxN (Src 100055908352360 (App (Src 100055909400912 xN) (Src 100055911498087 (App (App (App (Src 100055912546650 (Book.Kind.all)) (Src 100055921983838 xnam)) (Src 100055926178146 xinp)) (Src 100055930372454 xbod))))))))))))))) λxall (Src 100055938762041 (Let "lam" (Src 100055949246886 (Lam "nam" λxnam (Src 100055955538342 (Lam "bod" λxbod (Src 100055969169830 (Lam "Y" λxY (Src 100055973364134 (Lam "N" λxN (Src 100055977558438 (App (Src 100055978606994 xN) (Src 100055980704165 (App (App (Src 100055981752732 (Book.Kind.lam)) (Src 100055991189920 xnam)) (Src 100055995384228 xbod))))))))))))) λxlam (Src 100056003773753 (Let "app" (Src 100056014258660 (Lam "fun" λxfun (Src 100056020550116 (Lam "arg" λxarg (Src 100056034181604 (Lam "Y" λxY (Src 100056038375908 (Lam "N" λxN (Src 100056042570212 (App (Src 100056043618768 xN) (Src 100056045715939 (App (App (Src 100056046764506 (Book.Kind.app)) (Src 100056056201694 xfun)) (Src 100056060396002 xarg))))))))))))) λxapp (Src 100056068785465 (Let "ann" (Src 100056079270434 (Lam "val" λxval (Src 100056085561890 (Lam "typ" λxtyp (Src 100056099193378 (Lam "Y" λxY (Src 100056103387682 (Lam "N" λxN (Src 100056107581986 (App (Src 100056108630542 xN) (Src 100056110727713 (App (App (Src 100056111776280 (Book.Kind.ann)) (Src 100056121213468 xval)) (Src 100056125407776 xtyp))))))))))))) λxann (Src 100056133797177 (Let "slf" (Src 100056144282208 (Lam "nam" λxnam (Src 100056150573664 (Lam "bod" λxbod (Src 100056164205152 (Lam "Y" λxY (Src 100056168399456 (Lam "N" λxN (Src 100056172593760 (App (Src 100056173642316 xN) (Src 100056175739487 (App (App (Src 100056176788054 (Book.Kind.slf)) (Src 100056186225242 xnam)) (Src 100056190419550 xbod))))))))))))) λxslf (Src 100056198808889 (Let "ins" (Src 100056209293977 (Lam "val" λxval (Src 100056228168345 (Lam "Y" λxY (Src 100056232362649 (Lam "N" λxN (Src 100056236556953 (App (Src 100056237605513 xN) (Src 100056239702680 (App (Src 100056240751251 (Book.Kind.ins)) (Src 100056250188439 xval))))))))))) λxins (Src 100056258577721 (Let "ref" (Src 100056269062871 (Lam "nam" λxnam (Src 100056275354327 (Lam "val" λxval (Src 100056288985815 (Lam "Y" λxY (Src 100056293180119 (Lam "N" λxN (Src 100056297374423 (App (Src 100056298422979 xN) (Src 100056300520150 (App (App (Src 100056301568717 (Book.Kind.ref)) (Src 100056311005905 xnam)) (Src 100056315200213 xval))))))))))))) λxref (Src 100056323589433 (Let "def" (Src 100056334074650 (Lam "nam" λxnam (Src 100056340366106 (Lam "val" λxval (Src 100056346657562 (Lam "bod" λxbod (Src 100056355046170 (Lam "Y" λxY (Src 100056359240474 (Lam "N" λxN (Src 100056363434778 (App (Src 100056364483330 xN) (Src 100056366580505 (App (App (App (Src 100056367629068 (Book.Kind.def)) (Src 100056377066256 xnam)) (Src 100056381260564 xval)) (Src 100056385454872 xbod))))))))))))))) λxdef (Src 100056393844025 (Let "set" (Src 100056422155084 (Lam "Y" λxY (Src 100056426349388 (Lam "N" λxN (Src 100056430543692 (App (Src 100056431592258 xN) (Src 100056433689419 (Book.Kind.set)))))))) λxset (Src 100056446272825 (Let "u60" (Src 100056474583934 (Lam "Y" λxY (Src 100056478778238 (Lam "N" λxN (Src 100056482972542 (App (Src 100056484021108 xN) (Src 100056486118269 (Book.Kind.u60)))))))) λxu60 (Src 100056498701625 (Let "num" (Src 100056509186999 (Lam "val" λxval (Src 100056528061367 (Lam "Y" λxY (Src 100056532255671 (Lam "N" λxN (Src 100056536449975 (App (Src 100056537498535 xN) (Src 100056539595702 (App (Src 100056540644273 (Book.Kind.num)) (Src 100056550081461 xval))))))))))) λxnum (Src 100056558470457 (Let "op2" (Src 100056568955887 (Lam "opr" λxopr (Src 100056575247343 (Lam "fst" λxfst (Src 100056581538799 (Lam "snd" λxsnd (Src 100056589927407 (Lam "Y" λxY (Src 100056594121711 (Lam "N" λxN (Src 100056598316015 (App (App (App (Src 100056599364578 xY) (Src 100056601461734 xopr)) (Src 100056605656042 xfst)) (Src 100056609850350 xsnd))))))))))))) λxop2 (Src 100056617190713 (Let "mat" (Src 100056627676212 (Lam "nam" λxnam (Src 100056633967668 (Lam "x" λxx (Src 100056638161972 (Lam "z" λxz (Src 100056642356276 (Lam "s" λxs (Src 100056646550580 (Lam "p" λxp (Src 100056650744884 (Lam "Y" λxY (Src 100056654939188 (Lam "N" λxN (Src 100056659133492 (App (Src 100056660182044 xN) (Src 100056662279219 (App (App (App (App (App (Src 100056663327782 (Book.Kind.mat)) (Src 100056672764970 xnam)) (Src 100056676959276 xx)) (Src 100056679056430 xz)) (Src 100056681153584 xs)) (Src 100056683250738 xp))))))))))))))))))) λxmat (Src 100056689542457 (Let "txt" (Src 100056700028013 (Lam "lit" λxlit (Src 100056718902381 (Lam "Y" λxY (Src 100056723096685 (Lam "N" λxN (Src 100056727290989 (App (Src 100056728339549 xN) (Src 100056730436716 (App (Src 100056731485287 (Book.Kind.txt)) (Src 100056740922475 xlit))))))))))) λxtxt (Src 100056749311289 (Let "hol" (Src 100056759796907 (Lam "nam" λxnam (Src 100056766088363 (Lam "ctx" λxctx (Src 100056779719851 (Lam "Y" λxY (Src 100056783914155 (Lam "N" λxN (Src 100056788108459 (App (Src 100056789157015 xN) (Src 100056791254186 (App (App (Src 100056792302753 (Book.Kind.hol)) (Src 100056801739941 xnam)) (Src 100056805934249 xctx))))))))))))) λxhol (Src 100056814323001 (Let "var" (Src 100056824808681 (Lam "nam" λxnam (Src 100056831100137 (Lam "idx" λxidx (Src 100056844731625 (Lam "Y" λxY (Src 100056848925929 (Lam "N" λxN (Src 100056853120233 (App (Src 100056854168789 xN) (Src 100056856265960 (App (App (Src 100056857314527 (Book.Kind.var)) (Src 100056866751715 xnam)) (Src 100056870946023 xidx))))))))))))) λxvar (Src 100056879334713 (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (Src 100056880383218 (Ins (Src 100056881431794 xterm))) (Src 100056886674676 xP)) (Src 100056888771832 xall)) (Src 100056892966140 xlam)) (Src 100056897160448 xapp)) (Src 100056901354756 xann)) (Src 100056905549064 xslf)) (Src 100056909743372 xins)) (Src 100056913937680 xref)) (Src 100056918131988 xdef)) (Src 100056922326296 xset)) (Src 100056926520604 xu60)) (Src 100056930714912 xnum)) (Src 100056934909220 xop2)) (Src 100056939103528 xmat)) (Src 100056943297836 xtxt)) (Src 100056947492144 xhol)) (Src 100056951686452 xvar)) (Src 100056955880758 xY)) (Src 100056957977912 xN))))))))))))))))))))))))))))))))))))))))))))) (Src 100055572807834 (All "term" (Src 100055583293473 (Book.Kind.Term)) λxterm (Src 100055596925082 (All "P" (Src 100055604265005 (Set)) λxP (Src 100055609507994 (All "Y" (Src 100055616847989 (All "opr" (Src 100055626285130 (Book.Kind.Oper)) λxopr (Src 100055637819509 (All "fst" (Src 100055647256670 (Book.Kind.Term)) λxfst (Src 100055658791029 (All "snd" (Src 100055668228210 (Book.Kind.Term)) λxsnd (Src 100055679762549 xP))))))) λxY (Src 100055685005466 (All "N" (Src 100055692345493 (All "val" (Src 100055701782674 (Book.Kind.Term)) λxval (Src 100055713317013 xP))) λxN (Src 100055718559898 xP)))))))))))
Book.Kind.if.ref = (Ref "Kind.if.ref" [] (Ann (Src 101155210265867 (Lam "term" λxterm (Src 101155217605899 (Lam "P" λxP (Src 101155221800203 (Lam "Y" λxY (Src 101155225994507 (Lam "N" λxN (Src 101155232285963 (Let "P" (Src 101155242770679 (Lam "x" λxx (Src 101155246964983 (All "Y" (Src 101155254304982 (All "nam" (Src 101155263742143 (Book.String)) λxnam (Src 101155272130774 (All "val" (Src 101155281567955 (Book.Kind.Term)) λxval (Src 101155293102294 xP))))) λxY (Src 101155296248055 (All "N" (Src 101155303588084 (All "val" (Src 101155313025265 (Book.Kind.Term)) λxval (Src 101155324559604 xP))) λxN (Src 101155327705335 xP))))))) λxP (Src 101155331900683 (Let "all" (Src 101155342385466 (Lam "nam" λxnam (Src 101155348676922 (Lam "inp" λxinp (Src 101155354968378 (Lam "bod" λxbod (Src 101155363356986 (Lam "Y" λxY (Src 101155367551290 (Lam "N" λxN (Src 101155371745594 (App (Src 101155372794146 xN) (Src 101155374891321 (App (App (App (Src 101155375939884 (Book.Kind.all)) (Src 101155385377072 xnam)) (Src 101155389571380 xinp)) (Src 101155393765688 xbod))))))))))))))) λxall (Src 101155402155275 (Let "lam" (Src 101155412640120 (Lam "nam" λxnam (Src 101155418931576 (Lam "bod" λxbod (Src 101155432563064 (Lam "Y" λxY (Src 101155436757368 (Lam "N" λxN (Src 101155440951672 (App (Src 101155442000228 xN) (Src 101155444097399 (App (App (Src 101155445145966 (Book.Kind.lam)) (Src 101155454583154 xnam)) (Src 101155458777462 xbod))))))))))))) λxlam (Src 101155467166987 (Let "app" (Src 101155477651894 (Lam "fun" λxfun (Src 101155483943350 (Lam "arg" λxarg (Src 101155497574838 (Lam "Y" λxY (Src 101155501769142 (Lam "N" λxN (Src 101155505963446 (App (Src 101155507012002 xN) (Src 101155509109173 (App (App (Src 101155510157740 (Book.Kind.app)) (Src 101155519594928 xfun)) (Src 101155523789236 xarg))))))))))))) λxapp (Src 101155532178699 (Let "ann" (Src 101155542663668 (Lam "val" λxval (Src 101155548955124 (Lam "typ" λxtyp (Src 101155562586612 (Lam "Y" λxY (Src 101155566780916 (Lam "N" λxN (Src 101155570975220 (App (Src 101155572023776 xN) (Src 101155574120947 (App (App (Src 101155575169514 (Book.Kind.ann)) (Src 101155584606702 xval)) (Src 101155588801010 xtyp))))))))))))) λxann (Src 101155597190411 (Let "slf" (Src 101155607675442 (Lam "nam" λxnam (Src 101155613966898 (Lam "bod" λxbod (Src 101155627598386 (Lam "Y" λxY (Src 101155631792690 (Lam "N" λxN (Src 101155635986994 (App (Src 101155637035550 xN) (Src 101155639132721 (App (App (Src 101155640181288 (Book.Kind.slf)) (Src 101155649618476 xnam)) (Src 101155653812784 xbod))))))))))))) λxslf (Src 101155662202123 (Let "ins" (Src 101155672687211 (Lam "val" λxval (Src 101155691561579 (Lam "Y" λxY (Src 101155695755883 (Lam "N" λxN (Src 101155699950187 (App (Src 101155700998747 xN) (Src 101155703095914 (App (Src 101155704144485 (Book.Kind.ins)) (Src 101155713581673 xval))))))))))) λxins (Src 101155721970955 (Let "ref" (Src 101155732456094 (Lam "nam" λxnam (Src 101155738747550 (Lam "val" λxval (Src 101155752379038 (Lam "Y" λxY (Src 101155756573342 (Lam "N" λxN (Src 101155760767646 (App (App (Src 101155761816213 xY) (Src 101155763913369 xnam)) (Src 101155768107677 xval))))))))))) λxref (Src 101155775448331 (Let "def" (Src 101155785933537 (Lam "nam" λxnam (Src 101155792224993 (Lam "val" λxval (Src 101155798516449 (Lam "bod" λxbod (Src 101155806905057 (Lam "Y" λxY (Src 101155811099361 (Lam "N" λxN (Src 101155815293665 (App (Src 101155816342217 xN) (Src 101155818439392 (App (App (App (Src 101155819487955 (Book.Kind.def)) (Src 101155828925143 xnam)) (Src 101155833119451 xval)) (Src 101155837313759 xbod))))))))))))))) λxdef (Src 101155845702923 (Let "set" (Src 101155874013971 (Lam "Y" λxY (Src 101155878208275 (Lam "N" λxN (Src 101155882402579 (App (Src 101155883451145 xN) (Src 101155885548306 (Book.Kind.set)))))))) λxset (Src 101155898131723 (Let "u60" (Src 101155926442821 (Lam "Y" λxY (Src 101155930637125 (Lam "N" λxN (Src 101155934831429 (App (Src 101155935879995 xN) (Src 101155937977156 (Book.Kind.u60)))))))) λxu60 (Src 101155950560523 (Let "num" (Src 101155961045886 (Lam "val" λxval (Src 101155979920254 (Lam "Y" λxY (Src 101155984114558 (Lam "N" λxN (Src 101155988308862 (App (Src 101155989357422 xN) (Src 101155991454589 (App (Src 101155992503160 (Book.Kind.num)) (Src 101156001940348 xval))))))))))) λxnum (Src 101156010329355 (Let "op2" (Src 101156020814785 (Lam "opr" λxopr (Src 101156027106241 (Lam "fst" λxfst (Src 101156033397697 (Lam "snd" λxsnd (Src 101156041786305 (Lam "Y" λxY (Src 101156045980609 (Lam "N" λxN (Src 101156050174913 (App (Src 101156051223465 xN) (Src 101156053320640 (App (App (App (Src 101156054369203 (Book.Kind.op2)) (Src 101156063806391 xopr)) (Src 101156068000699 xfst)) (Src 101156072195007 xsnd))))))))))))))) λxop2 (Src 101156080583947 (Let "mat" (Src 101156091069446 (Lam "nam" λxnam (Src 101156097360902 (Lam "x" λxx (Src 101156101555206 (Lam "z" λxz (Src 101156105749510 (Lam "s" λxs (Src 101156109943814 (Lam "p" λxp (Src 101156114138118 (Lam "Y" λxY (Src 101156118332422 (Lam "N" λxN (Src 101156122526726 (App (Src 101156123575278 xN) (Src 101156125672453 (App (App (App (App (App (Src 101156126721016 (Book.Kind.mat)) (Src 101156136158204 xnam)) (Src 101156140352510 xx)) (Src 101156142449664 xz)) (Src 101156144546818 xs)) (Src 101156146643972 xp))))))))))))))))))) λxmat (Src 101156152935691 (Let "txt" (Src 101156163421247 (Lam "lit" λxlit (Src 101156182295615 (Lam "Y" λxY (Src 101156186489919 (Lam "N" λxN (Src 101156190684223 (App (Src 101156191732783 xN) (Src 101156193829950 (App (Src 101156194878521 (Book.Kind.txt)) (Src 101156204315709 xlit))))))))))) λxtxt (Src 101156212704523 (Let "hol" (Src 101156223190141 (Lam "nam" λxnam (Src 101156229481597 (Lam "ctx" λxctx (Src 101156243113085 (Lam "Y" λxY (Src 101156247307389 (Lam "N" λxN (Src 101156251501693 (App (Src 101156252550249 xN) (Src 101156254647420 (App (App (Src 101156255695987 (Book.Kind.hol)) (Src 101156265133175 xnam)) (Src 101156269327483 xctx))))))))))))) λxhol (Src 101156277716235 (Let "var" (Src 101156288201915 (Lam "nam" λxnam (Src 101156294493371 (Lam "idx" λxidx (Src 101156308124859 (Lam "Y" λxY (Src 101156312319163 (Lam "N" λxN (Src 101156316513467 (App (Src 101156317562023 xN) (Src 101156319659194 (App (App (Src 101156320707761 (Book.Kind.var)) (Src 101156330144949 xnam)) (Src 101156334339257 xidx))))))))))))) λxvar (Src 101156342727947 (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (Src 101156343776452 (Ins (Src 101156344825028 xterm))) (Src 101156350067910 xP)) (Src 101156352165066 xall)) (Src 101156356359374 xlam)) (Src 101156360553682 xapp)) (Src 101156364747990 xann)) (Src 101156368942298 xslf)) (Src 101156373136606 xins)) (Src 101156377330914 xref)) (Src 101156381525222 xdef)) (Src 101156385719530 xset)) (Src 101156389913838 xu60)) (Src 101156394108146 xnum)) (Src 101156398302454 xop2)) (Src 101156402496762 xmat)) (Src 101156406691070 xtxt)) (Src 101156410885378 xhol)) (Src 101156415079686 xvar)) (Src 101156419273992 xY)) (Src 101156421371146 xN))))))))))))))))))))))))))))))))))))))))))))) (Src 101155084435587 (All "term" (Src 101155094921249 (Book.Kind.Term)) λxterm (Src 101155108552835 (All "P" (Src 101155115892781 (Set)) λxP (Src 101155121135747 (All "Y" (Src 101155128475742 (All "nam" (Src 101155137912903 (Book.String)) λxnam (Src 101155146301534 (All "val" (Src 101155155738715 (Book.Kind.Term)) λxval (Src 101155167273054 xP))))) λxY (Src 101155172515971 (All "N" (Src 101155179855998 (All "val" (Src 101155189293179 (Book.Kind.Term)) λxval (Src 101155200827518 xP))) λxN (Src 101155206070403 xP)))))))))))
Book.Kind.if.set = (Ref "Kind.if.set" [] (Ann (Src 102254683096259 (Lam "term" λxterm (Src 102254690436291 (Lam "P" λxP (Src 102254694630595 (Lam "Y" λxY (Src 102254698824899 (Lam "N" λxN (Src 102254705116355 (Let "P" (Src 102254715601069 (Lam "x" λxx (Src 102254719795373 (All "Y" (Src 102254727135372 xP) λxY (Src 102254730281133 (All "N" (Src 102254737621162 (All "val" (Src 102254747058343 (Book.Kind.Term)) λxval (Src 102254758592682 xP))) λxN (Src 102254761738413 xP))))))) λxP (Src 102254765933763 (Let "all" (Src 102254776418544 (Lam "nam" λxnam (Src 102254782710000 (Lam "inp" λxinp (Src 102254789001456 (Lam "bod" λxbod (Src 102254797390064 (Lam "Y" λxY (Src 102254801584368 (Lam "N" λxN (Src 102254805778672 (App (Src 102254806827224 xN) (Src 102254808924399 (App (App (App (Src 102254809972962 (Book.Kind.all)) (Src 102254819410150 xnam)) (Src 102254823604458 xinp)) (Src 102254827798766 xbod))))))))))))))) λxall (Src 102254836188355 (Let "lam" (Src 102254846673198 (Lam "nam" λxnam (Src 102254852964654 (Lam "bod" λxbod (Src 102254866596142 (Lam "Y" λxY (Src 102254870790446 (Lam "N" λxN (Src 102254874984750 (App (Src 102254876033306 xN) (Src 102254878130477 (App (App (Src 102254879179044 (Book.Kind.lam)) (Src 102254888616232 xnam)) (Src 102254892810540 xbod))))))))))))) λxlam (Src 102254901200067 (Let "app" (Src 102254911684972 (Lam "fun" λxfun (Src 102254917976428 (Lam "arg" λxarg (Src 102254931607916 (Lam "Y" λxY (Src 102254935802220 (Lam "N" λxN (Src 102254939996524 (App (Src 102254941045080 xN) (Src 102254943142251 (App (App (Src 102254944190818 (Book.Kind.app)) (Src 102254953628006 xfun)) (Src 102254957822314 xarg))))))))))))) λxapp (Src 102254966211779 (Let "ann" (Src 102254976696746 (Lam "val" λxval (Src 102254982988202 (Lam "typ" λxtyp (Src 102254996619690 (Lam "Y" λxY (Src 102255000813994 (Lam "N" λxN (Src 102255005008298 (App (Src 102255006056854 xN) (Src 102255008154025 (App (App (Src 102255009202592 (Book.Kind.ann)) (Src 102255018639780 xval)) (Src 102255022834088 xtyp))))))))))))) λxann (Src 102255031223491 (Let "slf" (Src 102255041708520 (Lam "nam" λxnam (Src 102255047999976 (Lam "bod" λxbod (Src 102255061631464 (Lam "Y" λxY (Src 102255065825768 (Lam "N" λxN (Src 102255070020072 (App (Src 102255071068628 xN) (Src 102255073165799 (App (App (Src 102255074214366 (Book.Kind.slf)) (Src 102255083651554 xnam)) (Src 102255087845862 xbod))))))))))))) λxslf (Src 102255096235203 (Let "ins" (Src 102255106720289 (Lam "val" λxval (Src 102255125594657 (Lam "Y" λxY (Src 102255129788961 (Lam "N" λxN (Src 102255133983265 (App (Src 102255135031825 xN) (Src 102255137128992 (App (Src 102255138177563 (Book.Kind.ins)) (Src 102255147614751 xval))))))))))) λxins (Src 102255156004035 (Let "ref" (Src 102255166489183 (Lam "nam" λxnam (Src 102255172780639 (Lam "val" λxval (Src 102255186412127 (Lam "Y" λxY (Src 102255190606431 (Lam "N" λxN (Src 102255194800735 (App (Src 102255195849291 xN) (Src 102255197946462 (App (App (Src 102255198995029 (Book.Kind.ref)) (Src 102255208432217 xnam)) (Src 102255212626525 xval))))))))))))) λxref (Src 102255221015747 (Let "def" (Src 102255231500962 (Lam "nam" λxnam (Src 102255237792418 (Lam "val" λxval (Src 102255244083874 (Lam "bod" λxbod (Src 102255252472482 (Lam "Y" λxY (Src 102255256666786 (Lam "N" λxN (Src 102255260861090 (App (Src 102255261909642 xN) (Src 102255264006817 (App (App (App (Src 102255265055380 (Book.Kind.def)) (Src 102255274492568 xnam)) (Src 102255278686876 xval)) (Src 102255282881184 xbod))))))))))))))) λxdef (Src 102255291270339 (Let "set" (Src 102255319581387 (Lam "Y" λxY (Src 102255323775691 (Lam "N" λxN (Src 102255327969995 (Src 102255329018570 xY)))))) λxset (Src 102255334261955 (Let "u60" (Src 102255362573053 (Lam "Y" λxY (Src 102255366767357 (Lam "N" λxN (Src 102255370961661 (App (Src 102255372010227 xN) (Src 102255374107388 (Book.Kind.u60)))))))) λxu60 (Src 102255386690755 (Let "num" (Src 102255397176118 (Lam "val" λxval (Src 102255416050486 (Lam "Y" λxY (Src 102255420244790 (Lam "N" λxN (Src 102255424439094 (App (Src 102255425487654 xN) (Src 102255427584821 (App (Src 102255428633392 (Book.Kind.num)) (Src 102255438070580 xval))))))))))) λxnum (Src 102255446459587 (Let "op2" (Src 102255456945017 (Lam "opr" λxopr (Src 102255463236473 (Lam "fst" λxfst (Src 102255469527929 (Lam "snd" λxsnd (Src 102255477916537 (Lam "Y" λxY (Src 102255482110841 (Lam "N" λxN (Src 102255486305145 (App (Src 102255487353697 xN) (Src 102255489450872 (App (App (App (Src 102255490499435 (Book.Kind.op2)) (Src 102255499936623 xopr)) (Src 102255504130931 xfst)) (Src 102255508325239 xsnd))))))))))))))) λxop2 (Src 102255516714179 (Let "mat" (Src 102255527199678 (Lam "nam" λxnam (Src 102255533491134 (Lam "x" λxx (Src 102255537685438 (Lam "z" λxz (Src 102255541879742 (Lam "s" λxs (Src 102255546074046 (Lam "p" λxp (Src 102255550268350 (Lam "Y" λxY (Src 102255554462654 (Lam "N" λxN (Src 102255558656958 (App (Src 102255559705510 xN) (Src 102255561802685 (App (App (App (App (App (Src 102255562851248 (Book.Kind.mat)) (Src 102255572288436 xnam)) (Src 102255576482742 xx)) (Src 102255578579896 xz)) (Src 102255580677050 xs)) (Src 102255582774204 xp))))))))))))))))))) λxmat (Src 102255589065923 (Let "txt" (Src 102255599551479 (Lam "lit" λxlit (Src 102255618425847 (Lam "Y" λxY (Src 102255622620151 (Lam "N" λxN (Src 102255626814455 (App (Src 102255627863015 xN) (Src 102255629960182 (App (Src 102255631008753 (Book.Kind.txt)) (Src 102255640445941 xlit))))))))))) λxtxt (Src 102255648834755 (Let "hol" (Src 102255659320373 (Lam "nam" λxnam (Src 102255665611829 (Lam "ctx" λxctx (Src 102255679243317 (Lam "Y" λxY (Src 102255683437621 (Lam "N" λxN (Src 102255687631925 (App (Src 102255688680481 xN) (Src 102255690777652 (App (App (Src 102255691826219 (Book.Kind.hol)) (Src 102255701263407 xnam)) (Src 102255705457715 xctx))))))))))))) λxhol (Src 102255713846467 (Let "var" (Src 102255724332147 (Lam "nam" λxnam (Src 102255730623603 (Lam "idx" λxidx (Src 102255744255091 (Lam "Y" λxY (Src 102255748449395 (Lam "N" λxN (Src 102255752643699 (App (Src 102255753692255 xN) (Src 102255755789426 (App (App (Src 102255756837993 (Book.Kind.var)) (Src 102255766275181 xnam)) (Src 102255770469489 xidx))))))))))))) λxvar (Src 102255778858179 (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (Src 102255779906684 (Ins (Src 102255780955260 xterm))) (Src 102255786198142 xP)) (Src 102255788295298 xall)) (Src 102255792489606 xlam)) (Src 102255796683914 xapp)) (Src 102255800878222 xann)) (Src 102255805072530 xslf)) (Src 102255809266838 xins)) (Src 102255813461146 xref)) (Src 102255817655454 xdef)) (Src 102255821849762 xset)) (Src 102255826044070 xu60)) (Src 102255830238378 xnum)) (Src 102255834432686 xop2)) (Src 102255838626994 xmat)) (Src 102255842821302 xtxt)) (Src 102255847015610 xhol)) (Src 102255851209918 xvar)) (Src 102255855404224 xY)) (Src 102255857501378 xN))))))))))))))))))))))))))))))))))))))))))))) (Src 102254596063326 (All "term" (Src 102254606549025 (Book.Kind.Term)) λxterm (Src 102254620180574 (All "P" (Src 102254627520557 (Set)) λxP (Src 102254632763486 (All "Y" (Src 102254640103481 xP) λxY (Src 102254645346398 (All "N" (Src 102254652686425 (All "val" (Src 102254662123606 (Book.Kind.Term)) λxval (Src 102254673657945 xP))) λxN (Src 102254678900830 xP)))))))))))
Book.Kind.if.slf = (Ref "Kind.if.slf" [] (Ann (Src 68169880306991 (Lam "term" λxterm (Src 68169887647023 (Lam "P" λxP (Src 68169891841327 (Lam "Y" λxY (Src 68169896035631 (Lam "N" λxN (Src 68169902327087 (Let "P" (Src 68169912811803 (Lam "x" λxx (Src 68169917006107 (All "Y" (Src 68169924346106 (All "nam" (Src 68169933783249 (Book.String)) λxnam (Src 68169942171898 (All "bod" (Src 68169951609079 (All "x" (Src 68169958949100 (Book.Kind.Term)) λxx (Src 68169970483447 (Book.Kind.Term)))) λxbod (Src 68169982017786 xP))))) λxY (Src 68169985163547 (All "N" (Src 68169992503576 (All "val" (Src 68170001940757 (Book.Kind.Term)) λxval (Src 68170013475096 xP))) λxN (Src 68170016620827 xP))))))) λxP (Src 68170020816175 (Let "all" (Src 68170031300958 (Lam "nam" λxnam (Src 68170037592414 (Lam "inp" λxinp (Src 68170043883870 (Lam "bod" λxbod (Src 68170052272478 (Lam "Y" λxY (Src 68170056466782 (Lam "N" λxN (Src 68170060661086 (App (Src 68170061709638 xN) (Src 68170063806813 (App (App (App (Src 68170064855376 (Book.Kind.all)) (Src 68170074292564 xnam)) (Src 68170078486872 xinp)) (Src 68170082681180 xbod))))))))))))))) λxall (Src 68170091070767 (Let "lam" (Src 68170101555612 (Lam "nam" λxnam (Src 68170107847068 (Lam "bod" λxbod (Src 68170121478556 (Lam "Y" λxY (Src 68170125672860 (Lam "N" λxN (Src 68170129867164 (App (Src 68170130915720 xN) (Src 68170133012891 (App (App (Src 68170134061458 (Book.Kind.lam)) (Src 68170143498646 xnam)) (Src 68170147692954 xbod))))))))))))) λxlam (Src 68170156082479 (Let "app" (Src 68170166567386 (Lam "fun" λxfun (Src 68170172858842 (Lam "arg" λxarg (Src 68170186490330 (Lam "Y" λxY (Src 68170190684634 (Lam "N" λxN (Src 68170194878938 (App (Src 68170195927494 xN) (Src 68170198024665 (App (App (Src 68170199073232 (Book.Kind.app)) (Src 68170208510420 xfun)) (Src 68170212704728 xarg))))))))))))) λxapp (Src 68170221094191 (Let "ann" (Src 68170231579160 (Lam "val" λxval (Src 68170237870616 (Lam "typ" λxtyp (Src 68170251502104 (Lam "Y" λxY (Src 68170255696408 (Lam "N" λxN (Src 68170259890712 (App (Src 68170260939268 xN) (Src 68170263036439 (App (App (Src 68170264085006 (Book.Kind.ann)) (Src 68170273522194 xval)) (Src 68170277716502 xtyp))))))))))))) λxann (Src 68170286105903 (Let "slf" (Src 68170296590923 (Lam "nam" λxnam (Src 68170302882379 (Lam "bod" λxbod (Src 68170316513867 (Lam "Y" λxY (Src 68170320708171 (Lam "N" λxN (Src 68170324902475 (App (App (Src 68170325951042 xY) (Src 68170328048198 xnam)) (Src 68170332242506 xbod))))))))))) λxslf (Src 68170339583279 (Let "ins" (Src 68170350068356 (Lam "val" λxval (Src 68170368942724 (Lam "Y" λxY (Src 68170373137028 (Lam "N" λxN (Src 68170377331332 (App (Src 68170378379892 xN) (Src 68170380477059 (App (Src 68170381525630 (Book.Kind.ins)) (Src 68170390962818 xval))))))))))) λxins (Src 68170399352111 (Let "ref" (Src 68170409837250 (Lam "nam" λxnam (Src 68170416128706 (Lam "val" λxval (Src 68170429760194 (Lam "Y" λxY (Src 68170433954498 (Lam "N" λxN (Src 68170438148802 (App (Src 68170439197358 xN) (Src 68170441294529 (App (App (Src 68170442343096 (Book.Kind.ref)) (Src 68170451780284 xnam)) (Src 68170455974592 xval))))))))))))) λxref (Src 68170464363823 (Let "def" (Src 68170474849029 (Lam "nam" λxnam (Src 68170481140485 (Lam "val" λxval (Src 68170487431941 (Lam "bod" λxbod (Src 68170495820549 (Lam "Y" λxY (Src 68170500014853 (Lam "N" λxN (Src 68170504209157 (App (Src 68170505257709 xN) (Src 68170507354884 (App (App (App (Src 68170508403447 (Book.Kind.def)) (Src 68170517840635 xnam)) (Src 68170522034943 xval)) (Src 68170526229251 xbod))))))))))))))) λxdef (Src 68170534618415 (Let "set" (Src 68170562929463 (Lam "Y" λxY (Src 68170567123767 (Lam "N" λxN (Src 68170571318071 (App (Src 68170572366637 xN) (Src 68170574463798 (Book.Kind.set)))))))) λxset (Src 68170587047215 (Let "u60" (Src 68170615358313 (Lam "Y" λxY (Src 68170619552617 (Lam "N" λxN (Src 68170623746921 (App (Src 68170624795487 xN) (Src 68170626892648 (Book.Kind.u60)))))))) λxu60 (Src 68170639476015 (Let "num" (Src 68170649961378 (Lam "val" λxval (Src 68170668835746 (Lam "Y" λxY (Src 68170673030050 (Lam "N" λxN (Src 68170677224354 (App (Src 68170678272914 xN) (Src 68170680370081 (App (Src 68170681418652 (Book.Kind.num)) (Src 68170690855840 xval))))))))))) λxnum (Src 68170699244847 (Let "op2" (Src 68170709730277 (Lam "opr" λxopr (Src 68170716021733 (Lam "fst" λxfst (Src 68170722313189 (Lam "snd" λxsnd (Src 68170730701797 (Lam "Y" λxY (Src 68170734896101 (Lam "N" λxN (Src 68170739090405 (App (Src 68170740138957 xN) (Src 68170742236132 (App (App (App (Src 68170743284695 (Book.Kind.op2)) (Src 68170752721883 xopr)) (Src 68170756916191 xfst)) (Src 68170761110499 xsnd))))))))))))))) λxop2 (Src 68170769499439 (Let "mat" (Src 68170779984938 (Lam "nam" λxnam (Src 68170786276394 (Lam "x" λxx (Src 68170790470698 (Lam "z" λxz (Src 68170794665002 (Lam "s" λxs (Src 68170798859306 (Lam "p" λxp (Src 68170803053610 (Lam "Y" λxY (Src 68170807247914 (Lam "N" λxN (Src 68170811442218 (App (Src 68170812490770 xN) (Src 68170814587945 (App (App (App (App (App (Src 68170815636508 (Book.Kind.mat)) (Src 68170825073696 xnam)) (Src 68170829268002 xx)) (Src 68170831365156 xz)) (Src 68170833462310 xs)) (Src 68170835559464 xp))))))))))))))))))) λxmat (Src 68170841851183 (Let "txt" (Src 68170852336739 (Lam "lit" λxlit (Src 68170871211107 (Lam "Y" λxY (Src 68170875405411 (Lam "N" λxN (Src 68170879599715 (App (Src 68170880648275 xN) (Src 68170882745442 (App (Src 68170883794013 (Book.Kind.txt)) (Src 68170893231201 xlit))))))))))) λxtxt (Src 68170901620015 (Let "hol" (Src 68170912105633 (Lam "nam" λxnam (Src 68170918397089 (Lam "ctx" λxctx (Src 68170932028577 (Lam "Y" λxY (Src 68170936222881 (Lam "N" λxN (Src 68170940417185 (App (Src 68170941465741 xN) (Src 68170943562912 (App (App (Src 68170944611479 (Book.Kind.hol)) (Src 68170954048667 xnam)) (Src 68170958242975 xctx))))))))))))) λxhol (Src 68170966631727 (Let "var" (Src 68170977117407 (Lam "nam" λxnam (Src 68170983408863 (Lam "idx" λxidx (Src 68170997040351 (Lam "Y" λxY (Src 68171001234655 (Lam "N" λxN (Src 68171005428959 (App (Src 68171006477515 xN) (Src 68171008574686 (App (App (Src 68171009623253 (Book.Kind.var)) (Src 68171019060441 xnam)) (Src 68171023254749 xidx))))))))))))) λxvar (Src 68171031643439 (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (Src 68171032691944 (Ins (Src 68171033740520 xterm))) (Src 68171038983402 xP)) (Src 68171041080558 xall)) (Src 68171045274866 xlam)) (Src 68171049469174 xapp)) (Src 68171053663482 xann)) (Src 68171057857790 xslf)) (Src 68171062052098 xins)) (Src 68171066246406 xref)) (Src 68171070440714 xdef)) (Src 68171074635022 xset)) (Src 68171078829330 xu60)) (Src 68171083023638 xnum)) (Src 68171087217946 xop2)) (Src 68171091412254 xmat)) (Src 68171095606562 xtxt)) (Src 68171099800870 xhol)) (Src 68171103995178 xvar)) (Src 68171108189484 xY)) (Src 68171110286638 xN))))))))))))))))))))))))))))))))))))))))))))) (Src 68169735602325 (All "term" (Src 68169746087969 (Book.Kind.Term)) λxterm (Src 68169759719573 (All "P" (Src 68169767059501 (Set)) λxP (Src 68169772302485 (All "Y" (Src 68169779642480 (All "nam" (Src 68169789079623 (Book.String)) λxnam (Src 68169797468272 (All "bod" (Src 68169806905453 (All "x" (Src 68169814245474 (Book.Kind.Term)) λxx (Src 68169825779821 (Book.Kind.Term)))) λxbod (Src 68169837314160 xP))))) λxY (Src 68169842557077 (All "N" (Src 68169849897104 (All "val" (Src 68169859334285 (Book.Kind.Term)) λxval (Src 68169870868624 xP))) λxN (Src 68169876111509 xP)))))))))))
Book.Kind.if.txt = (Ref "Kind.if.txt" [] (Ann (Src 103354215695593 (Lam "term" λxterm (Src 103354223035625 (Lam "P" λxP (Src 103354227229929 (Lam "Y" λxY (Src 103354231424233 (Lam "N" λxN (Src 103354237715689 (Let "P" (Src 103354248200405 (Lam "x" λxx (Src 103354252394709 (All "Y" (Src 103354259734708 (All "lit" (Src 103354269171889 (Book.Kind.Text)) λxlit (Src 103354280706228 xP))) λxY (Src 103354283851989 (All "N" (Src 103354291192018 (All "val" (Src 103354300629199 (Book.Kind.Term)) λxval (Src 103354312163538 xP))) λxN (Src 103354315309269 xP))))))) λxP (Src 103354319504617 (Let "all" (Src 103354329989400 (Lam "nam" λxnam (Src 103354336280856 (Lam "inp" λxinp (Src 103354342572312 (Lam "bod" λxbod (Src 103354350960920 (Lam "Y" λxY (Src 103354355155224 (Lam "N" λxN (Src 103354359349528 (App (Src 103354360398080 xN) (Src 103354362495255 (App (App (App (Src 103354363543818 (Book.Kind.all)) (Src 103354372981006 xnam)) (Src 103354377175314 xinp)) (Src 103354381369622 xbod))))))))))))))) λxall (Src 103354389759209 (Let "lam" (Src 103354400244054 (Lam "nam" λxnam (Src 103354406535510 (Lam "bod" λxbod (Src 103354420166998 (Lam "Y" λxY (Src 103354424361302 (Lam "N" λxN (Src 103354428555606 (App (Src 103354429604162 xN) (Src 103354431701333 (App (App (Src 103354432749900 (Book.Kind.lam)) (Src 103354442187088 xnam)) (Src 103354446381396 xbod))))))))))))) λxlam (Src 103354454770921 (Let "app" (Src 103354465255828 (Lam "fun" λxfun (Src 103354471547284 (Lam "arg" λxarg (Src 103354485178772 (Lam "Y" λxY (Src 103354489373076 (Lam "N" λxN (Src 103354493567380 (App (Src 103354494615936 xN) (Src 103354496713107 (App (App (Src 103354497761674 (Book.Kind.app)) (Src 103354507198862 xfun)) (Src 103354511393170 xarg))))))))))))) λxapp (Src 103354519782633 (Let "ann" (Src 103354530267602 (Lam "val" λxval (Src 103354536559058 (Lam "typ" λxtyp (Src 103354550190546 (Lam "Y" λxY (Src 103354554384850 (Lam "N" λxN (Src 103354558579154 (App (Src 103354559627710 xN) (Src 103354561724881 (App (App (Src 103354562773448 (Book.Kind.ann)) (Src 103354572210636 xval)) (Src 103354576404944 xtyp))))))))))))) λxann (Src 103354584794345 (Let "slf" (Src 103354595279376 (Lam "nam" λxnam (Src 103354601570832 (Lam "bod" λxbod (Src 103354615202320 (Lam "Y" λxY (Src 103354619396624 (Lam "N" λxN (Src 103354623590928 (App (Src 103354624639484 xN) (Src 103354626736655 (App (App (Src 103354627785222 (Book.Kind.slf)) (Src 103354637222410 xnam)) (Src 103354641416718 xbod))))))))))))) λxslf (Src 103354649806057 (Let "ins" (Src 103354660291145 (Lam "val" λxval (Src 103354679165513 (Lam "Y" λxY (Src 103354683359817 (Lam "N" λxN (Src 103354687554121 (App (Src 103354688602681 xN) (Src 103354690699848 (App (Src 103354691748419 (Book.Kind.ins)) (Src 103354701185607 xval))))))))))) λxins (Src 103354709574889 (Let "ref" (Src 103354720060039 (Lam "nam" λxnam (Src 103354726351495 (Lam "val" λxval (Src 103354739982983 (Lam "Y" λxY (Src 103354744177287 (Lam "N" λxN (Src 103354748371591 (App (Src 103354749420147 xN) (Src 103354751517318 (App (App (Src 103354752565885 (Book.Kind.ref)) (Src 103354762003073 xnam)) (Src 103354766197381 xval))))))))))))) λxref (Src 103354774586601 (Let "def" (Src 103354785071818 (Lam "nam" λxnam (Src 103354791363274 (Lam "val" λxval (Src 103354797654730 (Lam "bod" λxbod (Src 103354806043338 (Lam "Y" λxY (Src 103354810237642 (Lam "N" λxN (Src 103354814431946 (App (Src 103354815480498 xN) (Src 103354817577673 (App (App (App (Src 103354818626236 (Book.Kind.def)) (Src 103354828063424 xnam)) (Src 103354832257732 xval)) (Src 103354836452040 xbod))))))))))))))) λxdef (Src 103354844841193 (Let "set" (Src 103354873152252 (Lam "Y" λxY (Src 103354877346556 (Lam "N" λxN (Src 103354881540860 (App (Src 103354882589426 xN) (Src 103354884686587 (Book.Kind.set)))))))) λxset (Src 103354897269993 (Let "u60" (Src 103354925581102 (Lam "Y" λxY (Src 103354929775406 (Lam "N" λxN (Src 103354933969710 (App (Src 103354935018276 xN) (Src 103354937115437 (Book.Kind.u60)))))))) λxu60 (Src 103354949698793 (Let "num" (Src 103354960184167 (Lam "val" λxval (Src 103354979058535 (Lam "Y" λxY (Src 103354983252839 (Lam "N" λxN (Src 103354987447143 (App (Src 103354988495703 xN) (Src 103354990592870 (App (Src 103354991641441 (Book.Kind.num)) (Src 103355001078629 xval))))))))))) λxnum (Src 103355009467625 (Let "op2" (Src 103355019953066 (Lam "opr" λxopr (Src 103355026244522 (Lam "fst" λxfst (Src 103355032535978 (Lam "snd" λxsnd (Src 103355040924586 (Lam "Y" λxY (Src 103355045118890 (Lam "N" λxN (Src 103355049313194 (App (Src 103355050361746 xN) (Src 103355052458921 (App (App (App (Src 103355053507484 (Book.Kind.op2)) (Src 103355062944672 xopr)) (Src 103355067138980 xfst)) (Src 103355071333288 xsnd))))))))))))))) λxop2 (Src 103355079722217 (Let "mat" (Src 103355090207727 (Lam "nam" λxnam (Src 103355096499183 (Lam "x" λxx (Src 103355100693487 (Lam "z" λxz (Src 103355104887791 (Lam "s" λxs (Src 103355109082095 (Lam "p" λxp (Src 103355113276399 (Lam "Y" λxY (Src 103355117470703 (Lam "N" λxN (Src 103355121665007 (App (Src 103355122713559 xN) (Src 103355124810734 (App (App (App (App (App (Src 103355125859297 (Book.Kind.mat)) (Src 103355135296485 xnam)) (Src 103355139490791 xx)) (Src 103355141587945 xz)) (Src 103355143685099 xs)) (Src 103355145782253 xp))))))))))))))))))) λxmat (Src 103355152073961 (Let "txt" (Src 103355162559517 (Lam "lit" λxlit (Src 103355181433885 (Lam "Y" λxY (Src 103355185628189 (Lam "N" λxN (Src 103355189822493 (App (Src 103355190871064 xY) (Src 103355192968220 xlit))))))))) λxtxt (Src 103355200308457 (Let "hol" (Src 103355210794075 (Lam "nam" λxnam (Src 103355217085531 (Lam "ctx" λxctx (Src 103355230717019 (Lam "Y" λxY (Src 103355234911323 (Lam "N" λxN (Src 103355239105627 (App (Src 103355240154183 xN) (Src 103355242251354 (App (App (Src 103355243299921 (Book.Kind.hol)) (Src 103355252737109 xnam)) (Src 103355256931417 xctx))))))))))))) λxhol (Src 103355265320169 (Let "var" (Src 103355275805849 (Lam "nam" λxnam (Src 103355282097305 (Lam "idx" λxidx (Src 103355295728793 (Lam "Y" λxY (Src 103355299923097 (Lam "N" λxN (Src 103355304117401 (App (Src 103355305165957 xN) (Src 103355307263128 (App (App (Src 103355308311695 (Book.Kind.var)) (Src 103355317748883 xnam)) (Src 103355321943191 xidx))))))))))))) λxvar (Src 103355330331881 (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (Src 103355331380386 (Ins (Src 103355332428962 xterm))) (Src 103355337671844 xP)) (Src 103355339769000 xall)) (Src 103355343963308 xlam)) (Src 103355348157616 xapp)) (Src 103355352351924 xann)) (Src 103355356546232 xslf)) (Src 103355360740540 xins)) (Src 103355364934848 xref)) (Src 103355369129156 xdef)) (Src 103355373323464 xset)) (Src 103355377517772 xu60)) (Src 103355381712080 xnum)) (Src 103355385906388 xop2)) (Src 103355390100696 xmat)) (Src 103355394295004 xtxt)) (Src 103355398489312 xhol)) (Src 103355402683620 xvar)) (Src 103355406877926 xY)) (Src 103355408975080 xN))))))))))))))))))))))))))))))))))))))))))))) (Src 103354107691122 (All "term" (Src 103354118176801 (Book.Kind.Term)) λxterm (Src 103354131808370 (All "P" (Src 103354139148333 (Set)) λxP (Src 103354144391282 (All "Y" (Src 103354151731277 (All "lit" (Src 103354161168458 (Book.Kind.Text)) λxlit (Src 103354172702797 xP))) λxY (Src 103354177945714 (All "N" (Src 103354185285741 (All "val" (Src 103354194722922 (Book.Kind.Term)) λxval (Src 103354206257261 xP))) λxN (Src 103354211500146 xP)))))))))))
Book.Kind.if.u60 = (Ref "Kind.if.u60" [] (Ann (Src 104453706351811 (Lam "term" λxterm (Src 104453713691843 (Lam "P" λxP (Src 104453717886147 (Lam "Y" λxY (Src 104453722080451 (Lam "N" λxN (Src 104453728371907 (Let "P" (Src 104453738856621 (Lam "x" λxx (Src 104453743050925 (All "Y" (Src 104453750390924 xP) λxY (Src 104453753536685 (All "N" (Src 104453760876714 (All "val" (Src 104453770313895 (Book.Kind.Term)) λxval (Src 104453781848234 xP))) λxN (Src 104453784993965 xP))))))) λxP (Src 104453789189315 (Let "all" (Src 104453799674096 (Lam "nam" λxnam (Src 104453805965552 (Lam "inp" λxinp (Src 104453812257008 (Lam "bod" λxbod (Src 104453820645616 (Lam "Y" λxY (Src 104453824839920 (Lam "N" λxN (Src 104453829034224 (App (Src 104453830082776 xN) (Src 104453832179951 (App (App (App (Src 104453833228514 (Book.Kind.all)) (Src 104453842665702 xnam)) (Src 104453846860010 xinp)) (Src 104453851054318 xbod))))))))))))))) λxall (Src 104453859443907 (Let "lam" (Src 104453869928750 (Lam "nam" λxnam (Src 104453876220206 (Lam "bod" λxbod (Src 104453889851694 (Lam "Y" λxY (Src 104453894045998 (Lam "N" λxN (Src 104453898240302 (App (Src 104453899288858 xN) (Src 104453901386029 (App (App (Src 104453902434596 (Book.Kind.lam)) (Src 104453911871784 xnam)) (Src 104453916066092 xbod))))))))))))) λxlam (Src 104453924455619 (Let "app" (Src 104453934940524 (Lam "fun" λxfun (Src 104453941231980 (Lam "arg" λxarg (Src 104453954863468 (Lam "Y" λxY (Src 104453959057772 (Lam "N" λxN (Src 104453963252076 (App (Src 104453964300632 xN) (Src 104453966397803 (App (App (Src 104453967446370 (Book.Kind.app)) (Src 104453976883558 xfun)) (Src 104453981077866 xarg))))))))))))) λxapp (Src 104453989467331 (Let "ann" (Src 104453999952298 (Lam "val" λxval (Src 104454006243754 (Lam "typ" λxtyp (Src 104454019875242 (Lam "Y" λxY (Src 104454024069546 (Lam "N" λxN (Src 104454028263850 (App (Src 104454029312406 xN) (Src 104454031409577 (App (App (Src 104454032458144 (Book.Kind.ann)) (Src 104454041895332 xval)) (Src 104454046089640 xtyp))))))))))))) λxann (Src 104454054479043 (Let "slf" (Src 104454064964072 (Lam "nam" λxnam (Src 104454071255528 (Lam "bod" λxbod (Src 104454084887016 (Lam "Y" λxY (Src 104454089081320 (Lam "N" λxN (Src 104454093275624 (App (Src 104454094324180 xN) (Src 104454096421351 (App (App (Src 104454097469918 (Book.Kind.slf)) (Src 104454106907106 xnam)) (Src 104454111101414 xbod))))))))))))) λxslf (Src 104454119490755 (Let "ins" (Src 104454129975841 (Lam "val" λxval (Src 104454148850209 (Lam "Y" λxY (Src 104454153044513 (Lam "N" λxN (Src 104454157238817 (App (Src 104454158287377 xN) (Src 104454160384544 (App (Src 104454161433115 (Book.Kind.ins)) (Src 104454170870303 xval))))))))))) λxins (Src 104454179259587 (Let "ref" (Src 104454189744735 (Lam "nam" λxnam (Src 104454196036191 (Lam "val" λxval (Src 104454209667679 (Lam "Y" λxY (Src 104454213861983 (Lam "N" λxN (Src 104454218056287 (App (Src 104454219104843 xN) (Src 104454221202014 (App (App (Src 104454222250581 (Book.Kind.ref)) (Src 104454231687769 xnam)) (Src 104454235882077 xval))))))))))))) λxref (Src 104454244271299 (Let "def" (Src 104454254756514 (Lam "nam" λxnam (Src 104454261047970 (Lam "val" λxval (Src 104454267339426 (Lam "bod" λxbod (Src 104454275728034 (Lam "Y" λxY (Src 104454279922338 (Lam "N" λxN (Src 104454284116642 (App (Src 104454285165194 xN) (Src 104454287262369 (App (App (App (Src 104454288310932 (Book.Kind.def)) (Src 104454297748120 xnam)) (Src 104454301942428 xval)) (Src 104454306136736 xbod))))))))))))))) λxdef (Src 104454314525891 (Let "set" (Src 104454342836948 (Lam "Y" λxY (Src 104454347031252 (Lam "N" λxN (Src 104454351225556 (App (Src 104454352274122 xN) (Src 104454354371283 (Book.Kind.set)))))))) λxset (Src 104454366954691 (Let "u60" (Src 104454395265789 (Lam "Y" λxY (Src 104454399460093 (Lam "N" λxN (Src 104454403654397 (Src 104454404702972 xY)))))) λxu60 (Src 104454409946307 (Let "num" (Src 104454420431670 (Lam "val" λxval (Src 104454439306038 (Lam "Y" λxY (Src 104454443500342 (Lam "N" λxN (Src 104454447694646 (App (Src 104454448743206 xN) (Src 104454450840373 (App (Src 104454451888944 (Book.Kind.num)) (Src 104454461326132 xval))))))))))) λxnum (Src 104454469715139 (Let "op2" (Src 104454480200569 (Lam "opr" λxopr (Src 104454486492025 (Lam "fst" λxfst (Src 104454492783481 (Lam "snd" λxsnd (Src 104454501172089 (Lam "Y" λxY (Src 104454505366393 (Lam "N" λxN (Src 104454509560697 (App (Src 104454510609249 xN) (Src 104454512706424 (App (App (App (Src 104454513754987 (Book.Kind.op2)) (Src 104454523192175 xopr)) (Src 104454527386483 xfst)) (Src 104454531580791 xsnd))))))))))))))) λxop2 (Src 104454539969731 (Let "mat" (Src 104454550455230 (Lam "nam" λxnam (Src 104454556746686 (Lam "x" λxx (Src 104454560940990 (Lam "z" λxz (Src 104454565135294 (Lam "s" λxs (Src 104454569329598 (Lam "p" λxp (Src 104454573523902 (Lam "Y" λxY (Src 104454577718206 (Lam "N" λxN (Src 104454581912510 (App (Src 104454582961062 xN) (Src 104454585058237 (App (App (App (App (App (Src 104454586106800 (Book.Kind.mat)) (Src 104454595543988 xnam)) (Src 104454599738294 xx)) (Src 104454601835448 xz)) (Src 104454603932602 xs)) (Src 104454606029756 xp))))))))))))))))))) λxmat (Src 104454612321475 (Let "txt" (Src 104454622807031 (Lam "lit" λxlit (Src 104454641681399 (Lam "Y" λxY (Src 104454645875703 (Lam "N" λxN (Src 104454650070007 (App (Src 104454651118567 xN) (Src 104454653215734 (App (Src 104454654264305 (Book.Kind.txt)) (Src 104454663701493 xlit))))))))))) λxtxt (Src 104454672090307 (Let "hol" (Src 104454682575925 (Lam "nam" λxnam (Src 104454688867381 (Lam "ctx" λxctx (Src 104454702498869 (Lam "Y" λxY (Src 104454706693173 (Lam "N" λxN (Src 104454710887477 (App (Src 104454711936033 xN) (Src 104454714033204 (App (App (Src 104454715081771 (Book.Kind.hol)) (Src 104454724518959 xnam)) (Src 104454728713267 xctx))))))))))))) λxhol (Src 104454737102019 (Let "var" (Src 104454747587699 (Lam "nam" λxnam (Src 104454753879155 (Lam "idx" λxidx (Src 104454767510643 (Lam "Y" λxY (Src 104454771704947 (Lam "N" λxN (Src 104454775899251 (App (Src 104454776947807 xN) (Src 104454779044978 (App (App (Src 104454780093545 (Book.Kind.var)) (Src 104454789530733 xnam)) (Src 104454793725041 xidx))))))))))))) λxvar (Src 104454802113731 (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (Src 104454803162236 (Ins (Src 104454804210812 xterm))) (Src 104454809453694 xP)) (Src 104454811550850 xall)) (Src 104454815745158 xlam)) (Src 104454819939466 xapp)) (Src 104454824133774 xann)) (Src 104454828328082 xslf)) (Src 104454832522390 xins)) (Src 104454836716698 xref)) (Src 104454840911006 xdef)) (Src 104454845105314 xset)) (Src 104454849299622 xu60)) (Src 104454853493930 xnum)) (Src 104454857688238 xop2)) (Src 104454861882546 xmat)) (Src 104454866076854 xtxt)) (Src 104454870271162 xhol)) (Src 104454874465470 xvar)) (Src 104454878659776 xY)) (Src 104454880756930 xN))))))))))))))))))))))))))))))))))))))))))))) (Src 104453619318878 (All "term" (Src 104453629804577 (Book.Kind.Term)) λxterm (Src 104453643436126 (All "P" (Src 104453650776109 (Set)) λxP (Src 104453656019038 (All "Y" (Src 104453663359033 xP) λxY (Src 104453668601950 (All "N" (Src 104453675941977 (All "val" (Src 104453685379158 (Book.Kind.Term)) λxval (Src 104453696913497 xP))) λxN (Src 104453702156382 xP)))))))))))
Book.Kind.if.var = (Ref "Kind.if.var" [] (Ann (Src 105553250485503 (Lam "term" λxterm (Src 105553257825535 (Lam "P" λxP (Src 105553262019839 (Lam "Y" λxY (Src 105553266214143 (Lam "N" λxN (Src 105553272505599 (Let "P" (Src 105553282990315 (Lam "x" λxx (Src 105553287184619 (All "Y" (Src 105553294524618 (All "nam" (Src 105553303961785 (Book.String)) λxnam (Src 105553312350410 (All "idx" (Src 105553321787591 (Book.Nat)) λxidx (Src 105553327030474 xP))))) λxY (Src 105553330176235 (All "N" (Src 105553337516264 (All "val" (Src 105553346953445 (Book.Kind.Term)) λxval (Src 105553358487784 xP))) λxN (Src 105553361633515 xP))))))) λxP (Src 105553365828863 (Let "all" (Src 105553376313646 (Lam "nam" λxnam (Src 105553382605102 (Lam "inp" λxinp (Src 105553388896558 (Lam "bod" λxbod (Src 105553397285166 (Lam "Y" λxY (Src 105553401479470 (Lam "N" λxN (Src 105553405673774 (App (Src 105553406722326 xN) (Src 105553408819501 (App (App (App (Src 105553409868064 (Book.Kind.all)) (Src 105553419305252 xnam)) (Src 105553423499560 xinp)) (Src 105553427693868 xbod))))))))))))))) λxall (Src 105553436083455 (Let "lam" (Src 105553446568300 (Lam "nam" λxnam (Src 105553452859756 (Lam "bod" λxbod (Src 105553466491244 (Lam "Y" λxY (Src 105553470685548 (Lam "N" λxN (Src 105553474879852 (App (Src 105553475928408 xN) (Src 105553478025579 (App (App (Src 105553479074146 (Book.Kind.lam)) (Src 105553488511334 xnam)) (Src 105553492705642 xbod))))))))))))) λxlam (Src 105553501095167 (Let "app" (Src 105553511580074 (Lam "fun" λxfun (Src 105553517871530 (Lam "arg" λxarg (Src 105553531503018 (Lam "Y" λxY (Src 105553535697322 (Lam "N" λxN (Src 105553539891626 (App (Src 105553540940182 xN) (Src 105553543037353 (App (App (Src 105553544085920 (Book.Kind.app)) (Src 105553553523108 xfun)) (Src 105553557717416 xarg))))))))))))) λxapp (Src 105553566106879 (Let "ann" (Src 105553576591848 (Lam "val" λxval (Src 105553582883304 (Lam "typ" λxtyp (Src 105553596514792 (Lam "Y" λxY (Src 105553600709096 (Lam "N" λxN (Src 105553604903400 (App (Src 105553605951956 xN) (Src 105553608049127 (App (App (Src 105553609097694 (Book.Kind.ann)) (Src 105553618534882 xval)) (Src 105553622729190 xtyp))))))))))))) λxann (Src 105553631118591 (Let "slf" (Src 105553641603622 (Lam "nam" λxnam (Src 105553647895078 (Lam "bod" λxbod (Src 105553661526566 (Lam "Y" λxY (Src 105553665720870 (Lam "N" λxN (Src 105553669915174 (App (Src 105553670963730 xN) (Src 105553673060901 (App (App (Src 105553674109468 (Book.Kind.slf)) (Src 105553683546656 xnam)) (Src 105553687740964 xbod))))))))))))) λxslf (Src 105553696130303 (Let "ins" (Src 105553706615391 (Lam "val" λxval (Src 105553725489759 (Lam "Y" λxY (Src 105553729684063 (Lam "N" λxN (Src 105553733878367 (App (Src 105553734926927 xN) (Src 105553737024094 (App (Src 105553738072665 (Book.Kind.ins)) (Src 105553747509853 xval))))))))))) λxins (Src 105553755899135 (Let "ref" (Src 105553766384285 (Lam "nam" λxnam (Src 105553772675741 (Lam "val" λxval (Src 105553786307229 (Lam "Y" λxY (Src 105553790501533 (Lam "N" λxN (Src 105553794695837 (App (Src 105553795744393 xN) (Src 105553797841564 (App (App (Src 105553798890131 (Book.Kind.ref)) (Src 105553808327319 xnam)) (Src 105553812521627 xval))))))))))))) λxref (Src 105553820910847 (Let "def" (Src 105553831396064 (Lam "nam" λxnam (Src 105553837687520 (Lam "val" λxval (Src 105553843978976 (Lam "bod" λxbod (Src 105553852367584 (Lam "Y" λxY (Src 105553856561888 (Lam "N" λxN (Src 105553860756192 (App (Src 105553861804744 xN) (Src 105553863901919 (App (App (App (Src 105553864950482 (Book.Kind.def)) (Src 105553874387670 xnam)) (Src 105553878581978 xval)) (Src 105553882776286 xbod))))))))))))))) λxdef (Src 105553891165439 (Let "set" (Src 105553919476498 (Lam "Y" λxY (Src 105553923670802 (Lam "N" λxN (Src 105553927865106 (App (Src 105553928913672 xN) (Src 105553931010833 (Book.Kind.set)))))))) λxset (Src 105553943594239 (Let "u60" (Src 105553971905348 (Lam "Y" λxY (Src 105553976099652 (Lam "N" λxN (Src 105553980293956 (App (Src 105553981342522 xN) (Src 105553983439683 (Book.Kind.u60)))))))) λxu60 (Src 105553996023039 (Let "num" (Src 105554006508413 (Lam "val" λxval (Src 105554025382781 (Lam "Y" λxY (Src 105554029577085 (Lam "N" λxN (Src 105554033771389 (App (Src 105554034819949 xN) (Src 105554036917116 (App (Src 105554037965687 (Book.Kind.num)) (Src 105554047402875 xval))))))))))) λxnum (Src 105554055791871 (Let "op2" (Src 105554066277312 (Lam "opr" λxopr (Src 105554072568768 (Lam "fst" λxfst (Src 105554078860224 (Lam "snd" λxsnd (Src 105554087248832 (Lam "Y" λxY (Src 105554091443136 (Lam "N" λxN (Src 105554095637440 (App (Src 105554096685992 xN) (Src 105554098783167 (App (App (App (Src 105554099831730 (Book.Kind.op2)) (Src 105554109268918 xopr)) (Src 105554113463226 xfst)) (Src 105554117657534 xsnd))))))))))))))) λxop2 (Src 105554126046463 (Let "mat" (Src 105554136531973 (Lam "nam" λxnam (Src 105554142823429 (Lam "x" λxx (Src 105554147017733 (Lam "z" λxz (Src 105554151212037 (Lam "s" λxs (Src 105554155406341 (Lam "p" λxp (Src 105554159600645 (Lam "Y" λxY (Src 105554163794949 (Lam "N" λxN (Src 105554167989253 (App (Src 105554169037805 xN) (Src 105554171134980 (App (App (App (App (App (Src 105554172183543 (Book.Kind.mat)) (Src 105554181620731 xnam)) (Src 105554185815037 xx)) (Src 105554187912191 xz)) (Src 105554190009345 xs)) (Src 105554192106499 xp))))))))))))))))))) λxmat (Src 105554198398207 (Let "txt" (Src 105554208883774 (Lam "lit" λxlit (Src 105554227758142 (Lam "Y" λxY (Src 105554231952446 (Lam "N" λxN (Src 105554236146750 (App (Src 105554237195310 xN) (Src 105554239292477 (App (Src 105554240341048 (Book.Kind.txt)) (Src 105554249778236 xlit))))))))))) λxtxt (Src 105554258167039 (Let "hol" (Src 105554268652668 (Lam "nam" λxnam (Src 105554274944124 (Lam "ctx" λxctx (Src 105554288575612 (Lam "Y" λxY (Src 105554292769916 (Lam "N" λxN (Src 105554296964220 (App (Src 105554298012776 xN) (Src 105554300109947 (App (App (Src 105554301158514 (Book.Kind.hol)) (Src 105554310595702 xnam)) (Src 105554314790010 xctx))))))))))))) λxhol (Src 105554323178751 (Let "var" (Src 105554333664431 (Lam "nam" λxnam (Src 105554339955887 (Lam "idx" λxidx (Src 105554353587375 (Lam "Y" λxY (Src 105554357781679 (Lam "N" λxN (Src 105554361975983 (App (App (Src 105554363024550 xY) (Src 105554365121706 xnam)) (Src 105554369316014 xidx))))))))))) λxvar (Src 105554376656127 (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (Src 105554377704632 (Ins (Src 105554378753208 xterm))) (Src 105554383996090 xP)) (Src 105554386093246 xall)) (Src 105554390287554 xlam)) (Src 105554394481862 xapp)) (Src 105554398676170 xann)) (Src 105554402870478 xslf)) (Src 105554407064786 xins)) (Src 105554411259094 xref)) (Src 105554415453402 xdef)) (Src 105554419647710 xset)) (Src 105554423842018 xu60)) (Src 105554428036326 xnum)) (Src 105554432230634 xop2)) (Src 105554436424942 xmat)) (Src 105554440619250 xtxt)) (Src 105554444813558 xhol)) (Src 105554449007866 xvar)) (Src 105554453202172 xY)) (Src 105554455299326 xN))))))))))))))))))))))))))))))))))))))))))))) (Src 105553130946685 (All "term" (Src 105553141432353 (Book.Kind.Term)) λxterm (Src 105553155063933 (All "P" (Src 105553162403885 (Set)) λxP (Src 105553167646845 (All "Y" (Src 105553174986840 (All "nam" (Src 105553184424007 (Book.String)) λxnam (Src 105553192812632 (All "idx" (Src 105553202249813 (Book.Nat)) λxidx (Src 105553207492696 xP))))) λxY (Src 105553212735613 (All "N" (Src 105553220075640 (All "val" (Src 105553229512821 (Book.Kind.Term)) λxval (Src 105553241047160 xP))) λxN (Src 105553246290045 xP)))))))))))
Book.Kind.infer = (Ref "Kind.infer" [] (Ann (Src 69269308049714 (Lam "term" λxterm (Src 69269315389746 (Lam "dep" λxdep (Src 69269323778354 (Let "bind" (Src 69269335310466 (App (App (Src 69269336359021 (Book.Maybe.bind)) (Src 69269347893367 (Book.Kind.Term))) (Src 69269358379137 (Book.Kind.Term)))) λxbind (Src 69269372012850 (Let "pure" (Src 69269383544998 (App (Src 69269384593563 (Book.Maybe.some)) (Src 69269396127909 (Book.Kind.Term)))) λxpure (Src 69269410810162 (Let "none" (Src 69269422342347 (App (Src 69269423390912 (Book.Maybe.none)) (Src 69269434925258 (Book.Kind.Term)))) λxnone (Src 69269448558898 (Let "P" (Src 69269456945398 (Lam "x" λxx (Src 69269460091126 (All "dep" (Src 69269468479716 (Book.Nat)) λxdep (Src 69269472674038 (App (Src 69269473722603 (Book.Maybe)) (Src 69269480014069 (Book.Kind.Term)))))))) λxP (Src 69269493647666 (Let "all" (Src 69269504131511 (Lam "nam" λxnam (Src 69269510422967 (Lam "inp" λxinp (Src 69269516714423 (Lam "bod" λxbod (Src 69269523005879 (Lam "dep" λxdep (Src 69269533491639 (App (App (Src 69269534540068 xbind) (Src 69269539782978 (App (App (App (Src 69269540831536 (Book.Kind.check)) (Src 69269552365876 xinp)) (Src 69269556560189 (Book.Kind.set))) (Src 69269565997377 xdep)))) (Src 69269571240374 (Lam "_" λx_ (Src 69269579628982 (App (App (Src 69269580677456 xbind) (Src 69269585920413 (App (App (App (Src 69269586968924 (Book.Kind.check)) (Src 69269598503300 (App (Src 69269599551841 xbod) (Src 69269603746179 (App (App (Src 69269604794731 (Book.Kind.ann)) (Src 69269614231934 (App (App (Src 69269615280501 (Book.Kind.var)) (Src 69269624717689 xnam)) (Src 69269628911997 xdep)))) (Src 69269634154882 xinp)))))) (Src 69269640446349 (Book.Kind.set))) (Src 69269649883548 (App (Src 69269650932119 (Book.Nat.succ)) (Src 69269660369307 xdep)))))) (Src 69269666660789 (Lam "_" λx_ (Src 69269675049397 (App (Src 69269676097963 xpure) (Src 69269681340852 (Book.Kind.set)))))))))))))))))))) λxall (Src 69269696022834 (Let "lam" (Src 69269706506718 (Lam "nam" λxnam (Src 69269712798174 (Lam "bod" λxbod (Src 69269719089630 (Lam "dep" λxdep (Src 69269729575390 xnone))))))) λxlam (Src 69269736917298 (Let "app" (Src 69269747401568 (Lam "fun" λxfun (Src 69269753693024 (Lam "arg" λxarg (Src 69269759984480 (Lam "dep" λxdep (Src 69269770470240 (App (App (Src 69269771518470 xbind) (Src 69269776761371 (App (App (Src 69269777809938 (Book.Kind.infer)) (Src 69269789344278 xfun)) (Src 69269793538586 xdep)))) (Src 69269798781791 (Lam "fun_typ" λxfun_typ (Src 69269813461855 (App (App (Src 69269814510416 (App (App (App (App (Src 69269815558711 (Book.Kind.if.all)) (Src 69269828141655 (App (App (Src 69269829190212 (Book.Kind.reduce)) (Src 69269841773134 (Book.Bool.true))) (Src 69269852258902 xfun_typ)))) (Src 69269867987605 (All "fun" (Src 69269877424752 (Book.Kind.Term)) λxfun (Src 69269887910549 (All "arg" (Src 69269897347715 (Book.Kind.Term)) λxarg (Src 69269907833493 (App (Src 69269908882058 (Book.Maybe)) (Src 69269915173524 (Book.Kind.Term))))))))) (Src 69269932999462 (Lam "fun_typ.nam" λxfun_typ.nam (Src 69269947679526 (Lam "fun_typ.inp" λxfun_typ.inp (Src 69269962359590 (Lam "fun_typ.bod" λxfun_typ.bod (Src 69269977039654 (Lam "fun" λxfun (Src 69269983331110 (Lam "arg" λxarg (Src 69269998011174 (App (App (Src 69269999059679 xbind) (Src 69270004302592 (App (App (App (Src 69270005351147 (Book.Kind.check)) (Src 69270016885487 xarg)) (Src 69270021079803 xfun_typ.inp)) (Src 69270033662719 xdep)))) (Src 69270038905637 (Lam "_" λx_ (Src 69270051488549 (App (Src 69270052537106 xpure) (Src 69270057780004 (App (Src 69270058828575 xfun_typ.bod) (Src 69270071411491 xarg)))))))))))))))))))) (Src 69270085043023 (Lam "fun_typ" λxfun_typ (Src 69270095528783 (Lam "fun" λxfun (Src 69270101820239 (Lam "arg" λxarg (Src 69270116500303 xnone))))))))) (Src 69270129083226 xfun)) (Src 69270133277534 xarg))))))))))))) λxapp (Src 69270141667634 (Let "ann" (Src 69270152151949 (Lam "val" λxval (Src 69270158443405 (Lam "typ" λxtyp (Src 69270164734861 (Lam "dep" λxdep (Src 69270175220621 (App (Src 69270176269192 xpure) (Src 69270181512076 xtyp))))))))) λxann (Src 69270188853554 (Let "slf" (Src 69270199338026 (Lam "nam" λxnam (Src 69270205629482 (Lam "bod" λxbod (Src 69270211920938 (Lam "dep" λxdep (Src 69270222406698 (App (App (Src 69270223455157 xbind) (Src 69270228698129 (App (App (App (Src 69270229746625 (Book.Kind.check)) (Src 69270241281016 (App (Src 69270242329542 xbod) (Src 69270246523895 (App (App (Src 69270247572432 (Book.Kind.ann)) (Src 69270257009635 (App (App (Src 69270258058202 (Book.Kind.var)) (Src 69270267495390 xnam)) (Src 69270271689698 xdep)))) (Src 69270276932598 (App (App (Src 69270277981165 (Book.Kind.slf)) (Src 69270287418353 xnam)) (Src 69270291612661 xbod)))))))) (Src 69270298952705 (Book.Kind.set))) (Src 69270308389904 (App (Src 69270309438475 (Book.Nat.succ)) (Src 69270318875663 xdep)))))) (Src 69270325167145 (Lam "_" λx_ (Src 69270333555753 (App (Src 69270334604319 xpure) (Src 69270339847208 (Book.Kind.set)))))))))))))) λxslf (Src 69270353479986 (Let "ins" (Src 69270363964728 (Lam "val" λxval (Src 69270370256184 (Lam "dep" λxdep (Src 69270380741944 (App (App (Src 69270381790284 xbind) (Src 69270387033185 (App (App (Src 69270388081752 (Book.Kind.infer)) (Src 69270399616092 xval)) (Src 69270403810400 xdep)))) (Src 69270409053495 (Lam "val_typ" λxval_typ (Src 69270423733559 (App (Src 69270424782124 (App (App (App (App (Src 69270425830525 (Book.Kind.if.slf)) (Src 69270438413469 (App (App (Src 69270439462026 (Book.Kind.reduce)) (Src 69270452044948 (Book.Bool.true))) (Src 69270462530716 xval_typ)))) (Src 69270478259400 (All "val" (Src 69270487696566 (Book.Kind.Term)) λxval (Src 69270498182344 (App (Src 69270499230909 (Book.Maybe)) (Src 69270505522375 (Book.Kind.Term))))))) (Src 69270523348240 (Lam "val_nam" λxval_nam (Src 69270533834000 (Lam "val_typ.bod" λxval_typ.bod (Src 69270548514064 (Lam "val" λxval (Src 69270554805520 (App (Src 69270555854066 xpure) (Src 69270561096975 (App (Src 69270562145535 xval_typ.bod) (Src 69270574728462 (App (Src 69270575777033 (Book.Kind.ins)) (Src 69270585214221 xval)))))))))))))) (Src 69270598845739 (Lam "val_typ" λxval_typ (Src 69270609331499 (Lam "val" λxval (Src 69270615622955 xnone))))))) (Src 69270628205878 xval))))))))))) λxins (Src 69270636595506 (Let "ref" (Src 69270647080303 (Lam "nam" λxnam (Src 69270653371759 (Lam "val" λxval (Src 69270659663215 (Lam "dep" λxdep (Src 69270670148975 (App (App (Src 69270671197542 (Book.Kind.infer)) (Src 69270682731882 xval)) (Src 69270686926190 xdep))))))))) λxref (Src 69270694267186 (Let "def" (Src 69270704752028 (Lam "nam" λxnam (Src 69270711043484 (Lam "val" λxval (Src 69270717334940 (Lam "bod" λxbod (Src 69270723626396 (Lam "dep" λxdep (Src 69270734112156 xnone))))))))) λxdef (Src 69270741453106 (Let "set" (Src 69270751937986 (Lam "dep" λxdep (Src 69270762423746 (App (Src 69270763472312 xpure) (Src 69270768715201 (Book.Kind.set)))))) λxset (Src 69270781298994 (Let "u60" (Src 69270791783912 (Lam "dep" λxdep (Src 69270802269672 (App (Src 69270803318238 xpure) (Src 69270808561127 (Book.Kind.set)))))) λxu60 (Src 69270821144882 (Let "num" (Src 69270831629844 (Lam "num" λxnum (Src 69270837921300 (Lam "dep" λxdep (Src 69270848407060 (App (Src 69270849455626 xpure) (Src 69270854698515 (Book.Kind.u60)))))))) λxnum (Src 69270867282226 (Let "txt" (Src 69270877767240 (Lam "txt" λxtxt (Src 69270884058696 (Lam "dep" λxdep (Src 69270894544456 (App (Src 69270895593014 xpure) (Src 69270900835911 (Book.Kind.Book.String)))))))) λxtxt (Src 69270921808178 (Let "op2" (Src 69270932293338 (Lam "opr" λxopr (Src 69270938584794 (Lam "fst" λxfst (Src 69270944876250 (Lam "snd" λxsnd (Src 69270951167706 (Lam "dep" λxdep (Src 69270961653466 (App (App (Src 69270962701942 xbind) (Src 69270967944852 (App (App (App (Src 69270968993410 (Book.Kind.check)) (Src 69270980527750 xfst)) (Src 69270984722063 (Book.Kind.u60))) (Src 69270994159251 xdep)))) (Src 69270999402201 (Lam "_" λx_ (Src 69271007790809 (App (App (Src 69271008839330 xbind) (Src 69271014082240 (App (App (App (Src 69271015130798 (Book.Kind.check)) (Src 69271026665138 xsnd)) (Src 69271030859451 (Book.Kind.u60))) (Src 69271040296639 xdep)))) (Src 69271045539544 (Lam "_" λx_ (Src 69271053928152 (App (Src 69271054976718 xpure) (Src 69271060219607 (Book.Kind.u60)))))))))))))))))))) λxop2 (Src 69271074900274 (Let "mat" (Src 69271085385876 (Lam "nam" λxnam (Src 69271091677332 (Lam "x" λxx (Src 69271095871636 (Lam "z" λxz (Src 69271100065940 (Lam "s" λxs (Src 69271104260244 (Lam "p" λxp (Src 69271108454548 (Lam "dep" λxdep (Src 69271118940308 (App (App (Src 69271119988492 xbind) (Src 69271125231400 (App (App (App (Src 69271126279960 (Book.Kind.check)) (Src 69271137814298 xx)) (Src 69271139911459 (Book.Kind.u60))) (Src 69271149348647 xdep)))) (Src 69271154591891 (Lam "x_typ" λxx_typ (Src 69271167174803 (App (App (Src 69271168223034 xbind) (Src 69271173465983 (App (App (App (Src 69271174514502 (Book.Kind.check)) (Src 69271186048881 (App (Src 69271187097417 xp) (Src 69271189194608 (App (App (Src 69271190243155 (Book.Kind.ann)) (Src 69271199680358 (App (App (Src 69271200728925 (Book.Kind.var)) (Src 69271210166113 xnam)) (Src 69271214360421 xdep)))) (Src 69271219603311 (Book.Kind.u60))))))) (Src 69271231137658 (Book.Kind.set))) (Src 69271240574846 xdep)))) (Src 69271245818002 (Lam "p_typ" λxp_typ (Src 69271258400914 (App (App (Src 69271259449233 xbind) (Src 69271264692150 (App (App (App (Src 69271265740701 (Book.Kind.check)) (Src 69271277275039 xz)) (Src 69271279372209 (App (Src 69271280420770 xp) (Src 69271282517936 (App (Src 69271283566508 (Book.Kind.num)) (Src 69271293003695 (Num 0))))))) (Src 69271298246581 xdep)))) (Src 69271303489681 (Lam "z_typ" λxz_typ (Src 69271316072593 (App (App (Src 69271317120968 xbind) (Src 69271322364023 (App (App (App (Src 69271323412436 (Book.Kind.check)) (Src 69271334946836 (App (Src 69271335995351 xs) (Src 69271338092563 (App (App (Src 69271339141089 (Book.Kind.ann)) (Src 69271348578313 (App (App (Src 69271349626859 (Book.Kind.var)) (Src 69271359064068 (App (App (Src 69271360112634 (Book.String.concat)) (Src 69271374792702 xnam)) (Src 69271378987011 (Txt "-1"))))) (Src 69271385278472 xdep)))) (Src 69271390521362 (Book.Kind.u60))))))) (Src 69271402055783 (App (Src 69271403104279 xp) (Src 69271405201510 (App (App (App (Src 69271406250017 (Book.Kind.op2)) (Src 69271415687215 (Book.Kind.Oper.add))) (Src 69271430367293 (App (Src 69271431415865 (Book.Kind.num)) (Src 69271440853052 (Num 1))))) (Src 69271445047397 (App (App (Src 69271446095943 (Book.Kind.var)) (Src 69271455533152 (App (App (Src 69271456581718 (Book.String.concat)) (Src 69271471261786 xnam)) (Src 69271475456095 (Txt "-1"))))) (Src 69271481747556 xdep)))))))) (Src 69271489087606 (App (Src 69271490136177 (Book.Nat.succ)) (Src 69271499573365 xdep)))))) (Src 69271505864848 (Lam "s_typ" λxs_typ (Src 69271518447760 (App (Src 69271519496329 xpure) (Src 69271524739215 (App (Src 69271525787788 xp) (Src 69271527884942 xx))))))))))))))))))))))))))))))))) λxmat (Src 69271538370866 (Let "hol" (Src 69271548856507 (Lam "nam" λxnam (Src 69271555147963 (Lam "ctx" λxctx (Src 69271561439419 (Lam "dep" λxdep (Src 69271571925179 xnone))))))) λxhol (Src 69271579265330 (Let "var" (Src 69271589751010 (Lam "nam" λxnam (Src 69271596042466 (Lam "idx" λxidx (Src 69271602333922 (Lam "dep" λxdep (Src 69271612819682 xnone))))))) λxvar (Src 69271620159794 (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (Src 69271621208299 (Ins (Src 69271622256875 xterm))) (Src 69271627499757 xP)) (Src 69271629596913 xall)) (Src 69271633791221 xlam)) (Src 69271637985529 xapp)) (Src 69271642179837 xann)) (Src 69271646374145 xslf)) (Src 69271650568453 xins)) (Src 69271654762761 xref)) (Src 69271658957069 xdef)) (Src 69271663151377 xset)) (Src 69271667345685 xu60)) (Src 69271671539993 xnum)) (Src 69271675734301 xop2)) (Src 69271679928609 xmat)) (Src 69271684122917 xtxt)) (Src 69271688317225 xhol)) (Src 69271692511533 xvar)) (Src 69271696705841 xdep))))))))))))))))))))))))))))))))))))))))))))))) (Src 69269246181445 (All "term" (Src 69269256667168 (Book.Kind.Term)) λxterm (Src 69269270298693 (All "dep" (Src 69269279735856 (Book.Nat)) λxdep (Src 69269287075909 (App (Src 69269288124474 (Book.Maybe)) (Src 69269294415940 (Book.Kind.Term))))))))))
Book.Kind.ins = (Ref "Kind.ins" [] (Ann (Src 47279047180453 (Lam "val" λxval (Src 47279055569061 (Ins (Src 47279056617637 (Lam "P" λxP (Src 47279060811941 (Lam "all" λxall (Src 47279067103397 (Lam "lam" λxlam (Src 47279073394853 (Lam "app" λxapp (Src 47279079686309 (Lam "ann" λxann (Src 47279085977765 (Lam "slf" λxslf (Src 47279092269221 (Lam "ins" λxins (Src 47279098560677 (Lam "ref" λxref (Src 47279104852133 (Lam "def" λxdef (Src 47279111143589 (Lam "set" λxset (Src 47279117435045 (Lam "u60" λxu60 (Src 47279123726501 (Lam "num" λxnum (Src 47279130017957 (Lam "op2" λxop2 (Src 47279136309413 (Lam "mat" λxmat (Src 47279142600869 (Lam "txt" λxtxt (Src 47279148892325 (Lam "hol" λxhol (Src 47279155183781 (Lam "var" λxvar (Src 47279163572389 (App (Src 47279164620960 xins) (Src 47279168815268 xval))))))))))))))))))))))))))))))))))))))))) (Src 47279011528746 (All "val" (Src 47279020965917 (Book.Kind.Term)) λxval (Src 47279034597418 (Book.Kind.Term))))))
Book.Kind.lam = (Ref "Kind.lam" [] (Ann (Src 48378597605588 (Lam "nam" λxnam (Src 48378603897044 (Lam "bod" λxbod (Src 48378612285652 (Ins (Src 48378613334228 (Lam "P" λxP (Src 48378617528532 (Lam "all" λxall (Src 48378623819988 (Lam "lam" λxlam (Src 48378630111444 (Lam "app" λxapp (Src 48378636402900 (Lam "ann" λxann (Src 48378642694356 (Lam "slf" λxslf (Src 48378648985812 (Lam "ins" λxins (Src 48378655277268 (Lam "ref" λxref (Src 48378661568724 (Lam "def" λxdef (Src 48378667860180 (Lam "set" λxset (Src 48378674151636 (Lam "u60" λxu60 (Src 48378680443092 (Lam "num" λxnum (Src 48378686734548 (Lam "op2" λxop2 (Src 48378693026004 (Lam "mat" λxmat (Src 48378699317460 (Lam "txt" λxtxt (Src 48378705608916 (Lam "hol" λxhol (Src 48378711900372 (Lam "var" λxvar (Src 48378720288980 (App (App (Src 48378721337547 xlam) (Src 48378725531855 xnam)) (Src 48378729726163 xbod))))))))))))))))))))))))))))))))))))))))))) (Src 48378523156559 (All "nam" (Src 48378532593690 (Book.String)) λxnam (Src 48378543079503 (All "bod" (Src 48378552516674 (All "x" (Src 48378559856695 (Book.Kind.Term)) λxx (Src 48378571391042 (Book.Kind.Term)))) λxbod (Src 48378585022543 (Book.Kind.Term))))))))
Book.Kind.mat = (Ref "Kind.mat" [] (Ann (Src 49478188925230 (Lam "nam" λxnam (Src 49478195216686 (Lam "x" λxx (Src 49478199410990 (Lam "z" λxz (Src 49478203605294 (Lam "s" λxs (Src 49478207799598 (Lam "p" λxp (Src 49478214091054 (Ins (Src 49478215139630 (Lam "P" λxP (Src 49478219333934 (Lam "all" λxall (Src 49478225625390 (Lam "lam" λxlam (Src 49478231916846 (Lam "app" λxapp (Src 49478238208302 (Lam "ann" λxann (Src 49478244499758 (Lam "slf" λxslf (Src 49478250791214 (Lam "ins" λxins (Src 49478257082670 (Lam "ref" λxref (Src 49478263374126 (Lam "def" λxdef (Src 49478269665582 (Lam "set" λxset (Src 49478275957038 (Lam "u60" λxu60 (Src 49478282248494 (Lam "num" λxnum (Src 49478288539950 (Lam "op2" λxop2 (Src 49478294831406 (Lam "mat" λxmat (Src 49478301122862 (Lam "txt" λxtxt (Src 49478307414318 (Lam "hol" λxhol (Src 49478313705774 (Lam "var" λxvar (Src 49478322094382 (App (App (App (App (App (Src 49478323142945 xmat) (Src 49478327337253 xnam)) (Src 49478331531559 xx)) (Src 49478333628713 xz)) (Src 49478335725867 xs)) (Src 49478337823021 xp))))))))))))))))))))))))))))))))))))))))))))))))) (Src 49478034784411 (All "nam" (Src 49478044221466 (Book.String)) λxnam (Src 49478054707355 (All "x" (Src 49478062047278 (Book.Kind.Term)) λxx (Src 49478075678875 (All "z" (Src 49478083018818 (Book.Kind.Term)) λxz (Src 49478096650395 (All "s" (Src 49478103990376 (All "x" (Src 49478111330397 (Book.Kind.Term)) λxx (Src 49478122864744 (Book.Kind.Term)))) λxs (Src 49478136496283 (All "p" (Src 49478143836302 (All "x" (Src 49478151176323 (Book.Kind.Term)) λxx (Src 49478162710670 (Book.Kind.Term)))) λxp (Src 49478176342171 (Book.Kind.Term))))))))))))))
Book.Kind.num = (Ref "Kind.num" [] (Ann (Src 50577576820896 (Lam "val" λxval (Src 50577585209504 (Ins (Src 50577586258080 (Lam "P" λxP (Src 50577590452384 (Lam "all" λxall (Src 50577596743840 (Lam "lam" λxlam (Src 50577603035296 (Lam "app" λxapp (Src 50577609326752 (Lam "ann" λxann (Src 50577615618208 (Lam "slf" λxslf (Src 50577621909664 (Lam "ins" λxins (Src 50577628201120 (Lam "ref" λxref (Src 50577634492576 (Lam "def" λxdef (Src 50577640784032 (Lam "set" λxset (Src 50577647075488 (Lam "u60" λxu60 (Src 50577653366944 (Lam "num" λxnum (Src 50577659658400 (Lam "op2" λxop2 (Src 50577665949856 (Lam "mat" λxmat (Src 50577672241312 (Lam "txt" λxtxt (Src 50577678532768 (Lam "hol" λxhol (Src 50577684824224 (Lam "var" λxvar (Src 50577693212832 (App (Src 50577694261403 xnum) (Src 50577698455711 xval))))))))))))))))))))))))))))))))))))))))) (Src 50577546412069 (All "val" (Src 50577555849240 (U60)) λxval (Src 50577564237861 (Book.Kind.Term))))))
Book.Kind.op2 = (Ref "Kind.op2" [] (Ann (Src 51677139828965 (Lam "opr" λxopr (Src 51677146120421 (Lam "fst" λxfst (Src 51677152411877 (Lam "snd" λxsnd (Src 51677160800485 (Ins (Src 51677161849061 (Lam "P" λxP (Src 51677166043365 (Lam "all" λxall (Src 51677172334821 (Lam "lam" λxlam (Src 51677178626277 (Lam "app" λxapp (Src 51677184917733 (Lam "ann" λxann (Src 51677191209189 (Lam "slf" λxslf (Src 51677197500645 (Lam "ins" λxins (Src 51677203792101 (Lam "ref" λxref (Src 51677210083557 (Lam "def" λxdef (Src 51677216375013 (Lam "set" λxset (Src 51677222666469 (Lam "u60" λxu60 (Src 51677228957925 (Lam "num" λxnum (Src 51677235249381 (Lam "op2" λxop2 (Src 51677241540837 (Lam "mat" λxmat (Src 51677247832293 (Lam "txt" λxtxt (Src 51677254123749 (Lam "hol" λxhol (Src 51677260415205 (Lam "var" λxvar (Src 51677268803813 (App (App (App (Src 51677269852376 xop2) (Src 51677274046684 xopr)) (Src 51677278240992 xfst)) (Src 51677282435300 xsnd))))))))))))))))))))))))))))))))))))))))))))) (Src 51677058039894 (All "opr" (Src 51677067477021 (Book.Kind.Oper)) λxopr (Src 51677081108566 (All "fst" (Src 51677090545715 (Book.Kind.Term)) λxfst (Src 51677104177238 (All "snd" (Src 51677113614409 (Book.Kind.Term)) λxsnd (Src 51677127245910 (Book.Kind.Term))))))))))
Book.Kind.reduce = (Ref "Kind.reduce" [] (Ann (Src 71468325012243 (Lam "maj" λxmaj (Src 71468331303699 (Lam "term" λxterm (Src 71468340740883 (Let "P" (Src 71468351225961 (Lam "x" λxx (Src 71468354371689 (Src 71468355420264 (Book.Kind.Term))))) λxP (Src 71468369052435 (Let "all" (Src 71468379537534 (Book.Kind.all)) λxall (Src 71468391072531 (Let "lam" (Src 71468401557651 (Book.Kind.lam)) λxlam (Src 71468413092627 (Let "app" (Src 71468423577819 (Lam "fun" λxfun (Src 71468429869275 (Lam "arg" λxarg (Src 71468436160731 (App (App (App (Src 71468437209276 (Book.Kind.reduce.app)) (Src 71468453986496 xmaj)) (Src 71468458180822 (App (App (Src 71468459229389 (Book.Kind.reduce)) (Src 71468471812305 xmaj)) (Src 71468476006613 xfun)))) (Src 71468481249498 xarg))))))) λxapp (Src 71468488590099 (Let "slf" (Src 71468499075312 (Book.Kind.slf)) λxslf (Src 71468510610195 (Let "ann" (Src 71468521095454 (Lam "val" λxval (Src 71468527386910 (Lam "typ" λxtyp (Src 71468533678366 (App (App (Src 71468534726933 (Book.Kind.reduce)) (Src 71468547309849 xmaj)) (Src 71468551504157 xval))))))) λxann (Src 71468558844691 (Let "ins" (Src 71468569329990 (Lam "val" λxval (Src 71468575621446 (App (App (Src 71468576670013 (Book.Kind.reduce)) (Src 71468589252929 xmaj)) (Src 71468593447237 xval))))) λxins (Src 71468600787731 (Let "ref" (Src 71468611273084 (Lam "nam" λxnam (Src 71468617564540 (Lam "val" λxval (Src 71468623855996 (App (App (App (Src 71468624904559 (Book.Kind.reduce.ref)) (Src 71468641681779 xmaj)) (Src 71468645876087 xnam)) (Src 71468650070395 xval))))))) λxref (Src 71468657410835 (Let "def" (Src 71468667896246 (Lam "nam" λxnam (Src 71468674187702 (Lam "val" λxval (Src 71468680479158 (Lam "bod" λxbod (Src 71468686770614 (App (App (Src 71468687819175 (Book.Kind.reduce)) (Src 71468700402091 xmaj)) (Src 71468704596405 (App (Src 71468705644976 xbod) (Src 71468709839284 xval))))))))))) λxdef (Src 71468718228243 (Let "set" (Src 71468728713675 (Book.Kind.set)) λxset (Src 71468740248339 (Let "u60" (Src 71468750733792 (Book.Kind.u60)) λxu60 (Src 71468762268435 (Let "num" (Src 71468772753909 (Book.Kind.num)) λxnum (Src 71468784288531 (Let "op2" (Src 71468794774065 (Lam "opr" λxopr (Src 71468801065521 (Lam "fst" λxfst (Src 71468807356977 (Lam "snd" λxsnd (Src 71468813648433 (App (App (App (Src 71468814696996 (Book.Kind.reduce.op2)) (Src 71468831474216 xopr)) (Src 71468835668524 xfst)) (Src 71468839862832 xsnd))))))))) λxop2 (Src 71468847203091 (Let "mat" (Src 71468857688693 (Lam "nam" λxnam (Src 71468863980149 (Lam "x" λxx (Src 71468868174453 (Lam "z" λxz (Src 71468872368757 (Lam "s" λxs (Src 71468876563061 (Lam "p" λxp (Src 71468880757365 (App (App (App (App (App (App (Src 71468881805924 (Book.Kind.reduce.mat)) (Src 71468898583144 xmaj)) (Src 71468902777452 xnam)) (Src 71468906971758 xx)) (Src 71468909068912 xz)) (Src 71468911166066 xs)) (Src 71468913263220 xp))))))))))))) λxmat (Src 71468918506259 (Let "txt" (Src 71468928991901 (Lam "txt" λxtxt (Src 71468935283357 (App (Src 71468936331928 (Book.Kind.reduce.txt)) (Src 71468953109148 xtxt))))) λxtxt (Src 71468960449299 (Let "hol" (Src 71468970934962 (Book.Kind.hol)) λxhol (Src 71468982469395 (Let "var" (Src 71468992955079 (Book.Kind.var)) λxvar (Src 71469004489491 (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (Src 71469005538000 (Ins (Src 71469006586576 xterm))) (Src 71469011829458 xP)) (Src 71469013926614 xall)) (Src 71469018120922 xlam)) (Src 71469022315230 xapp)) (Src 71469026509538 xann)) (Src 71469030703846 xslf)) (Src 71469034898154 xins)) (Src 71469039092462 xref)) (Src 71469043286770 xdef)) (Src 71469047481078 xset)) (Src 71469051675386 xu60)) (Src 71469055869694 xnum)) (Src 71469060064002 xop2)) (Src 71469064258310 xmat)) (Src 71469068452618 xtxt)) (Src 71469072646926 xhol)) (Src 71469076841234 xvar))))))))))))))))))))))))))))))))))))))))) (Src 71468270485567 (All "maj" (Src 71468279922715 (Book.Bool)) λxmaj (Src 71468288311359 (All "term" (Src 71468298797106 (Book.Kind.Term)) λxterm (Src 71468312428607 (Book.Kind.Term))))))))
Book.Kind.reduce.app = (Ref "Kind.reduce.app" [] (Ann (Src 72567862853925 (Lam "maj" λxmaj (Src 72567869145381 (Lam "fun" λxfun (Src 72567875436837 (Lam "arg" λxarg (Src 72567883825445 (Let "P" (Src 72567892213908 (All "arg" (Src 72567901651081 (Book.Kind.Term)) λxarg (Src 72567913185428 (Book.Kind.Term)))) λxP (Src 72567925768485 (Let "Y" (Src 72567934157022 (Lam "nam" λxnam (Src 72567940448478 (Lam "bod" λxbod (Src 72567946739934 (Lam "arg" λxarg (Src 72567953031390 (App (App (Src 72567954079933 (Book.Kind.reduce)) (Src 72567966662849 xmaj)) (Src 72567970857181 (App (Src 72567971905734 xbod) (Src 72567976100060 (App (App (Src 72567977148627 (Book.Kind.reduce)) (Src 72567989731543 xmaj)) (Src 72567993925851 xarg))))))))))))) λxY (Src 72568003363109 (Let "N" (Src 72568011751687 (Lam "fun" λxfun (Src 72568018043143 (Lam "arg" λxarg (Src 72568024334599 (App (App (Src 72568025383166 (Book.Kind.app)) (Src 72568034820354 xfun)) (Src 72568039014662 xarg))))))) λxN (Src 72568046354725 (App (App (App (App (App (Src 72568047403286 (Book.Kind.if.lam)) (Src 72568059986202 xfun)) (Src 72568064180508 xP)) (Src 72568066277662 xY)) (Src 72568068374816 xN)) (Src 72568070471972 xarg))))))))))))))) (Src 72567786307672 (All "maj" (Src 72567795744799 (Book.Bool)) λxmaj (Src 72567804133464 (All "fun" (Src 72567813570613 (Book.Kind.Term)) λxfun (Src 72567827202136 (All "arg" (Src 72567836639307 (Book.Kind.Term)) λxarg (Src 72567850270808 (Book.Kind.Term))))))))))
Book.Kind.reduce.mat = (Ref "Kind.reduce.mat" [] (Ann (Src 74766977335851 (Lam "maj" λxmaj (Src 74766983627307 (Lam "nam" λxnam (Src 74766989918763 (Lam "x" λxx (Src 74766994113067 (Lam "z" λxz (Src 74766998307371 (Lam "s" λxs (Src 74767002501675 (Lam "p" λxp (Src 74767008793131 (Let "P" (Src 74767017181461 (All "z" (Src 74767024521448 (Book.Kind.Term)) λxz (Src 74767036055829 (All "s" (Src 74767043395850 (All "x" (Src 74767049687296 (Book.Kind.Term)) λxx (Src 74767060173066 (Book.Kind.Term)))) λxs (Src 74767071707413 (Book.Kind.Term)))))) λxP (Src 74767084290603 (Let "Y" (Src 74767092679136 (Lam "x.val" λxx.val (Src 74767105262048 (Mat "x" (Src 74767116796220 xx.val) (Src 74767135670628 (Lam "z" λxz (Src 74767139864932 (Lam "s" λxs (Src 74767144059236 (App (App (Src 74767145107805 (Book.Kind.reduce)) (Src 74767157690721 xmaj)) (Src 74767161885027 xz))))))) λxx._.1 (Src 74767175516571 (Lam "z" λxz (Src 74767179710875 (Lam "s" λxs (Src 74767183905179 (App (App (Src 74767184953731 (Book.Kind.reduce)) (Src 74767197536647 xmaj)) (Src 74767201730970 (App (Src 74767202779530 xs) (Src 74767204876697 (App (Src 74767205925268 (Book.Kind.num)) (Src 74767215362456 xx._.1))))))))))) λxx (Src 74767230042592 (All "z" (Src 74767237382579 (Book.Kind.Term)) λxz (Src 74767248916960 (All "s" (Src 74767256256981 (All "x" (Src 74767262548427 (Book.Kind.Term)) λxx (Src 74767273034197 (Book.Kind.Term)))) λxs (Src 74767284568544 (Book.Kind.Term)))))))))) λxY (Src 74767297151531 (Let "N" (Src 74767305540109 (Lam "x" λxx (Src 74767309734413 (Lam "z" λxz (Src 74767313928717 (Lam "s" λxs (Src 74767318123021 (App (App (App (App (App (Src 74767319171584 (Book.Kind.mat)) (Src 74767328608772 xnam)) (Src 74767332803078 xx)) (Src 74767334900232 xz)) (Src 74767336997386 xs)) (Src 74767339094540 xp))))))))) λxN (Src 74767344337451 (App (App (Src 74767345386022 (App (App (App (App (Src 74767346434589 (Book.Kind.if.num)) (Src 74767359017503 xx)) (Src 74767361114657 xP)) (Src 74767363211811 xY)) (Src 74767365308965 xN))) (Src 74767368454696 xz)) (Src 74767370551850 xs))))))))))))))))))))) (Src 74766809563311 (All "maj" (Src 74766819000351 (Book.Bool)) λxmaj (Src 74766827389103 (All "nam" (Src 74766836826162 (Book.String)) λxnam (Src 74766847312047 (All "x" (Src 74766854651974 (Book.Kind.Term)) λxx (Src 74766868283567 (All "z" (Src 74766875623514 (Book.Kind.Term)) λxz (Src 74766889255087 (All "s" (Src 74766896595070 (All "x" (Src 74766902886516 (Book.Kind.Term)) λxx (Src 74766913372286 (Book.Kind.Term)))) λxs (Src 74766927003823 (All "p" (Src 74766934343842 (All "x" (Src 74766940635288 (Book.Kind.Term)) λxx (Src 74766951121058 (Book.Kind.Term)))) λxp (Src 74766964752559 (Book.Kind.Term))))))))))))))))
Book.Kind.reduce.op2 = (Ref "Kind.reduce.op2" [] (Ann (Src 76965914609299 (Lam "opr" λxopr (Src 76965920900755 (Lam "fst" λxfst (Src 76965927192211 (Lam "snd" λxsnd (Src 76965935580819 (Let "P" (Src 76965943967897 (All "snd" (Src 76965953405070 (Book.Kind.Term)) λxsnd (Src 76965964939417 (Book.Kind.Term)))) λxP (Src 76965977523859 (Let "Y" (Src 76965985912392 (Lam "fst_val" λxfst_val (Src 76965996398152 (Lam "snd" λxsnd (Src 76966006883912 (Let "P" (Src 76966015271132 (All "fst_val" (Src 76966028902609 (U60)) λxfst_val (Src 76966035194076 (Book.Kind.Term)))) λxP (Src 76966049875528 (Let "Y" (Src 76966058264034 (Lam "snd_val" λxsnd_val (Src 76966068749794 (Lam "fst_val" λxfst_val (Src 76966085527010 (Let "P" (Src 76966096011584 (Lam "x" λxx (Src 76966100205888 (All "fst_val" (Src 76966113837346 (U60)) λxfst_val (Src 76966120128832 (All "snd_val" (Src 76966133760309 (U60)) λxsnd_val (Src 76966140051776 (Book.Kind.Term)))))))) λxP (Src 76966156830178 (Let "add" (Src 76966167314820 (Lam "fst_val" λxfst_val (Src 76966177800580 (Lam "snd_val" λxsnd_val (Src 76966188286340 (App (Src 76966189334894 (Book.Kind.num)) (Src 76966198772099 (Op2 ADD (Src 76966202966394 xfst_val) (Src 76966211355010 xsnd_val))))))))) λxadd (Src 76966228133346 (Let "mul" (Src 76966238618056 (Lam "fst_val" λxfst_val (Src 76966249103816 (Lam "snd_val" λxsnd_val (Src 76966259589576 (App (Src 76966260638130 (Book.Kind.num)) (Src 76966270075335 (Op2 MUL (Src 76966274269630 xfst_val) (Src 76966282658246 xsnd_val))))))))) λxmul (Src 76966299436514 (Let "sub" (Src 76966309921292 (Lam "fst_val" λxfst_val (Src 76966320407052 (Lam "snd_val" λxsnd_val (Src 76966330892812 (App (Src 76966331941366 (Book.Kind.num)) (Src 76966341378571 (Op2 SUB (Src 76966345572866 xfst_val) (Src 76966353961482 xsnd_val))))))))) λxsub (Src 76966370739682 (Let "div" (Src 76966381224528 (Lam "fst_val" λxfst_val (Src 76966391710288 (Lam "snd_val" λxsnd_val (Src 76966402196048 (App (Src 76966403244602 (Book.Kind.num)) (Src 76966412681807 (Op2 DIV (Src 76966416876102 xfst_val) (Src 76966425264718 xsnd_val))))))))) λxdiv (Src 76966442042850 (Let "mod" (Src 76966452527764 (Lam "fst_val" λxfst_val (Src 76966463013524 (Lam "snd_val" λxsnd_val (Src 76966473499284 (App (Src 76966474547838 (Book.Kind.num)) (Src 76966483985043 (Op2 MOD (Src 76966488179338 xfst_val) (Src 76966496567954 xsnd_val))))))))) λxmod (Src 76966513346018 (Let "eq" (Src 76966523831001 (Lam "fst_val" λxfst_val (Src 76966534316761 (Lam "snd_val" λxsnd_val (Src 76966544802521 (App (Src 76966545851074 (Book.Kind.num)) (Src 76966555288280 (Op2 EQ (Src 76966560531151 xfst_val) (Src 76966568919767 xsnd_val))))))))) λxeq (Src 76966585697762 (Let "ne" (Src 76966596182814 (Lam "fst_val" λxfst_val (Src 76966606668574 (Lam "snd_val" λxsnd_val (Src 76966617154334 (App (Src 76966618202887 (Book.Kind.num)) (Src 76966627640093 (Op2 NE (Src 76966632882964 xfst_val) (Src 76966641271580 xsnd_val))))))))) λxne (Src 76966658049506 (Let "lt" (Src 76966668534626 (Lam "fst_val" λxfst_val (Src 76966679020386 (Lam "snd_val" λxsnd_val (Src 76966689506146 (App (Src 76966690554700 (Book.Kind.num)) (Src 76966699991905 (Op2 LT (Src 76966704186200 xfst_val) (Src 76966712574816 xsnd_val))))))))) λxlt (Src 76966729352674 (Let "gt" (Src 76966739837862 (Lam "fst_val" λxfst_val (Src 76966750323622 (Lam "snd_val" λxsnd_val (Src 76966760809382 (App (Src 76966761857936 (Book.Kind.num)) (Src 76966771295141 (Op2 GT (Src 76966775489436 xfst_val) (Src 76966783878052 xsnd_val))))))))) λxgt (Src 76966800655842 (Let "lte" (Src 76966811141099 (Lam "fst_val" λxfst_val (Src 76966821626859 (Lam "snd_val" λxsnd_val (Src 76966832112619 (App (Src 76966833161172 (Book.Kind.num)) (Src 76966842598378 (Op2 LTE (Src 76966847841249 xfst_val) (Src 76966856229865 xsnd_val))))))))) λxlte (Src 76966873007586 (Let "gte" (Src 76966883492912 (Lam "fst_val" λxfst_val (Src 76966893978672 (Lam "snd_val" λxsnd_val (Src 76966904464432 (App (Src 76966905512985 (Book.Kind.num)) (Src 76966914950191 (Op2 GTE (Src 76966920193062 xfst_val) (Src 76966928581678 xsnd_val))))))))) λxgte (Src 76966945359330 (Let "and" (Src 76966955844724 (Lam "fst_val" λxfst_val (Src 76966966330484 (Lam "snd_val" λxsnd_val (Src 76966976816244 (App (Src 76966977864798 (Book.Kind.num)) (Src 76966987302003 (Op2 AND (Src 76966991496298 xfst_val) (Src 76966999884914 xsnd_val))))))))) λxand (Src 76967016662498 (Let "or" (Src 76967027147960 (Lam "fst_val" λxfst_val (Src 76967037633720 (Lam "snd_val" λxsnd_val (Src 76967048119480 (App (Src 76967049168034 (Book.Kind.num)) (Src 76967058605239 (Op2 OR (Src 76967062799534 xfst_val) (Src 76967071188150 xsnd_val))))))))) λxor (Src 76967087965666 (Let "xor" (Src 76967098451196 (Lam "fst_val" λxfst_val (Src 76967108936956 (Lam "snd_val" λxsnd_val (Src 76967119422716 (App (Src 76967120471270 (Book.Kind.num)) (Src 76967129908475 (Op2 XOR (Src 76967134102770 xfst_val) (Src 76967142491386 xsnd_val))))))))) λxxor (Src 76967159268834 (Let "lsh" (Src 76967169754433 (Lam "fst_val" λxfst_val (Src 76967180240193 (Lam "snd_val" λxsnd_val (Src 76967190725953 (App (Src 76967191774506 (Book.Kind.num)) (Src 76967201211712 (Op2 LSH (Src 76967206454583 xfst_val) (Src 76967214843199 xsnd_val))))))))) λxlsh (Src 76967231620578 (Let "rsh" (Src 76967242106246 (Lam "fst_val" λxfst_val (Src 76967252592006 (Lam "snd_val" λxsnd_val (Src 76967263077766 (App (Src 76967264126319 (Book.Kind.num)) (Src 76967273563525 (Op2 RSH (Src 76967278806396 xfst_val) (Src 76967287195012 xsnd_val))))))))) λxrsh (Src 76967303972322 (App (App (Src 76967305020881 (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (Src 76967306069395 (Ins (Src 76967307117971 xopr))) (Src 76967311312277 xP)) (Src 76967313409433 xadd)) (Src 76967317603741 xmul)) (Src 76967321798049 xsub)) (Src 76967325992357 xdiv)) (Src 76967330186665 xmod)) (Src 76967334380972 xeq)) (Src 76967337526703 xne)) (Src 76967340672434 xlt)) (Src 76967343818165 xgt)) (Src 76967346963897 xlte)) (Src 76967351158205 xgte)) (Src 76967355352513 xand)) (Src 76967359546820 xor)) (Src 76967362692552 xxor)) (Src 76967366886860 xlsh)) (Src 76967371081168 xrsh))) (Src 76967376324057 xfst_val)) (Src 76967384712673 xsnd_val))))))))))))))))))))))))))))))))))))))))) λxY (Src 76967398344264 (Let "N" (Src 76967406732836 (Lam "snd" λxsnd (Src 76967413024292 (Lam "fst_val" λxfst_val (Src 76967423510052 (App (App (App (Src 76967424558600 (Book.Kind.op2)) (Src 76967433995788 xopr)) (Src 76967438190111 (App (Src 76967439238678 (Book.Kind.num)) (Src 76967448675870 xfst_val)))) (Src 76967458113059 xsnd))))))) λxN (Src 76967467550280 (App (App (App (App (App (Src 76967468598837 (Book.Kind.if.num)) (Src 76967481181753 xsnd)) (Src 76967485376059 xP)) (Src 76967487473213 xY)) (Src 76967489570367 xN)) (Src 76967491667527 xfst_val))))))))))))) λxY (Src 76967503201939 (Let "N" (Src 76967511590517 (Lam "fst" λxfst (Src 76967517881973 (Lam "snd" λxsnd (Src 76967524173429 (App (App (App (Src 76967525221992 (Book.Kind.op2)) (Src 76967534659180 xopr)) (Src 76967538853488 xfst)) (Src 76967543047796 xsnd))))))) λxN (Src 76967550387859 (App (App (App (App (App (Src 76967551436420 (Book.Kind.if.num)) (Src 76967564019336 xfst)) (Src 76967568213642 xP)) (Src 76967570310796 xY)) (Src 76967572407950 xN)) (Src 76967574505106 xsnd))))))))))))))) (Src 76965832818781 (All "opr" (Src 76965842255908 (Book.Kind.Oper)) λxopr (Src 76965855887453 (All "fst" (Src 76965865324602 (Book.Kind.Term)) λxfst (Src 76965878956125 (All "snd" (Src 76965888393296 (Book.Kind.Term)) λxsnd (Src 76965902024797 (Book.Kind.Term))))))))))
Book.Kind.reduce.ref = (Ref "Kind.reduce.ref" [] (Ann (Src 78065417847055 (Lam "maj" λxmaj (Src 78065424138511 (Lam "nam" λxnam (Src 78065430429967 (Lam "val" λxval (Src 78065438818575 (Let "P" (Src 78065451401386 (Lam "x" λxx (Src 78065455595690 (All "nam" (Src 78065465032843 (Book.String)) λxnam (Src 78065473421482 (All "val" (Src 78065482858655 (Book.Kind.Term)) λxval (Src 78065494393002 (Book.Kind.Term)))))))) λxP (Src 78065506976015 (Let "true" (Src 78065519558874 (Lam "nam" λxnam (Src 78065525850330 (Lam "val" λxval (Src 78065532141786 (App (App (Src 78065533190353 (Book.Kind.reduce)) (Src 78065545773269 xmaj)) (Src 78065549967577 xval))))))) λxtrue (Src 78065557307663 (Let "false" (Src 78065569890545 (Book.Kind.ref)) λxfalse (Src 78065581424911 (App (App (App (App (App (Src 78065582473465 (Ins (Src 78065583522041 xmaj))) (Src 78065587716347 xP)) (Src 78065589813504 xtrue)) (Src 78065595056390 xfalse)) (Src 78065601347850 xnam)) (Src 78065605542158 xval))))))))))))))) (Src 78065344446549 (All "maj" (Src 78065353883679 (Book.Bool)) λxmaj (Src 78065362272341 (All "nam" (Src 78065371709490 (Book.String)) λxnam (Src 78065382195285 (All "val" (Src 78065391632456 (Book.Kind.Term)) λxval (Src 78065405263957 (Book.Kind.Term))))))))))
Book.Kind.reduce.txt = (Ref "Kind.reduce.txt" [] (Ann (Src 79164891726103 (Lam "txt" λxtxt (Src 79164900114711 (Let "P" (Src 79164911648852 (Lam "x" λxx (Src 79164915843156 (Book.Kind.Term)))) λxP (Src 79164928426263 (Let "cons" (Src 79164939960521 (Lam "x" λxx (Src 79164944154825 (Lam "xs" λxxs (Src 79164949397705 (App (App (Src 79164950446199 (Book.Kind.reduce)) (Src 79164963029121 (Book.Bool.true))) (Src 79164973514952 (App (App (Src 79164974563467 (Book.Kind.app)) (Src 79164984000697 (App (App (Src 79164985049237 (Book.Kind.app)) (Src 79164994486443 (Book.Kind.Book.String.cons))) (Src 79165017555128 (App (Src 79165018603701 (Book.Kind.num)) (Src 79165028040887 xx)))))) (Src 79165032235207 (App (Src 79165033283779 (Book.Kind.txt)) (Src 79165042720966 xxs))))))))))) λxcons (Src 79165051109655 (Let "nil" (Src 79165062643971 (App (App (Src 79165063692515 (Book.Kind.reduce)) (Src 79165076275437 (Book.Bool.true))) (Src 79165086761218 (Book.Kind.Book.String.nil)))) λxnil (Src 79165111927063 (App (App (App (Src 79165112975627 (Ins (Src 79165114024203 xtxt))) (Src 79165118218509 xP)) (Src 79165120315666 xcons)) (Src 79165125558550 xnil))))))))))) (Src 79164856074289 (All "txt" (Src 79164865511460 (Book.Kind.Text)) λxtxt (Src 79164879142961 (Book.Kind.Term))))))
Book.Kind.ref = (Ref "Kind.ref" [] (Ann (Src 52776625242306 (Lam "nam" λxnam (Src 52776631533762 (Lam "val" λxval (Src 52776639922370 (Ins (Src 52776640970946 (Lam "P" λxP (Src 52776645165250 (Lam "all" λxall (Src 52776651456706 (Lam "lam" λxlam (Src 52776657748162 (Lam "app" λxapp (Src 52776664039618 (Lam "ann" λxann (Src 52776670331074 (Lam "slf" λxslf (Src 52776676622530 (Lam "ins" λxins (Src 52776682913986 (Lam "ref" λxref (Src 52776689205442 (Lam "def" λxdef (Src 52776695496898 (Lam "set" λxset (Src 52776701788354 (Lam "u60" λxu60 (Src 52776708079810 (Lam "num" λxnum (Src 52776714371266 (Lam "op2" λxop2 (Src 52776720662722 (Lam "mat" λxmat (Src 52776726954178 (Lam "txt" λxtxt (Src 52776733245634 (Lam "hol" λxhol (Src 52776739537090 (Lam "var" λxvar (Src 52776747925698 (App (App (Src 52776748974265 xref) (Src 52776753168573 xnam)) (Src 52776757362881 xval))))))))))))))))))))))))))))))))))))))))))) (Src 52776569667645 (All "nam" (Src 52776579104794 (Book.String)) λxnam (Src 52776589590589 (All "val" (Src 52776599027760 (Book.Kind.Term)) λxval (Src 52776612659261 (Book.Kind.Term))))))))
Book.Kind.report = (Ref "Kind.report" [] (Ann (Src 112150335980091 (Lam "e" λxe (Src 112150340174395 (Lam "inferred" λxinferred (Src 112150351708731 (Lam "expected" λxexpected (Src 112150363243067 (Lam "value" λxvalue (Src 112150371631675 (Lam "dep" λxdep (Src 112150380020283 (Let "pure" (Src 112150392602843 (App (Src 112150393651408 (Book.Maybe.some)) (Src 112150405185754 (Book.Kind.Term)))) λxpure (Src 112150419866171 (Let "none" (Src 112150432448769 (App (Src 112150433497334 (Book.Maybe.none)) (Src 112150445031680 (Book.Kind.Term)))) λxnone (Src 112150458663483 (Let "P" (Src 112150471246203 (Lam "x" λxx (Src 112150475440507 (All "inferred" (Src 112150490120491 (Book.Kind.Term)) λxinferred (Src 112150501654907 (All "expected" (Src 112150516334916 (Book.Kind.Term)) λxexpected (Src 112150527869307 (All "value" (Src 112150539403610 (Book.Kind.Term)) λxvalue (Src 112150550937979 (All "dep" (Src 112150560375144 (Book.Nat)) λxdep (Src 112150565618043 (App (Src 112150566666608 (Book.Maybe)) (Src 112150572958074 (Book.Kind.Term)))))))))))))) λxP (Src 112150586589755 (Let "true" (Src 112150599172541 (Lam "inferred" λxinferred (Src 112150610706877 (Lam "expected" λxexpected (Src 112150622241213 (Lam "value" λxvalue (Src 112150630629821 (Lam "dep" λxdep (Src 112150636921277 (App (Src 112150637969843 xpure) (Src 112150643212732 (Book.Kind.set)))))))))))) λxtrue (Src 112150655795771 (Let "false" (Src 112150668378612 (Lam "inferred" λxinferred (Src 112150679912948 (Lam "expected" λxexpected (Src 112150691447284 (Lam "value" λxvalue (Src 112150699835892 (Lam "dep" λxdep (Src 112150706127348 xnone))))))))) λxfalse (Src 112150737584699 (App (App (App (App (App (App (App (Src 112150738633233 (Ins (Src 112150739681809 xe))) (Src 112150741778963 xP)) (Src 112150743876120 xtrue)) (Src 112150749119006 xfalse)) (Src 112150755410471 xinferred)) (Src 112150764847664 xexpected)) (Src 112150774284854 xvalue)) (Src 112150780576314 xdep))))))))))))))))))))))) (Src 112150200713356 (All "e" (Src 112150208053273 (Book.Bool)) λxe (Src 112150216441996 (All "inferred" (Src 112150231121972 (Book.Kind.Term)) λxinferred (Src 112150244753548 (All "expected" (Src 112150259433551 (Book.Kind.Term)) λxexpected (Src 112150273065100 (All "value" (Src 112150284599399 (Book.Kind.Term)) λxvalue (Src 112150298230924 (All "dep" (Src 112150307668087 (Book.Nat)) λxdep (Src 112150315008140 (App (Src 112150316056705 (Book.Maybe)) (Src 112150322348171 (Book.Kind.Term))))))))))))))))
Book.Kind.set = (Ref "Kind.set" [] (Ann (Src 53876093878403 (Ins (Src 53876094926979 (Lam "P" λxP (Src 53876099121283 (Lam "all" λxall (Src 53876105412739 (Lam "lam" λxlam (Src 53876111704195 (Lam "app" λxapp (Src 53876117995651 (Lam "ann" λxann (Src 53876124287107 (Lam "slf" λxslf (Src 53876130578563 (Lam "ins" λxins (Src 53876136870019 (Lam "ref" λxref (Src 53876143161475 (Lam "def" λxdef (Src 53876149452931 (Lam "set" λxset (Src 53876155744387 (Lam "u60" λxu60 (Src 53876162035843 (Lam "num" λxnum (Src 53876168327299 (Lam "op2" λxop2 (Src 53876174618755 (Lam "mat" λxmat (Src 53876180910211 (Lam "txt" λxtxt (Src 53876187201667 (Lam "hol" λxhol (Src 53876193493123 (Lam "var" λxvar (Src 53876201881731 (Src 53876202930306 xset)))))))))))))))))))))))))))))))))))))) (Src 53876081295380 (Book.Kind.Term))))
Book.Kind.skip = (Ref "Kind.skip" [] (Ann (Src 106652674032161 (Lam "x" λxx (Src 106652680323617 (Let "P" (Src 106652690808905 (Lam "x" λxx (Src 106652695003209 (Book.Kind.Term)))) λxP (Src 106652707586593 (Let "all" (Src 106652718071902 (Book.Kind.all)) λxall (Src 106652729606689 (Let "lam" (Src 106652740092019 (Book.Kind.lam)) λxlam (Src 106652751626785 (Let "app" (Src 106652762112136 (Book.Kind.app)) λxapp (Src 106652773646881 (Let "ann" (Src 106652784132272 (Lam "val" λxval (Src 106652790423728 (Lam "typ" λxtyp (Src 106652796715184 (App (Src 106652797763755 (Book.Kind.skip)) (Src 106652808249519 xval))))))) λxann (Src 106652815589921 (Let "slf" (Src 106652826075333 (Book.Kind.slf)) λxslf (Src 106652837610017 (Let "ins" (Src 106652848095463 (Lam "val" λxval (Src 106652854386919 (App (Src 106652855435490 (Book.Kind.skip)) (Src 106652865921254 xval))))) λxins (Src 106652873261601 (Let "ref" (Src 106652883747068 (Book.Kind.ref)) λxref (Src 106652895281697 (Let "def" (Src 106652905767216 (Lam "nam" λxnam (Src 106652912058672 (Lam "val" λxval (Src 106652918350128 (Lam "bod" λxbod (Src 106652924641584 (App (Src 106652925690149 (Book.Kind.skip)) (Src 106652936175919 (App (Src 106652937224490 xbod) (Src 106652941418798 xval))))))))))) λxdef (Src 106652949807649 (Let "set" (Src 106652960293189 (Book.Kind.set)) λxset (Src 106652971827745 (Let "u60" (Src 106652982313306 (Book.Kind.u60)) λxu60 (Src 106652993847841 (Let "num" (Src 106653004333423 (Book.Kind.num)) λxnum (Src 106653015867937 (Let "op2" (Src 106653026353540 (Book.Kind.op2)) λxop2 (Src 106653037888033 (Let "mat" (Src 106653048373657 (Book.Kind.mat)) λxmat (Src 106653059908129 (Let "txt" (Src 106653070393774 (Book.Kind.txt)) λxtxt (Src 106653081928225 (Let "hol" (Src 106653092413891 (Book.Kind.hol)) λxhol (Src 106653103948321 (Let "var" (Src 106653114434008 (Book.Kind.var)) λxvar (Src 106653125968417 (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (App (Src 106653127016926 (Ins (Src 106653128065502 xx))) (Src 106653130162656 xP)) (Src 106653132259812 xall)) (Src 106653136454120 xlam)) (Src 106653140648428 xapp)) (Src 106653144842736 xann)) (Src 106653149037044 xslf)) (Src 106653153231352 xins)) (Src 106653157425660 xref)) (Src 106653161619968 xdef)) (Src 106653165814276 xset)) (Src 106653170008584 xu60)) (Src 106653174202892 xnum)) (Src 106653178397200 xop2)) (Src 106653182591508 xmat)) (Src 106653186785816 xtxt)) (Src 106653190980124 xhol)) (Src 106653195174432 xvar))))))))))))))))))))))))))))))))))))))) (Src 106652640477225 (All "x" (Src 106652647817244 (Book.Kind.Term)) λxx (Src 106652661448745 (Book.Kind.Term))))))
Book.Kind.slf = (Ref "Kind.slf" [] (Ann (Src 54975667372244 (Lam "nam" λxnam (Src 54975673663700 (Lam "bod" λxbod (Src 54975682052308 (Ins (Src 54975683100884 (Lam "P" λxP (Src 54975687295188 (Lam "all" λxall (Src 54975693586644 (Lam "lam" λxlam (Src 54975699878100 (Lam "app" λxapp (Src 54975706169556 (Lam "ann" λxann (Src 54975712461012 (Lam "slf" λxslf (Src 54975718752468 (Lam "ins" λxins (Src 54975725043924 (Lam "ref" λxref (Src 54975731335380 (Lam "def" λxdef (Src 54975737626836 (Lam "set" λxset (Src 54975743918292 (Lam "u60" λxu60 (Src 54975750209748 (Lam "num" λxnum (Src 54975756501204 (Lam "op2" λxop2 (Src 54975762792660 (Lam "mat" λxmat (Src 54975769084116 (Lam "txt" λxtxt (Src 54975775375572 (Lam "hol" λxhol (Src 54975781667028 (Lam "var" λxvar (Src 54975790055636 (App (App (Src 54975791104203 xslf) (Src 54975795298511 xnam)) (Src 54975799492819 xbod))))))))))))))))))))))))))))))))))))))))))) (Src 54975592923215 (All "nam" (Src 54975602360346 (Book.String)) λxnam (Src 54975612846159 (All "bod" (Src 54975622283330 (All "x" (Src 54975629623351 (Book.Kind.Term)) λxx (Src 54975641157698 (Book.Kind.Term)))) λxbod (Src 54975654789199 (Book.Kind.Term))))))))
Book.Kind.txt = (Ref "Kind.txt" [] (Ann (Src 56075140202661 (Lam "lit" λxlit (Src 56075148591269 (Ins (Src 56075149639845 (Lam "P" λxP (Src 56075153834149 (Lam "all" λxall (Src 56075160125605 (Lam "lam" λxlam (Src 56075166417061 (Lam "app" λxapp (Src 56075172708517 (Lam "ann" λxann (Src 56075178999973 (Lam "slf" λxslf (Src 56075185291429 (Lam "ins" λxins (Src 56075191582885 (Lam "ref" λxref (Src 56075197874341 (Lam "def" λxdef (Src 56075204165797 (Lam "set" λxset (Src 56075210457253 (Lam "u60" λxu60 (Src 56075216748709 (Lam "num" λxnum (Src 56075223040165 (Lam "op2" λxop2 (Src 56075229331621 (Lam "mat" λxmat (Src 56075235623077 (Lam "txt" λxtxt (Src 56075241914533 (Lam "hol" λxhol (Src 56075248205989 (Lam "var" λxvar (Src 56075256594597 (App (Src 56075257643168 xtxt) (Src 56075261837476 xlit))))))))))))))))))))))))))))))))))))))))) (Src 56075104550954 (All "lit" (Src 56075113988125 (Book.Kind.Text)) λxlit (Src 56075127619626 (Book.Kind.Term))))))
Book.Kind.u60 = (Ref "Kind.u60" [] (Ann (Src 57174628761729 (Ins (Src 57174629810305 (Lam "P" λxP (Src 57174634004609 (Lam "all" λxall (Src 57174640296065 (Lam "lam" λxlam (Src 57174646587521 (Lam "app" λxapp (Src 57174652878977 (Lam "ann" λxann (Src 57174659170433 (Lam "slf" λxslf (Src 57174665461889 (Lam "ins" λxins (Src 57174671753345 (Lam "ref" λxref (Src 57174678044801 (Lam "def" λxdef (Src 57174684336257 (Lam "set" λxset (Src 57174690627713 (Lam "u60" λxu60 (Src 57174696919169 (Lam "num" λxnum (Src 57174703210625 (Lam "op2" λxop2 (Src 57174709502081 (Lam "mat" λxmat (Src 57174715793537 (Lam "txt" λxtxt (Src 57174722084993 (Lam "hol" λxhol (Src 57174728376449 (Lam "var" λxvar (Src 57174736765057 xu60))))))))))))))))))))))))))))))))))))) (Src 57174616178708 (Book.Kind.Term))))
Book.Kind.var = (Ref "Kind.var" [] (Ann (Src 58274177089724 (Lam "nam" λxnam (Src 58274183381180 (Lam "idx" λxidx (Src 58274191769788 (Ins (Src 58274192818364 (Lam "P" λxP (Src 58274197012668 (Lam "all" λxall (Src 58274203304124 (Lam "lam" λxlam (Src 58274209595580 (Lam "app" λxapp (Src 58274215887036 (Lam "ann" λxann (Src 58274222178492 (Lam "slf" λxslf (Src 58274228469948 (Lam "ins" λxins (Src 58274234761404 (Lam "ref" λxref (Src 58274241052860 (Lam "def" λxdef (Src 58274247344316 (Lam "set" λxset (Src 58274253635772 (Lam "u60" λxu60 (Src 58274259927228 (Lam "num" λxnum (Src 58274266218684 (Lam "op2" λxop2 (Src 58274272510140 (Lam "mat" λxmat (Src 58274278801596 (Lam "txt" λxtxt (Src 58274285093052 (Lam "hol" λxhol (Src 58274291384508 (Lam "var" λxvar (Src 58274299773116 (App (App (Src 58274300821683 xvar) (Src 58274305015991 xnam)) (Src 58274309210299 xidx))))))))))))))))))))))))))))))))))))))))))) (Src 58274127806519 (All "nam" (Src 58274137243674 (Book.String)) λxnam (Src 58274147729463 (All "idx" (Src 58274157166634 (Book.Nat)) λxidx (Src 58274164506679 (Book.Kind.Term))))))))
Book.Kind.verify = (Ref "Kind.verify" [] (Ann (Src 89060542513489 (Lam "term" λxterm (Src 89060549853521 (Lam "type" λxtype (Src 89060557193553 (Lam "dep" λxdep (Src 89060565582161 (Let "bind" (Src 89060577116321 (App (App (Src 89060578164876 (Book.Maybe.bind)) (Src 89060589699222 (Book.Kind.Term))) (Src 89060600184992 (Book.Kind.Term)))) λxbind (Src 89060613816657 (Let "pure" (Src 89060625350853 (App (Src 89060626399418 (Book.Maybe.some)) (Src 89060637933764 (Book.Kind.Term)))) λxpure (Src 89060652613969 (Let "none" (Src 89060664148202 (App (Src 89060665196767 (Book.Maybe.none)) (Src 89060676731113 (Book.Kind.Term)))) λxnone (Src 89060690362705 (App (App (Src 89060691411186 xbind) (Src 89060696654088 (App (App (Src 89060697702654 (Book.Kind.infer)) (Src 89060709236995 xterm)) (Src 89060714479879 xdep)))) (Src 89060719722832 (Lam "infer" λxinfer (Src 89060730208592 (App (App (App (App (App (Src 89060731257119 (Book.Kind.report)) (Src 89060743840059 (App (App (App (Src 89060744888619 (Book.Kind.equal)) (Src 89060756422961 xinfer)) (Src 89060762714422 xtype)) (Src 89060767957306 xdep)))) (Src 89060773200193 xinfer)) (Src 89060779491654 xtype)) (Src 89060784734539 xterm)) (Src 89060789977423 xdep))))))))))))))))))) (Src 89060456530013 (All "term" (Src 89060467015713 (Book.Kind.Term)) λxterm (Src 89060480647261 (All "type" (Src 89060491132984 (Book.Kind.Term)) λxtype (Src 89060504764509 (All "dep" (Src 89060514201672 (Book.Nat)) λxdep (Src 89060521541725 (App (Src 89060522590290 (Book.Maybe)) (Src 89060528881756 (Book.Kind.Term))))))))))))
Book.List = (Ref "List" [] (Ann (Src 7696605511870 (Lam "T" λxT (Src 7696611803326 (Slf "self" (Src 7696620191789 (App (Src 7696621240362 (Book.List)) (Src 7696626483244 xT))) λxself (Src 7696632774846 (All "P" (Src 7696640114763 (All "xs" (Src 7696648503368 (App (Src 7696649551941 (Book.List)) (Src 7696654794823 xT))) λxxs (Src 7696658989131 (Set)))) λxP (Src 7696664232126 (All "cons" (Src 7696674717845 (All "head" (Src 7696685203556 xT) λxhead (Src 7696688349333 (All "tail" (Src 7696698835064 (App (Src 7696699883637 (Book.List)) (Src 7696705126519 xT))) λxtail (Src 7696709320853 (App (Src 7696710369404 xP) (Src 7696712466580 (App (App (App (Src 7696713515143 (Book.List.cons)) (Src 7696724000905 xT)) (Src 7696726098062 xhead)) (Src 7696731340947 xtail))))))))) λxcons (Src 7696741826750 (All "nil" (Src 7696751263922 (App (Src 7696752312484 xP) (Src 7696754409649 (App (Src 7696755458222 (Book.List.nil)) (Src 7696764895408 xT))))) λxnil (Src 7696772235454 (App (Src 7696773284024 xP) (Src 7696775381181 xself))))))))))))) (Src 7696588734484 (All "T" (Src 7696596074511 (Set)) λxT (Src 7696601317396 (Set))))))
Book.List.concat = (Ref "List.concat" [] (Ann (Src 87961010962685 (Lam "T" λxT (Src 87961015156989 (Lam "xs" λxxs (Src 87961020399869 (Lam "ys" λxys (Src 87961027739901 (Let "P" (Src 87961039274119 (Lam "xs" λxxs (Src 87961044516999 (All "ys" (Src 87961052905597 (App (Src 87961053954170 (Book.List)) (Src 87961059197052 xT))) λxys (Src 87961063391367 (App (Src 87961064439940 (Book.List)) (Src 87961069682822 xT))))))) λxP (Src 87961074925821 (Let "cons" (Src 87961086460114 (Lam "head" λxhead (Src 87961093800146 (Lam "tail" λxtail (Src 87961101140178 (Lam "ys" λxys (Src 87961106383058 (App (App (App (Src 87961107431602 (Book.List.cons)) (Src 87961117917364 xT)) (Src 87961120014521 xhead)) (Src 87961125257425 (App (App (App (Src 87961126305990 (Book.List.concat)) (Src 87961138888904 xT)) (Src 87961140986061 xtail)) (Src 87961146228944 xys))))))))))) λxcons (Src 87961153569021 (Let "nil" (Src 87961165103335 (Lam "ys" λxys (Src 87961170346215 xys))) λxnil (Src 87961175589117 (App (App (App (App (Src 87961176637678 (Ins (Src 87961177686254 xxs))) (Src 87961180831984 xP)) (Src 87961182929141 xcons)) (Src 87961188172025 xnil)) (Src 87961192366332 xys))))))))))))))) (Src 87960944902218 (All "T" (Src 87960952242198 (Set)) λxT (Src 87960957485130 (All "xs" (Src 87960965873706 (App (Src 87960966922279 (Book.List)) (Src 87960972165161 xT))) λxxs (Src 87960978456650 (All "ys" (Src 87960986845246 (App (Src 87960987893819 (Book.List)) (Src 87960993136701 xT))) λxys (Src 87960999428170 (App (Src 87961000476743 (Book.List)) (Src 87961005719625 xT)))))))))))
Book.List.cons = (Ref "List.cons" [] (Ann (Src 8796168519808 (Lam "T" λxT (Src 8796172714112 (Lam "head" λxhead (Src 8796180054144 (Lam "tail" λxtail (Src 8796189491328 (Ins (Src 8796190539904 (Lam "P" λxP (Src 8796194734208 (Lam "cons" λxcons (Src 8796202074240 (Lam "nil" λxnil (Src 8796210462848 (App (App (Src 8796211511413 xcons) (Src 8796216754298 xhead)) (Src 8796221997183 xtail))))))))))))))))) (Src 8796105605189 (All "T" (Src 8796112945172 (Set)) λxT (Src 8796118188101 (All "head" (Src 8796128673827 xT) λxhead (Src 8796133916741 (All "tail" (Src 8796144402489 (App (Src 8796145451062 (Book.List)) (Src 8796150693944 xT))) λxtail (Src 8796156985413 (App (Src 8796158033986 (Book.List)) (Src 8796163276868 xT)))))))))))
Book.List.nil = (Ref "List.nil" [] (Ann (Src 9895640301631 (Lam "T" λxT (Src 9895646593087 (Ins (Src 9895647641663 (Lam "P" λxP (Src 9895651835967 (Lam "cons" λxcons (Src 9895659175999 (Lam "nil" λxnil (Src 9895667564607 xnil))))))))))) (Src 9895616184351 (All "T" (Src 9895623524371 (Set)) λxT (Src 9895628767263 (App (Src 9895629815836 (Book.List)) (Src 9895635058718 xT)))))))
Book.Maybe = (Ref "Maybe" [] (Ann (Src 82463397249197 (Lam "T" λxT (Src 82463403540653 (Slf "self" (Src 82463411929135 (App (Src 82463412977708 (Book.Maybe)) (Src 82463419269166 xT))) λxself (Src 82463425560749 (All "P" (Src 82463432900685 (All "x" (Src 82463440240714 (App (Src 82463441289287 (Book.Maybe)) (Src 82463447580745 xT))) λxx (Src 82463451775053 (Set)))) λxP (Src 82463457018029 (All "some" (Src 82463467503745 (All "value" (Src 82463479038055 xT) λxvalue (Src 82463482183809 (App (Src 82463483232363 xP) (Src 82463485329536 (App (App (Src 82463486378103 (Book.Maybe.some)) (Src 82463497912441 xT)) (Src 82463500009599 xvalue))))))) λxsome (Src 82463511543981 (All "none" (Src 82463522029729 (App (Src 82463523078289 xP) (Src 82463525175456 (App (Src 82463526224029 (Book.Maybe.none)) (Src 82463537758367 xT))))) λxnone (Src 82463545098413 (App (Src 82463546146983 xP) (Src 82463548244140 xself))))))))))))) (Src 82463380471829 (All "T" (Src 82463387811856 (Set)) λxT (Src 82463393054741 (Set))))))
Book.Maybe.bind = (Ref "Maybe.bind" [] (Ann (Src 85762010775813 (Lam "A" λxA (Src 85762014970117 (Lam "B" λxB (Src 85762019164421 (Lam "a" λxa (Src 85762023358725 (Lam "b" λxb (Src 85762029650181 (Let "P" (Src 85762041184425 (Lam "x" λxx (Src 85762045378729 (All "b" (Src 85762052718750 (All "x" (Src 85762060058771 xA) λxx (Src 85762063204510 (App (Src 85762064253083 (Book.Maybe)) (Src 85762070544541 xB))))) λxb (Src 85762074738857 (App (Src 85762075787430 (Book.Maybe)) (Src 85762082078888 xB))))))) λxP (Src 85762087321861 (Let "some" (Src 85762098856144 (Lam "a.value" λxa.value (Src 85762109341904 (Lam "b" λxb (Src 85762113536208 (App (Src 85762114584775 xb) (Src 85762116681935 xa.value))))))) λxsome (Src 85762128216325 (Let "none" (Src 85762139750640 (Lam "b" λxb (Src 85762143944944 (App (Src 85762144993517 (Book.Maybe.none)) (Src 85762156527855 xB))))) λxnone (Src 85762161770757 (App (App (App (App (Src 85762162819318 (Ins (Src 85762163867894 xa))) (Src 85762165965048 xP)) (Src 85762168062205 xsome)) (Src 85762173305090 xnone)) (Src 85762178547972 xb))))))))))))))))) (Src 85761920598112 (All "A" (Src 85761927938069 (Set)) λxA (Src 85761933181024 (All "B" (Src 85761940520993 (Set)) λxB (Src 85761945763936 (All "a" (Src 85761953103925 (App (Src 85761954152498 (Book.Maybe)) (Src 85761960443956 xA))) λxa (Src 85761966735456 (All "b" (Src 85761974075475 (All "x" (Src 85761981415496 xA) λxx (Src 85761984561235 (App (Src 85761985609808 (Book.Maybe)) (Src 85761991901266 xB))))) λxb (Src 85761998192736 (App (Src 85761999241309 (Book.Maybe)) (Src 85762005532767 xB)))))))))))))
Book.Maybe.none = (Ref "Maybe.none" [] (Ann (Src 83562923556933 (Lam "T" λxT (Src 83562929848389 (Ins (Src 83562930896965 (Lam "P" λxP (Src 83562935091269 (Lam "some" λxsome (Src 83562942431301 (Lam "none" λxnone (Src 83562951868485 xnone))))))))))) (Src 83562897342498 (All "T" (Src 83562904682517 (Set)) λxT (Src 83562909925410 (App (Src 83562910973983 (Book.Maybe)) (Src 83562917265441 xT)))))))
Book.Maybe.some = (Ref "Maybe.some" [] (Ann (Src 84662451961957 (Lam "T" λxT (Src 84662456156261 (Lam "value" λxvalue (Src 84662466642021 (Ins (Src 84662467690597 (Lam "P" λxP (Src 84662471884901 (Lam "some" λxsome (Src 84662479224933 (Lam "none" λxnone (Src 84662488662117 (App (Src 84662489710686 xsome) (Src 84662494953572 xvalue))))))))))))))) (Src 84662408970290 (All "T" (Src 84662416310293 (Set)) λxT (Src 84662421553202 (All "value" (Src 84662433087525 xT) λxvalue (Src 84662438330418 (App (Src 84662439378991 (Book.Maybe)) (Src 84662445670449 xT)))))))))
Book.Nat = (Ref "Nat" [] (Ann (Src 59373638385789 (Slf "self" (Src 59373646774293 (Book.Nat)) λxself (Src 59373654114429 (All "P" (Src 59373661454381 (All "n" (Src 59373668794410 (Book.Nat)) λxn (Src 59373674037293 (Set)))) λxP (Src 59373679280253 (All "succ" (Src 59373689765975 (All "n" (Src 59373697105989 (Book.Nat)) λxn (Src 59373702348887 (App (Src 59373703397449 xP) (Src 59373705494614 (App (Src 59373706543187 (Book.Nat.succ)) (Src 59373715980373 xn))))))) λxsucc (Src 59373723320445 (All "zero" (Src 59373733806193 (App (Src 59373734854759 xP) (Src 59373736951920 (Book.Nat.zero)))) λxzero (Src 59373750583421 (App (Src 59373751631991 xP) (Src 59373753729148 xself))))))))))) (Src 59373634191367 (Set))))
Book.Nat.equal = (Ref "Nat.equal" [] (Ann (Src 107752188805544 (Lam "a" λxa (Src 107752192999848 (Lam "b" λxb (Src 107752199291304 (Let "P" (Src 107752210825306 (Lam "x" λxx (Src 107752215019610 (All "b" (Src 107752222359634 (Book.Nat)) λxb (Src 107752227602522 (Src 107752228651097 (Book.Bool))))))) λxP (Src 107752237040040 (Let "succ" (Src 107752248574233 (Lam "a.pred" λxa.pred (Src 107752258011417 (Lam "b" λxb (Src 107752266400025 (Let "P" (Src 107752277934239 (Lam "x" λxx (Src 107752282128543 (All "a.pred" (Src 107752294711447 (Book.Nat)) λxa.pred (Src 107752299954335 (Src 107752301002910 (Book.Bool))))))) λxP (Src 107752311488793 (Let "succ" (Src 107752323023066 (Lam "b.pred" λxb.pred (Src 107752332460250 (Lam "a.pred" λxa.pred (Src 107752341897434 (App (App (Src 107752342945995 (Book.Nat.equal)) (Src 107752353431762 xa.pred)) (Src 107752360771801 xb.pred))))))) λxsucc (Src 107752373354777 (Let "zero" (Src 107752384889085 (Lam "a.pred" λxa.pred (Src 107752394326269 (Book.Bool.false)))) λxzero (Src 107752410054937 (App (App (App (App (Src 107752411103493 (Ins (Src 107752412152069 xb))) (Src 107752414249223 xP)) (Src 107752416346380 xsucc)) (Src 107752421589265 xzero)) (Src 107752426832152 xa.pred))))))))))))) λxsucc (Src 107752437318056 (Let "zero" (Src 107752448852371 (Lam "b" λxb (Src 107752457240979 (Let "P" (Src 107752468775234 (Lam "x" λxx (Src 107752472969538 (Book.Bool)))) λxP (Src 107752482406803 (Let "succ" (Src 107752493941093 (Lam "b.pred" λxb.pred (Src 107752503378277 (Book.Bool.false)))) λxsucc (Src 107752519106963 (Let "zero" (Src 107752530641278 (Book.Bool.true)) λxzero (Src 107752545321363 (App (App (App (Src 107752546369926 (Ins (Src 107752547418502 xb))) (Src 107752549515656 xP)) (Src 107752551612813 xsucc)) (Src 107752556855698 xzero))))))))))) λxzero (Src 107752565244328 (App (App (App (App (Src 107752566292889 (Ins (Src 107752567341465 xa))) (Src 107752569438619 xP)) (Src 107752571535776 xsucc)) (Src 107752576778661 xzero)) (Src 107752582021543 xb))))))))))))) (Src 107752152105004 (All "a" (Src 107752159445014 (Book.Nat)) λxa (Src 107752166785068 (All "b" (Src 107752174125092 (Book.Nat)) λxb (Src 107752181465132 (Book.Bool))))))))
Book.Nat.succ = (Ref "Nat.succ" [] (Ann (Src 60473169936448 (Lam "n" λxn (Src 60473176227904 (Ins (Src 60473177276480 (Lam "P" λxP (Src 60473181470784 (Lam "succ" λxsucc (Src 60473188810816 (Lam "zero" λxzero (Src 60473198248000 (App (Src 60473199296573 xsucc) (Src 60473204539455 xn))))))))))))) (Src 60473151062042 (All "n" (Src 60473158402069 (Book.Nat)) λxn (Src 60473163644954 (Book.Nat))))))
Book.Nat.zero = (Ref "Nat.zero" [] (Ann (Src 61572668981290 (Ins (Src 61572670029866 (Lam "P" λxP (Src 61572674224170 (Lam "succ" λxsucc (Src 61572681564202 (Lam "zero" λxzero (Src 61572691001386 xzero))))))))) (Src 61572662689806 (Book.Nat))))
Book.String = (Ref "String" [] (Ann (Src 5497571770392 (App (Src 5497572818962 (Book.List)) (Src 5497578061847 (Book.Char)))) (Src 5497567576074 (Set))))
Book.String.concat = (Ref "String.concat" [] (Ann (Src 86861482557519 (App (Src 86861483606089 (Book.List.concat)) (Src 86861496189006 (Book.Char)))) (Src 86861435371578 (All "xs" (Src 86861443760158 (Book.String)) λxxs (Src 86861454245946 (All "ys" (Src 86861462634544 (Book.String)) λxys (Src 86861473120314 (Book.String))))))))
Book.String.cons = (Ref "String.cons" [] (Ann (Src 115448784879729 (Lam "head" λxhead (Src 115448792219761 (Lam "tail" λxtail (Src 115448801656945 (Ins (Src 115448802705521 (Lam "P" λxP (Src 115448806899825 (Lam "cons" λxcons (Src 115448814239857 (Lam "nil" λxnil (Src 115448822628465 (App (App (Src 115448823677030 xcons) (Src 115448828919915 xhead)) (Src 115448834162800 xtail))))))))))))))) (Src 115448735596602 (All "head" (Src 115448746082332 (Book.Char)) λxhead (Src 115448754470970 (All "tail" (Src 115448764956720 (Book.String)) λxtail (Src 115448775442490 (Book.String))))))))
Book.String.equal = (Ref "String.equal" [] (Ann (Src 108851709870626 (Lam "a" λxa (Src 108851714064930 (Lam "b" λxb (Src 108851720356386 (Let "P" (Src 108851731890278 (Lam "x" λxx (Src 108851736084582 (All "b" (Src 108851743424606 (Book.String)) λxb (Src 108851751813222 (Src 108851752861797 (Book.Bool))))))) λxP (Src 108851761250850 (Let "cons" (Src 108851772785036 (Lam "a.head" λxa.head (Src 108851782222220 (Lam "a.tail" λxa.tail (Src 108851791659404 (Lam "b" λxb (Src 108851800048012 (Let "P" (Src 108851811582153 (Lam "x" λxx (Src 108851815776457 (All "a.head" (Src 108851828359341 (Book.Char)) λxa.head (Src 108851834650825 (All "a.tail" (Src 108851847233729 (Book.String)) λxa.tail (Src 108851855622345 (Src 108851856670920 (Book.Bool))))))))) λxP (Src 108851867156876 (Let "cons" (Src 108851878691134 (Lam "b.head" λxb.head (Src 108851888128318 (Lam "b.tail" λxb.tail (Src 108851897565502 (Lam "a.head" λxa.head (Src 108851907002686 (Lam "a.tail" λxa.tail (Src 108851916439870 (App (App (Src 108851917488390 (Book.Bool.and)) (Src 108851926925600 (App (App (Src 108851927974161 (Book.U60.equal)) (Src 108851938459928 xa.head)) (Src 108851945799967 xb.head)))) (Src 108851954188605 (App (App (Src 108851955237166 (Book.String.equal)) (Src 108851968868661 xa.tail)) (Src 108851976208700 xb.tail))))))))))))) λxcons (Src 108851989840268 (Let "nil" (Src 108852001374570 (Lam "a.head" λxa.head (Src 108852010811754 (Lam "a.tail" λxa.tail (Src 108852020248938 (Book.Bool.false)))))) λxnil (Src 108852035977612 (App (App (App (App (App (Src 108852037026162 (Ins (Src 108852038074738 xb))) (Src 108852040171892 xP)) (Src 108852042269049 xcons)) (Src 108852047511933 xnil)) (Src 108852051706244 xa.head)) (Src 108852059046283 xa.tail))))))))))))))) λxcons (Src 108852069532194 (Let "nil" (Src 108852081066510 (Lam "b" λxb (Src 108852089455118 (Let "P" (Src 108852100989365 (Lam "x" λxx (Src 108852105183669 (Book.Bool)))) λxP (Src 108852114620942 (Let "cons" (Src 108852126155233 (Lam "b.head" λxb.head (Src 108852135592417 (Lam "b.tail" λxb.tail (Src 108852145029601 (Book.Bool.false)))))) λxcons (Src 108852160758286 (Let "nil" (Src 108852172292602 (Book.Bool.true)) λxnil (Src 108852186972686 (App (App (App (Src 108852188021250 (Ins (Src 108852189069826 xb))) (Src 108852191166980 xP)) (Src 108852193264137 xcons)) (Src 108852198507021 xnil))))))))))) λxnil (Src 108852205847074 (App (App (App (App (Src 108852206895636 (Ins (Src 108852207944212 xa))) (Src 108852210041366 xP)) (Src 108852212138523 xcons)) (Src 108852217381407 xnil)) (Src 108852221575713 xb))))))))))))) (Src 108851666878517 (All "a" (Src 108851674218524 (Book.String)) λxa (Src 108851684704309 (All "b" (Src 108851692044333 (Book.String)) λxb (Src 108851702530101 (Book.Bool))))))))
Book.String.nil = (Ref "String.nil" [] (Ann (Src 17592209113133 (Ins (Src 17592210161709 (Lam "P" λxP (Src 17592214356013 (Lam "cons" λxcons (Src 17592221696045 (Lam "nil" λxnil (Src 17592230084653 xnil))))))))) (Src 17592199675923 (Book.String))))
Book.U60.equal = (Ref "U60.equal" [] (Ann (Src 109951214157944 (Lam "a" λxa (Src 109951218352248 (Lam "b" λxb (Src 109951222546552 (Mat "x" (Src 109951234080845 (Op2 EQ (Src 109951239323722 xa) (Src 109951241420876 xb))) (Src 109951252955232 (Book.Bool.false)) λxx._.1 (Src 109951270781040 (Book.Bool.true)) λxx (Src 109951284412536 (Book.Bool)))))))) (Src 109951175360558 (All "a" (Src 109951182700567 (U60)) λxa (Src 109951191089198 (All "b" (Src 109951198429222 (U60)) λxb (Src 109951206817838 (Book.Bool))))))))
Book.Unit = (Ref "Unit" [] (Ann (Src 12094639439957 (Slf "self" (Src 12094647828503 (Book.Unit)) λxself (Src 12094656217173 (All "P" (Src 12094663557168 (All "x" (Src 12094670897197 (Book.Unit)) λxx (Src 12094677188656 (Set)))) λxP (Src 12094682431573 (All "one" (Src 12094691868745 (App (Src 12094692917311 xP) (Src 12094695014472 (Book.Unit.one)))) λxone (Src 12094708645973 (App (Src 12094709694543 xP) (Src 12094711791700 xself))))))))) (Src 12094635245576 (Set))))
Book.Unit.one = (Ref "Unit.one" [] (Ann (Src 13194158407712 (Ins (Src 13194159456288 (Lam "P" λxP (Src 13194163650592 (Lam "one" λxone (Src 13194169942048 xone))))))) (Src 13194151067663 (Book.Unit))))

Main = (API.check Book.Kind.API.check)
